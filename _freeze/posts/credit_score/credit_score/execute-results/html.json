{
  "hash": "1d18da6346c8e9dcd1b1a16869d45457",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Credit Score\"\nimage: \"credit_score.jpeg\"\ndescription: \"ML explainability classification\"\nauthor: \"Simne Brazzi\"\ndate: \"2024-10-26\"\ndraft: false\ncategories:\n  - code\n  - ML\n  - Python, R\ntoc: true\ntoc-title: \"Table of Contents\"\n# other-links:\n#   - icon: file-pdf\n#     text: LDA Paper\n#     href: https://www.jmlr.org/papers/volume3/blei03a/blei03a.pdf\ntoc-depth: 3\nnumber-sections: true\nnumber-depth: 3\nembed-resources: true\nanchor-sections: true\nsmooth-scroll: true\nhighlight-style: monokai\ncode-line-numbers: true\ncode-copy: true\ncode-link: true\ncode-fold: true\nother-links:\n  - icon: file-code\n    text: Kaggle\n    href: https://www.kaggle.com/code/simonebrazzi/credit-score\n\nexecute:\n  warnings: false\n  freeze: auto\n\neditor_options: \n  chunk_output_type: console\n---\n\n\n\n# Introduction\n\nCreate a model capable of estimating the creditworthiness of customers, in order to help the dedicated team understand whether or not to accept a credit card application.\n\n## Features\n\n-   ID: customer identification number\n-   CODE_GENDER: gender of the customer\n-   FLAGOWNCAR: indicator of car ownership\n-   FLAGOWNREALTY: indicator of house ownership\n-   CNT_CHILDREN: number of children\n-   AMTINCOMETOTAL: annual income\n-   NAMEINCOMETYPE: type of income\n-   NAMEEDUCATIONTYPE: level of education\n-   NAMEFAMILYSTATUS: marital status\n-   NAMEHOUSINGTYPE: type of dwelling\n-   DAYS_BIRTH: number of days since birth\n-   DAYS_EMPLOYED: number of days since employment (if positive, indicates the number of days since being unemployed)\n-   FLAG_MOBIL: indicator for the presence of a mobile phone number\n-   FLAGWORKPHONE: indicator of the presence of a work phone number\n-   FLAG_PHONE: indicator of the presence of a telephone number\n-   FLAG_EMAIL: indicator for the presence of an email address\n-   OCCUPATION_TYPE: type of occupation\n-   CNTFAMMEMBERS: number of family members\n-   TARGET: variable which is worth 1 if the customer has a high creditworthiness (constant payment of installments), 0 otherwise.\n\nIf a customer is denied a credit card, the team must be able to give a reason. This means that your model must provide indications that are easy to interpret.\n\nIt is a binary classification which needs a good explainability.\n\n# Import\n\n## R\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse, verbose = FALSE)\nlibrary(ggplot2)\nlibrary(plotly)\nlibrary(reticulate)\nlibrary(gt)\nlibrary(scales)\nlibrary(shapr)\n```\n:::\n\n\n\n## Python\n\n\n\n::: {.cell}\n\n```{.python .cell-code}\nimport pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport pickle\nimport time\nimport os\n\nfrom datetime import date\nfrom dateutil.relativedelta import relativedelta\nfrom sklearn.model_selection import train_test_split, GridSearchCV, RandomizedSearchCV\nfrom sklearn.compose import ColumnTransformer\nfrom sklearn.preprocessing import OneHotEncoder, OrdinalEncoder, StandardScaler, MinMaxScaler, LabelBinarizer\nfrom sklearn.pipeline import Pipeline\nfrom sklearn.tree import DecisionTreeClassifier\nfrom xgboost import XGBClassifier\nfrom xgboost import DMatrix\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.metrics import classification_report\n```\n:::\n\n\n\n## Config class\n\n::: {#config-class}\n\n\n::: {.cell}\n\n```{#lst-config .python .cell-code  lst-cap=\"Config class\"}\n\nclass Config():\n    def __init__(self):\n        \"\"\"\n        Initialize configuration settings for credit scoring model pipeline.\n        Sets up file paths, random state, and feature column classifications.\n        \"\"\"\n        # Base directory and file paths\n        self.path=\"/Users/simonebrazzi/R/blog/posts/credit_score/\"\n        self.file=\"/Users/simonebrazzi/R/blog/posts/credit_score/credit_scoring.csv\"\n        self.pkl_path=\"~/R/blog/posts/credit_score/pkl/\"\n        \n        # Set random state for reproducibility\n        self.random_state=42\n        \n        # Define feature columns by type\n        self.col_binary = ['code_gender', 'flag_own_car', 'flag_own_realty']\n        self.col_ordinal = [\"name_income_type\", \"name_education_type\", \"name_family_status\", \"name_housing_type\", \"occupation_type\"]\n        self.col_numeric = ['cnt_children', 'amt_income_total', 'cnt_fam_members']\n        self.features = self.col_binary + self.col_ordinal + self.col_numeric\n    \n    def dump_pkl(self, path, model):\n        \"\"\"\n        Serialize model to pickle file.\n        Args:\n            path: Output file path\n            model: Model to serialize\n        \"\"\"\n        with open(path, \"wb\") as f:\n            pickle.dump(model, f)\n    \n    def load_pkl(self, path):\n        \"\"\"\n        Load model from pickle file.\n        Args:\n            path: Input pickle file path\n        Returns:\n            Deserialized model\n        \"\"\"\n        with open(path, \"rb\") as f:\n            model = pickle.load(f)\n        return model\n    \n    def make_dtc(self):\n        \"\"\"\n        Create Decision Tree Classifier pipeline with preprocessing and grid search.\n        Returns:\n            GridSearchCV object configured for DTC\n        \"\"\"\n        # Initialize encoders and scaler\n        ohe = OneHotEncoder(drop='if_binary', sparse_output=False)\n        oe = OrdinalEncoder().set_output(transform='pandas')\n        ss = StandardScaler()\n        \n        # Create balanced Decision Tree\n        dtc = DecisionTreeClassifier(class_weight=\"balanced\", random_state=config.random_state)\n        \n        # Set up preprocessing pipeline\n        preprocessor = ColumnTransformer(\n            transformers=[\n                (\"binary_encoder\", ohe, config.col_binary),\n                (\"ordinal_encoder\", oe, config.col_ordinal),\n                (\"standard_scaler\", ss, config.col_numeric)\n            ],\n            remainder='passthrough'\n        )\n        \n        # Create full pipeline\n        pipe_dtc = Pipeline(\n            steps=[\n                (\"preprocessor\", preprocessor),\n                (\"dtc\", dtc)\n            ]\n        )\n        \n        # Define hyperparameter search space\n        param_grid_dtc = {\n            \"dtc__criterion\": [\"gini\", \"entropy\", \"log_loss\"],\n            \"dtc__splitter\": [\"best\", \"random\"],\n            \"dtc__max_depth\": [1, 2, 5, 10, 15]\n        }\n        \n        # Set up multiple scoring metrics\n        scoring = {\n            \"accuracy\": \"accuracy\",\n            \"f1\": \"f1\",\n            \"roc_auc\": \"roc_auc\"\n        }\n        \n        # Configure grid search\n        grid_search_dtc = GridSearchCV(\n            estimator=pipe_dtc,\n            param_grid=param_grid_dtc,\n            cv=7,\n            scoring=scoring,\n            refit=\"f1\",\n            n_jobs=-1\n        )\n        \n        return grid_search_dtc\n    \n    def make_rfc(self):\n        \"\"\"\n        Create Random Forest Classifier pipeline with preprocessing and grid search.\n        Returns:\n            GridSearchCV object configured for RFC\n        \"\"\"\n        # Initialize preprocessing components\n        ohe = OneHotEncoder(drop='if_binary', sparse_output=False)\n        oe = OrdinalEncoder().set_output(transform='pandas')\n        ss = StandardScaler()\n        \n        # Create balanced Random Forest\n        rfc = RandomForestClassifier(class_weight=\"balanced\", random_state=config.random_state)\n        \n        # Set up preprocessing pipeline\n        preprocessor = ColumnTransformer(\n            transformers=[\n                (\"binary_encoder\", ohe, config.col_binary),\n                (\"ordinal_encoder\", oe, config.col_ordinal),\n                (\"standard_scaler\", ss, config.col_numeric)\n            ],\n            remainder='passthrough'\n        )\n        \n        # Create full pipeline\n        pipe_rfc = Pipeline(\n            steps=[\n                (\"preprocessor\", preprocessor),\n                (\"rfc\", rfc)\n            ]\n        )\n        \n        # Define parameter search space\n        param_dist_rfc = {\n            'rfc__n_estimators': [50, 75, 100],\n            'rfc__max_depth': [5, 10, 15],\n            'rfc__min_samples_split': [5, 10]\n        }\n        \n        # Set up scoring metrics\n        scoring = {\n            \"accuracy\": \"accuracy\",\n            \"f1\": \"f1\",\n            \"roc_auc\": \"roc_auc\"\n        }\n        \n        # Configure grid search\n        grid_search_rfc = GridSearchCV(\n            estimator=pipe_rfc,\n            param_grid=param_dist_rfc,\n            cv=7,\n            scoring=scoring,\n            refit=\"f1\",\n            n_jobs=-1\n        )\n        \n        return grid_search_rfc\n    \n    def make_xgb(self):\n        \"\"\"\n        Create XGBoost Classifier pipeline with preprocessing and randomized search.\n        Returns:\n            RandomizedSearchCV object configured for XGBoost\n        \"\"\"\n        # Initialize preprocessing components\n        ohe = OneHotEncoder(drop='if_binary', sparse_output=False)\n        oe = OrdinalEncoder().set_output(transform='pandas')\n        ss = StandardScaler()\n        \n        # Set up preprocessing pipeline\n        preprocessor = ColumnTransformer(\n            transformers=[\n                (\"binary_encoder\", ohe, config.col_binary),\n                (\"ordinal_encoder\", oe, config.col_ordinal),\n                (\"standard_scaler\", ss, config.col_numeric)\n            ],\n            remainder='passthrough'\n        )\n        \n        # Calculate class weight\n        scale_pos_weight = len(y[y == 0]) / len(y[y == 1])\n        \n        # Create XGBoost classifier\n        xgb = XGBClassifier(\n            n_jobs=-1,\n            enable_categorical=True,\n            scale_pos_weight=scale_pos_weight,\n            random_state=config.random_state\n        )\n        \n        # Create full pipeline\n        pipe_xgb = Pipeline(\n            steps=[\n                (\"preprocessor\", preprocessor),\n                (\"xgb\", xgb)\n            ]\n        )\n        \n        # Define comprehensive parameter search space\n        param_dist_xgb = {\n            \"xgb__n_estimators\": [100, 150, 200, 300],\n            \"xgb__max_depth\": [3, 5, 7, 10],\n            \"xgb__learning_rate\": [0.1, 0.01, 0.001, 0.0001],\n            \"xgb__subsample\": [0.7, 0.8, 0.9],\n            \"xgb__colsample_bytree\": [0.7, 0.8, 0.9],\n            \"xgb__gamma\": [0, 0.1],\n            \"xgb__alpha\": [0, 0.1],\n            \"xgb__lambda\": [1, 2]\n        }\n        \n        # Set up scoring metrics\n        scoring = {\n            \"accuracy\": \"accuracy\",\n            \"f1\": \"f1\",\n            \"roc_auc\": \"roc_auc\"\n        }\n        \n        # Configure randomized search\n        random_search_xgb = RandomizedSearchCV(\n            estimator=pipe_xgb,\n            param_distributions=param_dist_xgb,\n            n_iter=30,\n            cv=7,\n            scoring=scoring,\n            refit=\"f1\",\n            n_jobs=-1\n        )\n        \n        return random_search_xgb\n\n# Create global config instance\nconfig = Config()\n```\n:::\n\n\n\n:::\n\n# Dataset\n\nNow we can import the dataset. Having all columns UPPERCASE, I will set all of them as lowercase\n\n\n\n::: {.cell}\n\n```{.python .cell-code}\ndf = pd.read_csv(config.file)\ndf.columns = df.columns.str.lower()\n```\n:::\n\n\n\n# EDA\n\n## Target\n\nIt is always important to perform an EDA. In this case I am expecting to have less cases of high creditworthiness than low: for my personal knowledge and experience, high creditworthiness clients are not the majority. Also, considering it is a **binary classification**, it is important to be sure if data are balanced to make a better model selection.\n\n\n\n::: {.cell}\n\n```{.python .cell-code}\nvalue_count = np.unique(df.target, return_counts=True)\n\nvar0 = value_count[0][0]\nvar0_count = value_count[1][0]\n\nvar1 = value_count[0][1]\nvar1_count = value_count[1][1]\n```\n:::\n\n\n\nThe variable:\n\n-   0 has 308\\,705.\n-   1 has 29\\,722.\n\n\n\n::: {#tbl-eda .cell tbl-cap='Absolute and relative frequencies'}\n\n```{.r .cell-code}\nlibrary(reticulate)\n\ndf <- py$df\n\ndf_g <- df %>% \n  rename(label = target) %>% \n  mutate(label = as.factor(label)) %>% \n  summarize(\n    freq_abs = n(),\n    freq_rel = n() / nrow(df),\n    .by = label\n  )\ndf_g %>% \n  gt() %>% \n  fmt_auto() %>% \n  cols_width(\n    label ~ pct(20),\n    freq_abs ~ pct(35),\n    freq_rel ~ pct(35)\n    ) %>% \n  cols_align(\n    align = \"center\",\n    columns = c(freq_abs, freq_rel)\n  ) %>% \n  tab_header(\n    title = \"Label frequency\",\n    subtitle = \"Absolute and relative frequencies\"\n  ) %>% \n  cols_label(\n    label = \"Label\",\n    freq_abs = \"Absolute frequency\",\n    freq_rel = \"Relative frequency\"\n  ) %>% \n  tab_options(\n    table.width = pct(100)\n    )\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"nfysfvbtjj\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#nfysfvbtjj table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#nfysfvbtjj thead, #nfysfvbtjj tbody, #nfysfvbtjj tfoot, #nfysfvbtjj tr, #nfysfvbtjj td, #nfysfvbtjj th {\n  border-style: none;\n}\n\n#nfysfvbtjj p {\n  margin: 0;\n  padding: 0;\n}\n\n#nfysfvbtjj .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: 100%;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#nfysfvbtjj .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#nfysfvbtjj .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#nfysfvbtjj .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#nfysfvbtjj .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#nfysfvbtjj .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#nfysfvbtjj .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#nfysfvbtjj .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#nfysfvbtjj .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#nfysfvbtjj .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#nfysfvbtjj .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#nfysfvbtjj .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#nfysfvbtjj .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#nfysfvbtjj .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#nfysfvbtjj .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#nfysfvbtjj .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#nfysfvbtjj .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#nfysfvbtjj .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#nfysfvbtjj .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#nfysfvbtjj .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#nfysfvbtjj .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#nfysfvbtjj .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#nfysfvbtjj .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#nfysfvbtjj .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#nfysfvbtjj .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#nfysfvbtjj .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#nfysfvbtjj .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#nfysfvbtjj .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#nfysfvbtjj .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#nfysfvbtjj .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#nfysfvbtjj .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#nfysfvbtjj .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#nfysfvbtjj .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#nfysfvbtjj .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#nfysfvbtjj .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#nfysfvbtjj .gt_left {\n  text-align: left;\n}\n\n#nfysfvbtjj .gt_center {\n  text-align: center;\n}\n\n#nfysfvbtjj .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#nfysfvbtjj .gt_font_normal {\n  font-weight: normal;\n}\n\n#nfysfvbtjj .gt_font_bold {\n  font-weight: bold;\n}\n\n#nfysfvbtjj .gt_font_italic {\n  font-style: italic;\n}\n\n#nfysfvbtjj .gt_super {\n  font-size: 65%;\n}\n\n#nfysfvbtjj .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#nfysfvbtjj .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#nfysfvbtjj .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#nfysfvbtjj .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#nfysfvbtjj .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#nfysfvbtjj .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#nfysfvbtjj .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#nfysfvbtjj .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#nfysfvbtjj div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" style=\"table-layout:fixed;width:100%;\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <colgroup>\n    <col style=\"width:20%;\"/>\n    <col style=\"width:35%;\"/>\n    <col style=\"width:35%;\"/>\n  </colgroup>\n  <thead>\n    <tr class=\"gt_heading\">\n      <td colspan=\"3\" class=\"gt_heading gt_title gt_font_normal\" style>Label frequency</td>\n    </tr>\n    <tr class=\"gt_heading\">\n      <td colspan=\"3\" class=\"gt_heading gt_subtitle gt_font_normal gt_bottom_border\" style>Absolute and relative frequencies</td>\n    </tr>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"label\">Label</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"freq_abs\">Absolute frequency</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"freq_rel\">Relative frequency</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"label\" class=\"gt_row gt_center\">0</td>\n<td headers=\"freq_abs\" class=\"gt_row gt_center\">308,705 </td>\n<td headers=\"freq_rel\" class=\"gt_row gt_center\">0.912</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_center\">1</td>\n<td headers=\"freq_abs\" class=\"gt_row gt_center\"> 29,722 </td>\n<td headers=\"freq_rel\" class=\"gt_row gt_center\">0.088</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n\nThe dataset is **unbalanced** as expected: most of the target are low creditworthiness (0 label). This is important in the training: unbalanced datasets have higher risk of overfitting. If 9 out of 10 observatinos are 0 and you predict 10 times 0, the model has an accuracy of 0.9!\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ng <- ggplot(df_g) +\n  geom_bar(aes(x = label, y = freq_abs, fill = label), stat = \"identity\") +\n  ggtitle(\"Absolute frequency barchart\") +\n  xlab(\"Label\") +\n  ylab(\"Absolute frequency\") +\n  labs(fill = \"Label\") +\n  scale_y_continuous(breaks = scales::breaks_pretty(n = 5)) +\n  theme_minimal()\nggplotly(g)\n```\n\n::: {#fig-barchart .cell-output-display}\n\n```{=html}\n<div class=\"plotly html-widget html-fill-item\" id=\"htmlwidget-c1d7acfba25abf42bd4d\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-c1d7acfba25abf42bd4d\">{\"x\":{\"data\":[{\"orientation\":\"v\",\"width\":0.89999999999999991,\"base\":0,\"x\":[1],\"y\":[308705],\"text\":\"label: 0<br />freq_abs: 308705<br />label: 0\",\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(248,118,109,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"0\",\"legendgroup\":\"0\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"v\",\"width\":0.90000000000000013,\"base\":0,\"x\":[2],\"y\":[29722],\"text\":\"label: 1<br />freq_abs:  29722<br />label: 1\",\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(0,191,196,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"1\",\"legendgroup\":\"1\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null}],\"layout\":{\"margin\":{\"t\":43.762557077625573,\"r\":7.3059360730593621,\"b\":40.182648401826498,\"l\":60.639269406392714},\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724},\"title\":{\"text\":\"Absolute frequency barchart\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":17.534246575342465},\"x\":0,\"xref\":\"paper\"},\"xaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[0.40000000000000002,2.6000000000000001],\"tickmode\":\"array\",\"ticktext\":[\"0\",\"1\"],\"tickvals\":[1,2],\"categoryorder\":\"array\",\"categoryarray\":[\"0\",\"1\"],\"nticks\":null,\"ticks\":\"\",\"tickcolor\":null,\"ticklen\":3.6529680365296811,\"tickwidth\":0,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.68949771689498},\"tickangle\":-0,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":true,\"gridcolor\":\"rgba(235,235,235,1)\",\"gridwidth\":0.66417600664176002,\"zeroline\":false,\"anchor\":\"y\",\"title\":{\"text\":\"Label\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}},\"hoverformat\":\".2f\"},\"yaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[-15435.25,324140.25],\"tickmode\":\"array\",\"ticktext\":[\"0\",\"50000\",\"100000\",\"150000\",\"200000\",\"250000\",\"300000\"],\"tickvals\":[0,50000,100000,150000,200000,250000,300000],\"categoryorder\":\"array\",\"categoryarray\":[\"0\",\"50000\",\"100000\",\"150000\",\"200000\",\"250000\",\"300000\"],\"nticks\":null,\"ticks\":\"\",\"tickcolor\":null,\"ticklen\":3.6529680365296811,\"tickwidth\":0,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.68949771689498},\"tickangle\":-0,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":true,\"gridcolor\":\"rgba(235,235,235,1)\",\"gridwidth\":0.66417600664176002,\"zeroline\":false,\"anchor\":\"x\",\"title\":{\"text\":\"Absolute frequency\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}},\"hoverformat\":\".2f\"},\"shapes\":[{\"type\":\"rect\",\"fillcolor\":null,\"line\":{\"color\":null,\"width\":0,\"linetype\":[]},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0,\"x1\":1,\"y0\":0,\"y1\":1}],\"showlegend\":true,\"legend\":{\"bgcolor\":null,\"bordercolor\":null,\"borderwidth\":0,\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":11.68949771689498},\"title\":{\"text\":\"Label\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}}},\"hovermode\":\"closest\",\"barmode\":\"relative\"},\"config\":{\"doubleClick\":\"reset\",\"modeBarButtonsToAdd\":[\"hoverclosest\",\"hovercompare\"],\"showSendToCloud\":false},\"source\":\"A\",\"attrs\":{\"15149472ce1b9\":{\"x\":{},\"y\":{},\"fill\":{},\"type\":\"bar\"}},\"cur_data\":\"15149472ce1b9\",\"visdat\":{\"15149472ce1b9\":[\"function (y) \",\"x\"]},\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.20000000000000001,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n\nAbsolute frequency barchart\n:::\n:::\n\n\n\n::: callout-importand\n-   **0**. stands for **low creditworthiness**.\n-   **1** stands for **high**.\n-   Our dataset is strongly unbalanced towards the 0 label.\n:::\n\n## Features\n\nLets check the **NA** values in each feature.\n\n\n\n::: {#tbl-na .cell tbl-cap='Number of NA values for each feature'}\n\n```{.r .cell-code}\ndf_na <- df %>%\n  summarize(across(everything(), ~ sum(is.na(.)))) %>%\n  pivot_longer(\n    cols = everything(),\n    names_to = \"columns\",\n    values_to = \"value\"\n  )\ndf_na %>% \n  gt() %>% \n  tab_options(\n    table.width = pct(100)\n    ) %>% \n  cols_align(align = \"center\") %>% \n  cols_label(\n    columns = \"Columns\",\n    value = \"NA Value\"\n  ) %>% \n  tab_header(\n    title = \"NA values\",\n    subtitle = \"Number of NA value for each feature\"\n  ) %>% \n  fmt_number(\n    columns = c(\"value\"),\n    decimals = 2,\n    drop_trailing_zeros = TRUE,\n    #drop_trailing_dec_mark = FALSE\n  ) \n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"bxmccnbokm\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#bxmccnbokm table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#bxmccnbokm thead, #bxmccnbokm tbody, #bxmccnbokm tfoot, #bxmccnbokm tr, #bxmccnbokm td, #bxmccnbokm th {\n  border-style: none;\n}\n\n#bxmccnbokm p {\n  margin: 0;\n  padding: 0;\n}\n\n#bxmccnbokm .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: 100%;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#bxmccnbokm .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#bxmccnbokm .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#bxmccnbokm .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#bxmccnbokm .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#bxmccnbokm .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#bxmccnbokm .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#bxmccnbokm .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#bxmccnbokm .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#bxmccnbokm .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#bxmccnbokm .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#bxmccnbokm .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#bxmccnbokm .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#bxmccnbokm .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#bxmccnbokm .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#bxmccnbokm .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#bxmccnbokm .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#bxmccnbokm .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#bxmccnbokm .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#bxmccnbokm .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#bxmccnbokm .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#bxmccnbokm .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#bxmccnbokm .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#bxmccnbokm .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#bxmccnbokm .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#bxmccnbokm .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#bxmccnbokm .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#bxmccnbokm .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#bxmccnbokm .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#bxmccnbokm .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#bxmccnbokm .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#bxmccnbokm .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#bxmccnbokm .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#bxmccnbokm .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#bxmccnbokm .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#bxmccnbokm .gt_left {\n  text-align: left;\n}\n\n#bxmccnbokm .gt_center {\n  text-align: center;\n}\n\n#bxmccnbokm .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#bxmccnbokm .gt_font_normal {\n  font-weight: normal;\n}\n\n#bxmccnbokm .gt_font_bold {\n  font-weight: bold;\n}\n\n#bxmccnbokm .gt_font_italic {\n  font-style: italic;\n}\n\n#bxmccnbokm .gt_super {\n  font-size: 65%;\n}\n\n#bxmccnbokm .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#bxmccnbokm .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#bxmccnbokm .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#bxmccnbokm .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#bxmccnbokm .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#bxmccnbokm .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#bxmccnbokm .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#bxmccnbokm .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#bxmccnbokm div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_heading\">\n      <td colspan=\"2\" class=\"gt_heading gt_title gt_font_normal\" style>NA values</td>\n    </tr>\n    <tr class=\"gt_heading\">\n      <td colspan=\"2\" class=\"gt_heading gt_subtitle gt_font_normal gt_bottom_border\" style>Number of NA value for each feature</td>\n    </tr>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"columns\">Columns</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"value\">NA Value</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"columns\" class=\"gt_row gt_center\">id</td>\n<td headers=\"value\" class=\"gt_row gt_center\">0</td></tr>\n    <tr><td headers=\"columns\" class=\"gt_row gt_center\">code_gender</td>\n<td headers=\"value\" class=\"gt_row gt_center\">0</td></tr>\n    <tr><td headers=\"columns\" class=\"gt_row gt_center\">flag_own_car</td>\n<td headers=\"value\" class=\"gt_row gt_center\">0</td></tr>\n    <tr><td headers=\"columns\" class=\"gt_row gt_center\">flag_own_realty</td>\n<td headers=\"value\" class=\"gt_row gt_center\">0</td></tr>\n    <tr><td headers=\"columns\" class=\"gt_row gt_center\">cnt_children</td>\n<td headers=\"value\" class=\"gt_row gt_center\">0</td></tr>\n    <tr><td headers=\"columns\" class=\"gt_row gt_center\">amt_income_total</td>\n<td headers=\"value\" class=\"gt_row gt_center\">0</td></tr>\n    <tr><td headers=\"columns\" class=\"gt_row gt_center\">name_income_type</td>\n<td headers=\"value\" class=\"gt_row gt_center\">0</td></tr>\n    <tr><td headers=\"columns\" class=\"gt_row gt_center\">name_education_type</td>\n<td headers=\"value\" class=\"gt_row gt_center\">0</td></tr>\n    <tr><td headers=\"columns\" class=\"gt_row gt_center\">name_family_status</td>\n<td headers=\"value\" class=\"gt_row gt_center\">1</td></tr>\n    <tr><td headers=\"columns\" class=\"gt_row gt_center\">name_housing_type</td>\n<td headers=\"value\" class=\"gt_row gt_center\">1</td></tr>\n    <tr><td headers=\"columns\" class=\"gt_row gt_center\">days_birth</td>\n<td headers=\"value\" class=\"gt_row gt_center\">1</td></tr>\n    <tr><td headers=\"columns\" class=\"gt_row gt_center\">days_employed</td>\n<td headers=\"value\" class=\"gt_row gt_center\">1</td></tr>\n    <tr><td headers=\"columns\" class=\"gt_row gt_center\">flag_mobil</td>\n<td headers=\"value\" class=\"gt_row gt_center\">1</td></tr>\n    <tr><td headers=\"columns\" class=\"gt_row gt_center\">flag_work_phone</td>\n<td headers=\"value\" class=\"gt_row gt_center\">1</td></tr>\n    <tr><td headers=\"columns\" class=\"gt_row gt_center\">flag_phone</td>\n<td headers=\"value\" class=\"gt_row gt_center\">1</td></tr>\n    <tr><td headers=\"columns\" class=\"gt_row gt_center\">flag_email</td>\n<td headers=\"value\" class=\"gt_row gt_center\">1</td></tr>\n    <tr><td headers=\"columns\" class=\"gt_row gt_center\">occupation_type</td>\n<td headers=\"value\" class=\"gt_row gt_center\">103,342</td></tr>\n    <tr><td headers=\"columns\" class=\"gt_row gt_center\">cnt_fam_members</td>\n<td headers=\"value\" class=\"gt_row gt_center\">1</td></tr>\n    <tr><td headers=\"columns\" class=\"gt_row gt_center\">target</td>\n<td headers=\"value\" class=\"gt_row gt_center\">0</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n\nThere are 2 interesting things to notice:\n\n#### The column `occupation_type` has lots of NA value. How much in proportion to the total? Should we drop the NAs or keep them?\n\n\n\n::: {#tbl-occupation-type .cell tbl-cap='NA frequency for occupation_type'}\n\n```{.r .cell-code}\ndf %>%\n  summarize(\n    freq_abs = sum(is.na(occupation_type)),\n    freq_rel = sum(is.na(occupation_type)) / nrow(df)\n    ) %>% \n  gt() %>% \n  tab_options(\n    table.width = pct(100)\n    ) %>% \n  cols_align(align = \"center\") %>% \n  cols_label(\n    freq_abs = \"Absolute Frequency\",\n    freq_rel = \"Relative Frequency\"\n  ) %>% \n  tab_header(\n    title = \"Absolute and Relative Frequency\",\n    subtitle = \"NA frequency for occupation_type\"\n  ) %>% \n  fmt_number(\n    columns = c(\"freq_abs\", \"freq_rel\"),\n    decimals = 2,\n    drop_trailing_zeros = TRUE\n  ) \n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"wyfyiwozzm\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#wyfyiwozzm table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#wyfyiwozzm thead, #wyfyiwozzm tbody, #wyfyiwozzm tfoot, #wyfyiwozzm tr, #wyfyiwozzm td, #wyfyiwozzm th {\n  border-style: none;\n}\n\n#wyfyiwozzm p {\n  margin: 0;\n  padding: 0;\n}\n\n#wyfyiwozzm .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: 100%;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#wyfyiwozzm .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#wyfyiwozzm .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#wyfyiwozzm .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#wyfyiwozzm .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#wyfyiwozzm .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#wyfyiwozzm .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#wyfyiwozzm .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#wyfyiwozzm .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#wyfyiwozzm .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#wyfyiwozzm .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#wyfyiwozzm .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#wyfyiwozzm .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#wyfyiwozzm .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#wyfyiwozzm .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#wyfyiwozzm .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#wyfyiwozzm .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#wyfyiwozzm .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#wyfyiwozzm .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#wyfyiwozzm .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#wyfyiwozzm .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#wyfyiwozzm .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#wyfyiwozzm .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#wyfyiwozzm .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#wyfyiwozzm .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#wyfyiwozzm .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#wyfyiwozzm .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#wyfyiwozzm .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#wyfyiwozzm .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#wyfyiwozzm .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#wyfyiwozzm .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#wyfyiwozzm .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#wyfyiwozzm .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#wyfyiwozzm .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#wyfyiwozzm .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#wyfyiwozzm .gt_left {\n  text-align: left;\n}\n\n#wyfyiwozzm .gt_center {\n  text-align: center;\n}\n\n#wyfyiwozzm .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#wyfyiwozzm .gt_font_normal {\n  font-weight: normal;\n}\n\n#wyfyiwozzm .gt_font_bold {\n  font-weight: bold;\n}\n\n#wyfyiwozzm .gt_font_italic {\n  font-style: italic;\n}\n\n#wyfyiwozzm .gt_super {\n  font-size: 65%;\n}\n\n#wyfyiwozzm .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#wyfyiwozzm .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#wyfyiwozzm .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#wyfyiwozzm .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#wyfyiwozzm .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#wyfyiwozzm .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#wyfyiwozzm .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#wyfyiwozzm .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#wyfyiwozzm div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_heading\">\n      <td colspan=\"2\" class=\"gt_heading gt_title gt_font_normal\" style>Absolute and Relative Frequency</td>\n    </tr>\n    <tr class=\"gt_heading\">\n      <td colspan=\"2\" class=\"gt_heading gt_subtitle gt_font_normal gt_bottom_border\" style>NA frequency for occupation_type</td>\n    </tr>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"freq_abs\">Absolute Frequency</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"freq_rel\">Relative Frequency</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"freq_abs\" class=\"gt_row gt_center\">103,342</td>\n<td headers=\"freq_rel\" class=\"gt_row gt_center\">0.31</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n\n30\\.54% of occupation_type are NA. This could be a big concern: how to handle it? Drop this much could mean losing lots of useful information, while keeping it could lead to impute wrong data, which could be worse.\n\nLets check the occupation_type labels frequency.\n\n\n\n::: {#tbl-occupation-type-freq-tbl .cell tbl-cap='Occupation type label frequency'}\n\n```{.r .cell-code}\ndf %>% \n  summarise(\n    n = n(),\n    .by = occupation_type\n  ) %>% \n  arrange(desc(n)) %>% \n  gt() %>% \n  tab_options(\n    table.width = pct(100)\n    ) %>% \n  cols_align(align = \"center\") %>% \n  cols_label(\n    occupation_type = \"Occupation Type\",\n    n = \"Frequency\"\n  ) %>% \n  tab_header(\n    title = \"Occupation Type Label Frequency\"\n  ) %>% \n  fmt_number(\n    columns = c(\"n\"),\n    decimals = 2,\n    drop_trailing_zeros = TRUE\n  ) \n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"snvfsfwujs\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#snvfsfwujs table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#snvfsfwujs thead, #snvfsfwujs tbody, #snvfsfwujs tfoot, #snvfsfwujs tr, #snvfsfwujs td, #snvfsfwujs th {\n  border-style: none;\n}\n\n#snvfsfwujs p {\n  margin: 0;\n  padding: 0;\n}\n\n#snvfsfwujs .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: 100%;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#snvfsfwujs .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#snvfsfwujs .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#snvfsfwujs .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#snvfsfwujs .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#snvfsfwujs .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#snvfsfwujs .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#snvfsfwujs .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#snvfsfwujs .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#snvfsfwujs .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#snvfsfwujs .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#snvfsfwujs .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#snvfsfwujs .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#snvfsfwujs .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#snvfsfwujs .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#snvfsfwujs .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#snvfsfwujs .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#snvfsfwujs .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#snvfsfwujs .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#snvfsfwujs .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#snvfsfwujs .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#snvfsfwujs .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#snvfsfwujs .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#snvfsfwujs .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#snvfsfwujs .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#snvfsfwujs .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#snvfsfwujs .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#snvfsfwujs .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#snvfsfwujs .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#snvfsfwujs .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#snvfsfwujs .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#snvfsfwujs .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#snvfsfwujs .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#snvfsfwujs .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#snvfsfwujs .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#snvfsfwujs .gt_left {\n  text-align: left;\n}\n\n#snvfsfwujs .gt_center {\n  text-align: center;\n}\n\n#snvfsfwujs .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#snvfsfwujs .gt_font_normal {\n  font-weight: normal;\n}\n\n#snvfsfwujs .gt_font_bold {\n  font-weight: bold;\n}\n\n#snvfsfwujs .gt_font_italic {\n  font-style: italic;\n}\n\n#snvfsfwujs .gt_super {\n  font-size: 65%;\n}\n\n#snvfsfwujs .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#snvfsfwujs .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#snvfsfwujs .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#snvfsfwujs .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#snvfsfwujs .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#snvfsfwujs .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#snvfsfwujs .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#snvfsfwujs .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#snvfsfwujs div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_heading\">\n      <td colspan=\"2\" class=\"gt_heading gt_title gt_font_normal gt_bottom_border\" style>Occupation Type Label Frequency</td>\n    </tr>\n    \n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"occupation_type\">Occupation Type</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"n\">Frequency</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"occupation_type\" class=\"gt_row gt_center\">NA</td>\n<td headers=\"n\" class=\"gt_row gt_center\">103,342</td></tr>\n    <tr><td headers=\"occupation_type\" class=\"gt_row gt_center\">Laborers</td>\n<td headers=\"n\" class=\"gt_row gt_center\">60,146</td></tr>\n    <tr><td headers=\"occupation_type\" class=\"gt_row gt_center\">Core staff</td>\n<td headers=\"n\" class=\"gt_row gt_center\">33,527</td></tr>\n    <tr><td headers=\"occupation_type\" class=\"gt_row gt_center\">Sales staff</td>\n<td headers=\"n\" class=\"gt_row gt_center\">31,652</td></tr>\n    <tr><td headers=\"occupation_type\" class=\"gt_row gt_center\">Managers</td>\n<td headers=\"n\" class=\"gt_row gt_center\">27,384</td></tr>\n    <tr><td headers=\"occupation_type\" class=\"gt_row gt_center\">Drivers</td>\n<td headers=\"n\" class=\"gt_row gt_center\">20,020</td></tr>\n    <tr><td headers=\"occupation_type\" class=\"gt_row gt_center\">High skill tech staff</td>\n<td headers=\"n\" class=\"gt_row gt_center\">13,399</td></tr>\n    <tr><td headers=\"occupation_type\" class=\"gt_row gt_center\">Accountants</td>\n<td headers=\"n\" class=\"gt_row gt_center\">12,281</td></tr>\n    <tr><td headers=\"occupation_type\" class=\"gt_row gt_center\">Medicine staff</td>\n<td headers=\"n\" class=\"gt_row gt_center\">10,438</td></tr>\n    <tr><td headers=\"occupation_type\" class=\"gt_row gt_center\">Cooking staff</td>\n<td headers=\"n\" class=\"gt_row gt_center\">6,248</td></tr>\n    <tr><td headers=\"occupation_type\" class=\"gt_row gt_center\">Security staff</td>\n<td headers=\"n\" class=\"gt_row gt_center\">6,218</td></tr>\n    <tr><td headers=\"occupation_type\" class=\"gt_row gt_center\">Cleaning staff</td>\n<td headers=\"n\" class=\"gt_row gt_center\">4,594</td></tr>\n    <tr><td headers=\"occupation_type\" class=\"gt_row gt_center\">Private service staff</td>\n<td headers=\"n\" class=\"gt_row gt_center\">2,787</td></tr>\n    <tr><td headers=\"occupation_type\" class=\"gt_row gt_center\">Low-skill Laborers</td>\n<td headers=\"n\" class=\"gt_row gt_center\">1,714</td></tr>\n    <tr><td headers=\"occupation_type\" class=\"gt_row gt_center\">Secretaries</td>\n<td headers=\"n\" class=\"gt_row gt_center\">1,577</td></tr>\n    <tr><td headers=\"occupation_type\" class=\"gt_row gt_center\">Waiters/barmen staff</td>\n<td headers=\"n\" class=\"gt_row gt_center\">1,245</td></tr>\n    <tr><td headers=\"occupation_type\" class=\"gt_row gt_center\">Realty agents</td>\n<td headers=\"n\" class=\"gt_row gt_center\">852</td></tr>\n    <tr><td headers=\"occupation_type\" class=\"gt_row gt_center\">HR staff</td>\n<td headers=\"n\" class=\"gt_row gt_center\">567</td></tr>\n    <tr><td headers=\"occupation_type\" class=\"gt_row gt_center\">IT staff</td>\n<td headers=\"n\" class=\"gt_row gt_center\">436</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n\nSo here is the situation:\n\n1.  we could impute the NA respecting the proportion of the other labels in the dataset or\n2.  we can drop the NA values.\n\nI want to drop the NA. Even if we are losing a third of the data, we are not making assumption based on the mode. Occupation_type could be a very important feature and doing inference on it is worst then lose some data. Also, we still have 235085, which are plenty enough.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf_occ_type <- df %>% \n  filter(!is.na(occupation_type)) %>% \n  summarise(\n    n = n(),\n    .by = occupation_type\n  ) %>% \n  arrange(desc(n))\n\n# to extend the palette to the number of labels\nextended_palette <- colorRampPalette(RColorBrewer::brewer.pal(9, \"Purples\"))(df_occ_type %>% nrow())\n\ng <- ggplot(df_occ_type) +\n  geom_col(aes(x = n, y = reorder(occupation_type, n), fill = reorder(occupation_type, n))) +\n  theme_minimal() +\n  labs(\n    x = \"Count\",\n    y = \"Labels\",\n    title = \"Occupation Type Label Frequency\"\n  ) +\n  scale_fill_manual(values = extended_palette)\n\nggplotly(g)\n```\n\n::: {#fig-barplot-occ-type-freq .cell-output-display}\n\n```{=html}\n<div class=\"plotly html-widget html-fill-item\" id=\"htmlwidget-21ee0a4c163825d8e8d6\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-21ee0a4c163825d8e8d6\">{\"x\":{\"data\":[{\"orientation\":\"v\",\"width\":436,\"base\":0.55000000000000004,\"x\":[218],\"y\":[0.89999999999999991],\"text\":\"n:   436<br />reorder(occupation_type, n): IT staff<br />reorder(occupation_type, n): IT staff\",\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(252,251,253,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"IT staff\",\"legendgroup\":\"IT staff\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"v\",\"width\":567,\"base\":1.55,\"x\":[283.5],\"y\":[0.90000000000000013],\"text\":\"n:   567<br />reorder(occupation_type, n): HR staff<br />reorder(occupation_type, n): HR staff\",\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(245,244,249,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"HR staff\",\"legendgroup\":\"HR staff\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"v\",\"width\":852,\"base\":2.5499999999999998,\"x\":[426],\"y\":[0.90000000000000036],\"text\":\"n:   852<br />reorder(occupation_type, n): Realty agents<br />reorder(occupation_type, n): Realty agents\",\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(239,237,245,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"Realty agents\",\"legendgroup\":\"Realty agents\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"v\",\"width\":1245,\"base\":3.5499999999999998,\"x\":[622.5],\"y\":[0.90000000000000036],\"text\":\"n:  1245<br />reorder(occupation_type, n): Waiters/barmen staff<br />reorder(occupation_type, n): Waiters/barmen staff\",\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(230,229,240,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"Waiters/barmen staff\",\"legendgroup\":\"Waiters/barmen staff\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"v\",\"width\":1577,\"base\":4.5499999999999998,\"x\":[788.5],\"y\":[0.90000000000000036],\"text\":\"n:  1577<br />reorder(occupation_type, n): Secretaries<br />reorder(occupation_type, n): Secretaries\",\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(220,220,236,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"Secretaries\",\"legendgroup\":\"Secretaries\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"v\",\"width\":1714,\"base\":5.5499999999999998,\"x\":[857],\"y\":[0.90000000000000036],\"text\":\"n:  1714<br />reorder(occupation_type, n): Low-skill Laborers<br />reorder(occupation_type, n): Low-skill Laborers\",\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(207,207,229,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"Low-skill Laborers\",\"legendgroup\":\"Low-skill Laborers\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"v\",\"width\":2787,\"base\":6.5499999999999998,\"x\":[1393.5],\"y\":[0.90000000000000036],\"text\":\"n:  2787<br />reorder(occupation_type, n): Private service staff<br />reorder(occupation_type, n): Private service staff\",\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(193,194,222,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"Private service staff\",\"legendgroup\":\"Private service staff\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"v\",\"width\":4594,\"base\":7.5499999999999998,\"x\":[2297],\"y\":[0.89999999999999947],\"text\":\"n:  4594<br />reorder(occupation_type, n): Cleaning staff<br />reorder(occupation_type, n): Cleaning staff\",\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(179,178,214,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"Cleaning staff\",\"legendgroup\":\"Cleaning staff\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"v\",\"width\":6218,\"base\":8.5500000000000007,\"x\":[3109],\"y\":[0.89999999999999858],\"text\":\"n:  6218<br />reorder(occupation_type, n): Security staff<br />reorder(occupation_type, n): Security staff\",\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(165,162,204,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"Security staff\",\"legendgroup\":\"Security staff\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"v\",\"width\":6248,\"base\":9.5500000000000007,\"x\":[3124],\"y\":[0.89999999999999858],\"text\":\"n:  6248<br />reorder(occupation_type, n): Cooking staff<br />reorder(occupation_type, n): Cooking staff\",\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(150,147,196,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"Cooking staff\",\"legendgroup\":\"Cooking staff\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"v\",\"width\":10438,\"base\":10.550000000000001,\"x\":[5219],\"y\":[0.89999999999999858],\"text\":\"n: 10438<br />reorder(occupation_type, n): Medicine staff<br />reorder(occupation_type, n): Medicine staff\",\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(136,133,190,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"Medicine staff\",\"legendgroup\":\"Medicine staff\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"v\",\"width\":12281,\"base\":11.550000000000001,\"x\":[6140.5],\"y\":[0.89999999999999858],\"text\":\"n: 12281<br />reorder(occupation_type, n): Accountants<br />reorder(occupation_type, n): Accountants\",\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(124,117,181,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"Accountants\",\"legendgroup\":\"Accountants\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"v\",\"width\":13399,\"base\":12.550000000000001,\"x\":[6699.5],\"y\":[0.89999999999999858],\"text\":\"n: 13399<br />reorder(occupation_type, n): High skill tech staff<br />reorder(occupation_type, n): High skill tech staff\",\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(113,96,171,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"High skill tech staff\",\"legendgroup\":\"High skill tech staff\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"v\",\"width\":20020,\"base\":13.550000000000001,\"x\":[10010],\"y\":[0.89999999999999858],\"text\":\"n: 20020<br />reorder(occupation_type, n): Drivers<br />reorder(occupation_type, n): Drivers\",\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(103,76,160,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"Drivers\",\"legendgroup\":\"Drivers\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"v\",\"width\":27384,\"base\":14.550000000000001,\"x\":[13692],\"y\":[0.89999999999999858],\"text\":\"n: 27384<br />reorder(occupation_type, n): Managers<br />reorder(occupation_type, n): Managers\",\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(93,56,151,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"Managers\",\"legendgroup\":\"Managers\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"v\",\"width\":31652,\"base\":15.550000000000001,\"x\":[15826],\"y\":[0.89999999999999858],\"text\":\"n: 31652<br />reorder(occupation_type, n): Sales staff<br />reorder(occupation_type, n): Sales staff\",\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(82,36,141,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"Sales staff\",\"legendgroup\":\"Sales staff\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"v\",\"width\":33527,\"base\":16.550000000000001,\"x\":[16763.5],\"y\":[0.89999999999999858],\"text\":\"n: 33527<br />reorder(occupation_type, n): Core staff<br />reorder(occupation_type, n): Core staff\",\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(72,18,133,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"Core staff\",\"legendgroup\":\"Core staff\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"v\",\"width\":60146,\"base\":17.550000000000001,\"x\":[30073],\"y\":[0.89999999999999858],\"text\":\"n: 60146<br />reorder(occupation_type, n): Laborers<br />reorder(occupation_type, n): Laborers\",\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(63,0,125,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"Laborers\",\"legendgroup\":\"Laborers\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null}],\"layout\":{\"margin\":{\"t\":43.762557077625573,\"r\":7.3059360730593621,\"b\":40.182648401826498,\"l\":148.31050228310505},\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724},\"title\":{\"text\":\"Occupation Type Label Frequency\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":17.534246575342465},\"x\":0,\"xref\":\"paper\"},\"xaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[-3007.3000000000002,63153.300000000003],\"tickmode\":\"array\",\"ticktext\":[\"0\",\"20000\",\"40000\",\"60000\"],\"tickvals\":[0,20000,40000,60000],\"categoryorder\":\"array\",\"categoryarray\":[\"0\",\"20000\",\"40000\",\"60000\"],\"nticks\":null,\"ticks\":\"\",\"tickcolor\":null,\"ticklen\":3.6529680365296811,\"tickwidth\":0,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.68949771689498},\"tickangle\":-0,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":true,\"gridcolor\":\"rgba(235,235,235,1)\",\"gridwidth\":0.66417600664176002,\"zeroline\":false,\"anchor\":\"y\",\"title\":{\"text\":\"Count\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}},\"hoverformat\":\".2f\"},\"yaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[0.40000000000000002,18.600000000000001],\"tickmode\":\"array\",\"ticktext\":[\"IT staff\",\"HR staff\",\"Realty agents\",\"Waiters/barmen staff\",\"Secretaries\",\"Low-skill Laborers\",\"Private service staff\",\"Cleaning staff\",\"Security staff\",\"Cooking staff\",\"Medicine staff\",\"Accountants\",\"High skill tech staff\",\"Drivers\",\"Managers\",\"Sales staff\",\"Core staff\",\"Laborers\"],\"tickvals\":[1,2,3,4,5,5.9999999999999991,7,8,9,10,11,12,13,14,15,16,17,18],\"categoryorder\":\"array\",\"categoryarray\":[\"IT staff\",\"HR staff\",\"Realty agents\",\"Waiters/barmen staff\",\"Secretaries\",\"Low-skill Laborers\",\"Private service staff\",\"Cleaning staff\",\"Security staff\",\"Cooking staff\",\"Medicine staff\",\"Accountants\",\"High skill tech staff\",\"Drivers\",\"Managers\",\"Sales staff\",\"Core staff\",\"Laborers\"],\"nticks\":null,\"ticks\":\"\",\"tickcolor\":null,\"ticklen\":3.6529680365296811,\"tickwidth\":0,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.68949771689498},\"tickangle\":-0,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":true,\"gridcolor\":\"rgba(235,235,235,1)\",\"gridwidth\":0.66417600664176002,\"zeroline\":false,\"anchor\":\"x\",\"title\":{\"text\":\"Labels\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}},\"hoverformat\":\".2f\"},\"shapes\":[{\"type\":\"rect\",\"fillcolor\":null,\"line\":{\"color\":null,\"width\":0,\"linetype\":[]},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0,\"x1\":1,\"y0\":0,\"y1\":1}],\"showlegend\":true,\"legend\":{\"bgcolor\":null,\"bordercolor\":null,\"borderwidth\":0,\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":11.68949771689498},\"title\":{\"text\":\"reorder(occupation_type, n)\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}}},\"hovermode\":\"closest\",\"barmode\":\"relative\"},\"config\":{\"doubleClick\":\"reset\",\"modeBarButtonsToAdd\":[\"hoverclosest\",\"hovercompare\"],\"showSendToCloud\":false},\"source\":\"A\",\"attrs\":{\"1514952dd9cd1\":{\"x\":{},\"y\":{},\"fill\":{},\"type\":\"bar\"}},\"cur_data\":\"1514952dd9cd1\",\"visdat\":{\"1514952dd9cd1\":[\"function (y) \",\"x\"]},\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.20000000000000001,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n\nBarplot Occupation Type Label frequency\n:::\n:::\n\n\n\n#### There is a NA value in at least all the columns: is it possible it is the same observation?\n\nFirst of all, we can create a list of the columns name which have only 1 NA, using the `df_na` tibble.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\none_cols <- df_na %>% \n  filter(value == 1) %>% \n  pull(columns)\none_cols\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"name_family_status\" \"name_housing_type\"  \"days_birth\"        \n[4] \"days_employed\"      \"flag_mobil\"         \"flag_work_phone\"   \n[7] \"flag_phone\"         \"flag_email\"         \"cnt_fam_members\"   \n```\n\n\n:::\n:::\n\n\n\nThen, to check multiple OR condition, we can use `if_any()` in R. In this case, we are checking if multiple columns are NA, with the previous filter on only one NA in each column.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(reticulate)\n\ndf %>% \n  filter(\n    if_any(all_of(one_cols), ~ . %>% is.na())\n  ) %>% \n  gt()  %>% \n  tab_options(\n    table.width = pct(100)\n    )\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"bmakczknsz\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#bmakczknsz table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#bmakczknsz thead, #bmakczknsz tbody, #bmakczknsz tfoot, #bmakczknsz tr, #bmakczknsz td, #bmakczknsz th {\n  border-style: none;\n}\n\n#bmakczknsz p {\n  margin: 0;\n  padding: 0;\n}\n\n#bmakczknsz .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: 100%;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#bmakczknsz .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#bmakczknsz .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#bmakczknsz .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#bmakczknsz .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#bmakczknsz .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#bmakczknsz .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#bmakczknsz .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#bmakczknsz .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#bmakczknsz .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#bmakczknsz .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#bmakczknsz .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#bmakczknsz .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#bmakczknsz .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#bmakczknsz .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#bmakczknsz .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#bmakczknsz .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#bmakczknsz .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#bmakczknsz .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#bmakczknsz .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#bmakczknsz .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#bmakczknsz .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#bmakczknsz .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#bmakczknsz .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#bmakczknsz .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#bmakczknsz .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#bmakczknsz .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#bmakczknsz .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#bmakczknsz .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#bmakczknsz .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#bmakczknsz .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#bmakczknsz .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#bmakczknsz .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#bmakczknsz .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#bmakczknsz .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#bmakczknsz .gt_left {\n  text-align: left;\n}\n\n#bmakczknsz .gt_center {\n  text-align: center;\n}\n\n#bmakczknsz .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#bmakczknsz .gt_font_normal {\n  font-weight: normal;\n}\n\n#bmakczknsz .gt_font_bold {\n  font-weight: bold;\n}\n\n#bmakczknsz .gt_font_italic {\n  font-style: italic;\n}\n\n#bmakczknsz .gt_super {\n  font-size: 65%;\n}\n\n#bmakczknsz .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#bmakczknsz .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#bmakczknsz .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#bmakczknsz .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#bmakczknsz .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#bmakczknsz .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#bmakczknsz .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#bmakczknsz .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#bmakczknsz div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"id\">id</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"code_gender\">code_gender</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"flag_own_car\">flag_own_car</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"flag_own_realty\">flag_own_realty</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"cnt_children\">cnt_children</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"amt_income_total\">amt_income_total</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"name_income_type\">name_income_type</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"name_education_type\">name_education_type</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"name_family_status\">name_family_status</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"name_housing_type\">name_housing_type</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"days_birth\">days_birth</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"days_employed\">days_employed</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"flag_mobil\">flag_mobil</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"flag_work_phone\">flag_work_phone</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"flag_phone\">flag_phone</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"flag_email\">flag_email</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"occupation_type\">occupation_type</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"cnt_fam_members\">cnt_fam_members</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"target\">target</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"id\" class=\"gt_row gt_right\">6392180</td>\n<td headers=\"code_gender\" class=\"gt_row gt_left\">F</td>\n<td headers=\"flag_own_car\" class=\"gt_row gt_left\">N</td>\n<td headers=\"flag_own_realty\" class=\"gt_row gt_left\">N</td>\n<td headers=\"cnt_children\" class=\"gt_row gt_right\">0</td>\n<td headers=\"amt_income_total\" class=\"gt_row gt_right\">67500</td>\n<td headers=\"name_income_type\" class=\"gt_row gt_left\">Working</td>\n<td headers=\"name_education_type\" class=\"gt_row gt_left\">Secondary / se</td>\n<td headers=\"name_family_status\" class=\"gt_row gt_left\">NA</td>\n<td headers=\"name_housing_type\" class=\"gt_row gt_left\">NA</td>\n<td headers=\"days_birth\" class=\"gt_row gt_right\">NaN</td>\n<td headers=\"days_employed\" class=\"gt_row gt_right\">NaN</td>\n<td headers=\"flag_mobil\" class=\"gt_row gt_right\">NaN</td>\n<td headers=\"flag_work_phone\" class=\"gt_row gt_right\">NaN</td>\n<td headers=\"flag_phone\" class=\"gt_row gt_right\">NaN</td>\n<td headers=\"flag_email\" class=\"gt_row gt_right\">NaN</td>\n<td headers=\"occupation_type\" class=\"gt_row gt_left\">NA</td>\n<td headers=\"cnt_fam_members\" class=\"gt_row gt_right\">NaN</td>\n<td headers=\"target\" class=\"gt_row gt_right\">0</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n\n```{.r .cell-code}\npy$id_to_remove <- df %>% \n  filter(\n    if_any(one_cols, ~ . %>% is.na())\n  ) %>% \n  pull(id)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Using an external vector in selections was deprecated in tidyselect 1.1.0.\nℹ Please use `all_of()` or `any_of()` instead.\n  # Was:\n  data %>% select(one_cols)\n\n  # Now:\n  data %>% select(all_of(one_cols))\n\nSee <https://tidyselect.r-lib.org/reference/faq-external-vector.html>.\n```\n\n\n:::\n:::\n\n\n\n#### Interesting features\n\nLets also look at some interesting variables: click on the different tabs to see the frequency table for each of them.\n\n::: callout-note\nFuture upgrade will convert this tabset to a Shiny app. I am encountering some difficulties with shinylive, meaning it is not showing the plot.\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# features to check\ncols <- py$config$features\n# \ncount_results <- map(cols, ~ df %>% filter(!is.na(occupation_type)) %>% count(.data[[.x]]))\nnames(count_results) <- cols\ncols\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n [1] \"code_gender\"         \"flag_own_car\"        \"flag_own_realty\"    \n [4] \"name_income_type\"    \"name_education_type\" \"name_family_status\" \n [7] \"name_housing_type\"   \"occupation_type\"     \"cnt_children\"       \n[10] \"amt_income_total\"    \"cnt_fam_members\"    \n```\n\n\n:::\n:::\n\n\n\n::: panel-tabset\n## Count children\n\n\n\n::: {#tbl-cnt_children .cell tbl-cap='Count of Number of Children'}\n\n```{.r .cell-code}\ncount_results$cnt_children %>% \n  arrange(desc(n)) %>% \n  gt() %>% \n  tab_options(\n    table.width = pct(100)\n    ) %>% \n  cols_align(align = \"center\") %>% \n  cols_label(\n    cnt_children = \"# Children\",\n    n = \"Count\"\n  ) %>% \n  tab_header(\n    title = \"Count of Number of Children\",\n  ) %>% \n  fmt_number(\n    columns = c(\"n\"),\n    decimals = 2,\n    drop_trailing_zeros = TRUE,\n    #drop_trailing_dec_mark = FALSE\n  ) \n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"scwmebfnpm\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#scwmebfnpm table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#scwmebfnpm thead, #scwmebfnpm tbody, #scwmebfnpm tfoot, #scwmebfnpm tr, #scwmebfnpm td, #scwmebfnpm th {\n  border-style: none;\n}\n\n#scwmebfnpm p {\n  margin: 0;\n  padding: 0;\n}\n\n#scwmebfnpm .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: 100%;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#scwmebfnpm .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#scwmebfnpm .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#scwmebfnpm .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#scwmebfnpm .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#scwmebfnpm .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#scwmebfnpm .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#scwmebfnpm .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#scwmebfnpm .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#scwmebfnpm .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#scwmebfnpm .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#scwmebfnpm .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#scwmebfnpm .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#scwmebfnpm .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#scwmebfnpm .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#scwmebfnpm .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#scwmebfnpm .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#scwmebfnpm .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#scwmebfnpm .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#scwmebfnpm .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#scwmebfnpm .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#scwmebfnpm .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#scwmebfnpm .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#scwmebfnpm .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#scwmebfnpm .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#scwmebfnpm .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#scwmebfnpm .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#scwmebfnpm .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#scwmebfnpm .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#scwmebfnpm .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#scwmebfnpm .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#scwmebfnpm .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#scwmebfnpm .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#scwmebfnpm .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#scwmebfnpm .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#scwmebfnpm .gt_left {\n  text-align: left;\n}\n\n#scwmebfnpm .gt_center {\n  text-align: center;\n}\n\n#scwmebfnpm .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#scwmebfnpm .gt_font_normal {\n  font-weight: normal;\n}\n\n#scwmebfnpm .gt_font_bold {\n  font-weight: bold;\n}\n\n#scwmebfnpm .gt_font_italic {\n  font-style: italic;\n}\n\n#scwmebfnpm .gt_super {\n  font-size: 65%;\n}\n\n#scwmebfnpm .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#scwmebfnpm .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#scwmebfnpm .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#scwmebfnpm .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#scwmebfnpm .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#scwmebfnpm .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#scwmebfnpm .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#scwmebfnpm .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#scwmebfnpm div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_heading\">\n      <td colspan=\"2\" class=\"gt_heading gt_title gt_font_normal gt_bottom_border\" style>Count of Number of Children</td>\n    </tr>\n    \n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"cnt_children\"># Children</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"n\">Count</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"cnt_children\" class=\"gt_row gt_center\">0</td>\n<td headers=\"n\" class=\"gt_row gt_center\">148,909</td></tr>\n    <tr><td headers=\"cnt_children\" class=\"gt_row gt_center\">1</td>\n<td headers=\"n\" class=\"gt_row gt_center\">56,238</td></tr>\n    <tr><td headers=\"cnt_children\" class=\"gt_row gt_center\">2</td>\n<td headers=\"n\" class=\"gt_row gt_center\">26,196</td></tr>\n    <tr><td headers=\"cnt_children\" class=\"gt_row gt_center\">3</td>\n<td headers=\"n\" class=\"gt_row gt_center\">3,319</td></tr>\n    <tr><td headers=\"cnt_children\" class=\"gt_row gt_center\">4</td>\n<td headers=\"n\" class=\"gt_row gt_center\">300</td></tr>\n    <tr><td headers=\"cnt_children\" class=\"gt_row gt_center\">5</td>\n<td headers=\"n\" class=\"gt_row gt_center\">109</td></tr>\n    <tr><td headers=\"cnt_children\" class=\"gt_row gt_center\">9</td>\n<td headers=\"n\" class=\"gt_row gt_center\">4</td></tr>\n    <tr><td headers=\"cnt_children\" class=\"gt_row gt_center\">12</td>\n<td headers=\"n\" class=\"gt_row gt_center\">4</td></tr>\n    <tr><td headers=\"cnt_children\" class=\"gt_row gt_center\">14</td>\n<td headers=\"n\" class=\"gt_row gt_center\">3</td></tr>\n    <tr><td headers=\"cnt_children\" class=\"gt_row gt_center\">7</td>\n<td headers=\"n\" class=\"gt_row gt_center\">2</td></tr>\n    <tr><td headers=\"cnt_children\" class=\"gt_row gt_center\">19</td>\n<td headers=\"n\" class=\"gt_row gt_center\">1</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n\n## Education type\n\n\n\n::: {#tbl-name_education_type .cell tbl-cap='Count by Education Type'}\n\n```{.r .cell-code}\ncount_results$name_education_type %>% \n  arrange(desc(n)) %>% \n  gt()  %>% \n  tab_options(\n    table.width = pct(100)\n    ) %>% \n  cols_align(align = \"center\") %>% \n  cols_label(\n    name_education_type = \"Education Type\",\n    n = \"Count\"\n  ) %>% \n  tab_header(\n    title = \"Count by Education Type\",\n  ) %>% \n  fmt_number(\n    columns = c(\"n\"),\n    decimals = 2,\n    drop_trailing_zeros = TRUE,\n    #drop_trailing_dec_mark = FALSE\n  ) \n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"panjklxwwe\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#panjklxwwe table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#panjklxwwe thead, #panjklxwwe tbody, #panjklxwwe tfoot, #panjklxwwe tr, #panjklxwwe td, #panjklxwwe th {\n  border-style: none;\n}\n\n#panjklxwwe p {\n  margin: 0;\n  padding: 0;\n}\n\n#panjklxwwe .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: 100%;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#panjklxwwe .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#panjklxwwe .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#panjklxwwe .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#panjklxwwe .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#panjklxwwe .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#panjklxwwe .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#panjklxwwe .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#panjklxwwe .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#panjklxwwe .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#panjklxwwe .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#panjklxwwe .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#panjklxwwe .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#panjklxwwe .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#panjklxwwe .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#panjklxwwe .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#panjklxwwe .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#panjklxwwe .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#panjklxwwe .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#panjklxwwe .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#panjklxwwe .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#panjklxwwe .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#panjklxwwe .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#panjklxwwe .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#panjklxwwe .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#panjklxwwe .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#panjklxwwe .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#panjklxwwe .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#panjklxwwe .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#panjklxwwe .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#panjklxwwe .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#panjklxwwe .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#panjklxwwe .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#panjklxwwe .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#panjklxwwe .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#panjklxwwe .gt_left {\n  text-align: left;\n}\n\n#panjklxwwe .gt_center {\n  text-align: center;\n}\n\n#panjklxwwe .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#panjklxwwe .gt_font_normal {\n  font-weight: normal;\n}\n\n#panjklxwwe .gt_font_bold {\n  font-weight: bold;\n}\n\n#panjklxwwe .gt_font_italic {\n  font-style: italic;\n}\n\n#panjklxwwe .gt_super {\n  font-size: 65%;\n}\n\n#panjklxwwe .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#panjklxwwe .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#panjklxwwe .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#panjklxwwe .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#panjklxwwe .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#panjklxwwe .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#panjklxwwe .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#panjklxwwe .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#panjklxwwe div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_heading\">\n      <td colspan=\"2\" class=\"gt_heading gt_title gt_font_normal gt_bottom_border\" style>Count by Education Type</td>\n    </tr>\n    \n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"name_education_type\">Education Type</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"n\">Count</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"name_education_type\" class=\"gt_row gt_center\">Secondary / secondary special</td>\n<td headers=\"n\" class=\"gt_row gt_center\">157,822</td></tr>\n    <tr><td headers=\"name_education_type\" class=\"gt_row gt_center\">Higher education</td>\n<td headers=\"n\" class=\"gt_row gt_center\">66,693</td></tr>\n    <tr><td headers=\"name_education_type\" class=\"gt_row gt_center\">Incomplete higher</td>\n<td headers=\"n\" class=\"gt_row gt_center\">8,799</td></tr>\n    <tr><td headers=\"name_education_type\" class=\"gt_row gt_center\">Lower secondary</td>\n<td headers=\"n\" class=\"gt_row gt_center\">1,609</td></tr>\n    <tr><td headers=\"name_education_type\" class=\"gt_row gt_center\">Academic degree</td>\n<td headers=\"n\" class=\"gt_row gt_center\">162</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n\n## Family status\n\n\n\n::: {#tbl-name_family_status .cell tbl-cap='Count by Family Status'}\n\n```{.r .cell-code}\ncount_results$name_family_status %>% \n  arrange(desc(n)) %>% \n  gt()  %>% \n  tab_options(\n    table.width = pct(100)\n    ) %>% \n  cols_align(align = \"center\") %>% \n  cols_label(\n    name_family_status = \"Family Status\",\n    n = \"Count\"\n  ) %>% \n  tab_header(\n    title = \"Count by Family Status\",\n  ) %>% \n  fmt_number(\n    columns = c(\"n\"),\n    decimals = 2,\n    drop_trailing_zeros = TRUE,\n    #drop_trailing_dec_mark = FALSE\n  ) \n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"tbnkvycaxo\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#tbnkvycaxo table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#tbnkvycaxo thead, #tbnkvycaxo tbody, #tbnkvycaxo tfoot, #tbnkvycaxo tr, #tbnkvycaxo td, #tbnkvycaxo th {\n  border-style: none;\n}\n\n#tbnkvycaxo p {\n  margin: 0;\n  padding: 0;\n}\n\n#tbnkvycaxo .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: 100%;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#tbnkvycaxo .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#tbnkvycaxo .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#tbnkvycaxo .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#tbnkvycaxo .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#tbnkvycaxo .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#tbnkvycaxo .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#tbnkvycaxo .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#tbnkvycaxo .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#tbnkvycaxo .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#tbnkvycaxo .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#tbnkvycaxo .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#tbnkvycaxo .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#tbnkvycaxo .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#tbnkvycaxo .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#tbnkvycaxo .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#tbnkvycaxo .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#tbnkvycaxo .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#tbnkvycaxo .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#tbnkvycaxo .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#tbnkvycaxo .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#tbnkvycaxo .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#tbnkvycaxo .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#tbnkvycaxo .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#tbnkvycaxo .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#tbnkvycaxo .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#tbnkvycaxo .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#tbnkvycaxo .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#tbnkvycaxo .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#tbnkvycaxo .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#tbnkvycaxo .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#tbnkvycaxo .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#tbnkvycaxo .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#tbnkvycaxo .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#tbnkvycaxo .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#tbnkvycaxo .gt_left {\n  text-align: left;\n}\n\n#tbnkvycaxo .gt_center {\n  text-align: center;\n}\n\n#tbnkvycaxo .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#tbnkvycaxo .gt_font_normal {\n  font-weight: normal;\n}\n\n#tbnkvycaxo .gt_font_bold {\n  font-weight: bold;\n}\n\n#tbnkvycaxo .gt_font_italic {\n  font-style: italic;\n}\n\n#tbnkvycaxo .gt_super {\n  font-size: 65%;\n}\n\n#tbnkvycaxo .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#tbnkvycaxo .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#tbnkvycaxo .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#tbnkvycaxo .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#tbnkvycaxo .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#tbnkvycaxo .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#tbnkvycaxo .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#tbnkvycaxo .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#tbnkvycaxo div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_heading\">\n      <td colspan=\"2\" class=\"gt_heading gt_title gt_font_normal gt_bottom_border\" style>Count by Family Status</td>\n    </tr>\n    \n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"name_family_status\">Family Status</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"n\">Count</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"name_family_status\" class=\"gt_row gt_center\">Married</td>\n<td headers=\"n\" class=\"gt_row gt_center\">164,310</td></tr>\n    <tr><td headers=\"name_family_status\" class=\"gt_row gt_center\">Single / not married</td>\n<td headers=\"n\" class=\"gt_row gt_center\">30,551</td></tr>\n    <tr><td headers=\"name_family_status\" class=\"gt_row gt_center\">Civil marriage</td>\n<td headers=\"n\" class=\"gt_row gt_center\">20,968</td></tr>\n    <tr><td headers=\"name_family_status\" class=\"gt_row gt_center\">Separated</td>\n<td headers=\"n\" class=\"gt_row gt_center\">14,108</td></tr>\n    <tr><td headers=\"name_family_status\" class=\"gt_row gt_center\">Widow</td>\n<td headers=\"n\" class=\"gt_row gt_center\">5,148</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n\n## Housing type\n\n\n\n::: {#tbl-name_housing_type .cell tbl-cap='Count by House Type'}\n\n```{.r .cell-code}\ncount_results$name_housing_type %>% \n  arrange(desc(n)) %>% \n  gt()  %>% \n  tab_options(\n    table.width = pct(100)\n    ) %>% \n  cols_align(align = \"center\") %>% \n  cols_label(\n    name_housing_type = \"House Type\",\n    n = \"Count\"\n  ) %>% \n  tab_header(\n    title = \"Count by House Type\",\n  ) %>% \n  fmt_number(\n    columns = c(\"n\"),\n    decimals = 2,\n    drop_trailing_zeros = TRUE,\n    #drop_trailing_dec_mark = FALSE\n  ) \n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"hhtfxljaoz\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#hhtfxljaoz table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#hhtfxljaoz thead, #hhtfxljaoz tbody, #hhtfxljaoz tfoot, #hhtfxljaoz tr, #hhtfxljaoz td, #hhtfxljaoz th {\n  border-style: none;\n}\n\n#hhtfxljaoz p {\n  margin: 0;\n  padding: 0;\n}\n\n#hhtfxljaoz .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: 100%;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#hhtfxljaoz .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#hhtfxljaoz .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#hhtfxljaoz .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#hhtfxljaoz .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#hhtfxljaoz .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#hhtfxljaoz .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#hhtfxljaoz .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#hhtfxljaoz .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#hhtfxljaoz .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#hhtfxljaoz .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#hhtfxljaoz .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#hhtfxljaoz .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#hhtfxljaoz .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#hhtfxljaoz .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#hhtfxljaoz .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#hhtfxljaoz .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#hhtfxljaoz .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#hhtfxljaoz .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#hhtfxljaoz .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#hhtfxljaoz .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#hhtfxljaoz .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#hhtfxljaoz .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#hhtfxljaoz .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#hhtfxljaoz .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#hhtfxljaoz .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#hhtfxljaoz .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#hhtfxljaoz .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#hhtfxljaoz .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#hhtfxljaoz .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#hhtfxljaoz .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#hhtfxljaoz .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#hhtfxljaoz .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#hhtfxljaoz .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#hhtfxljaoz .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#hhtfxljaoz .gt_left {\n  text-align: left;\n}\n\n#hhtfxljaoz .gt_center {\n  text-align: center;\n}\n\n#hhtfxljaoz .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#hhtfxljaoz .gt_font_normal {\n  font-weight: normal;\n}\n\n#hhtfxljaoz .gt_font_bold {\n  font-weight: bold;\n}\n\n#hhtfxljaoz .gt_font_italic {\n  font-style: italic;\n}\n\n#hhtfxljaoz .gt_super {\n  font-size: 65%;\n}\n\n#hhtfxljaoz .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#hhtfxljaoz .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#hhtfxljaoz .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#hhtfxljaoz .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#hhtfxljaoz .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#hhtfxljaoz .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#hhtfxljaoz .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#hhtfxljaoz .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#hhtfxljaoz div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_heading\">\n      <td colspan=\"2\" class=\"gt_heading gt_title gt_font_normal gt_bottom_border\" style>Count by House Type</td>\n    </tr>\n    \n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"name_housing_type\">House Type</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"n\">Count</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"name_housing_type\" class=\"gt_row gt_center\">House / apartment</td>\n<td headers=\"n\" class=\"gt_row gt_center\">208,980</td></tr>\n    <tr><td headers=\"name_housing_type\" class=\"gt_row gt_center\">With parents</td>\n<td headers=\"n\" class=\"gt_row gt_center\">11,938</td></tr>\n    <tr><td headers=\"name_housing_type\" class=\"gt_row gt_center\">Municipal apartment</td>\n<td headers=\"n\" class=\"gt_row gt_center\">7,411</td></tr>\n    <tr><td headers=\"name_housing_type\" class=\"gt_row gt_center\">Rented apartment</td>\n<td headers=\"n\" class=\"gt_row gt_center\">3,549</td></tr>\n    <tr><td headers=\"name_housing_type\" class=\"gt_row gt_center\">Office apartment</td>\n<td headers=\"n\" class=\"gt_row gt_center\">2,270</td></tr>\n    <tr><td headers=\"name_housing_type\" class=\"gt_row gt_center\">Co-op apartment</td>\n<td headers=\"n\" class=\"gt_row gt_center\">937</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n\n## Count family members\n\n\n\n::: {#tbl-cnt_fam_members .cell tbl-cap='Count by Number of Family Members'}\n\n```{.r .cell-code}\ncount_results$cnt_fam_members %>% \n  arrange(desc(n)) %>% \n  gt()  %>% \n  tab_options(\n    table.width = pct(100)\n    ) %>% \n  cols_align(align = \"center\") %>% \n  cols_label(\n    cnt_fam_members = \"Number of Family Members\",\n    n = \"Count\"\n  ) %>% \n  tab_header(\n    title = \"Count by Number of Family Members\",\n  ) %>% \n  fmt_number(\n    columns = c(\"n\"),\n    decimals = 2,\n    drop_trailing_zeros = TRUE,\n    #drop_trailing_dec_mark = FALSE\n  ) \n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"cqutpqvekv\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#cqutpqvekv table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#cqutpqvekv thead, #cqutpqvekv tbody, #cqutpqvekv tfoot, #cqutpqvekv tr, #cqutpqvekv td, #cqutpqvekv th {\n  border-style: none;\n}\n\n#cqutpqvekv p {\n  margin: 0;\n  padding: 0;\n}\n\n#cqutpqvekv .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: 100%;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#cqutpqvekv .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#cqutpqvekv .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#cqutpqvekv .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#cqutpqvekv .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#cqutpqvekv .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#cqutpqvekv .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#cqutpqvekv .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#cqutpqvekv .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#cqutpqvekv .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#cqutpqvekv .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#cqutpqvekv .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#cqutpqvekv .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#cqutpqvekv .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#cqutpqvekv .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#cqutpqvekv .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#cqutpqvekv .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#cqutpqvekv .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#cqutpqvekv .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#cqutpqvekv .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#cqutpqvekv .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#cqutpqvekv .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#cqutpqvekv .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#cqutpqvekv .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#cqutpqvekv .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#cqutpqvekv .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#cqutpqvekv .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#cqutpqvekv .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#cqutpqvekv .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#cqutpqvekv .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#cqutpqvekv .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#cqutpqvekv .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#cqutpqvekv .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#cqutpqvekv .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#cqutpqvekv .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#cqutpqvekv .gt_left {\n  text-align: left;\n}\n\n#cqutpqvekv .gt_center {\n  text-align: center;\n}\n\n#cqutpqvekv .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#cqutpqvekv .gt_font_normal {\n  font-weight: normal;\n}\n\n#cqutpqvekv .gt_font_bold {\n  font-weight: bold;\n}\n\n#cqutpqvekv .gt_font_italic {\n  font-style: italic;\n}\n\n#cqutpqvekv .gt_super {\n  font-size: 65%;\n}\n\n#cqutpqvekv .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#cqutpqvekv .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#cqutpqvekv .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#cqutpqvekv .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#cqutpqvekv .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#cqutpqvekv .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#cqutpqvekv .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#cqutpqvekv .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#cqutpqvekv div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_heading\">\n      <td colspan=\"2\" class=\"gt_heading gt_title gt_font_normal gt_bottom_border\" style>Count by Number of Family Members</td>\n    </tr>\n    \n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"cnt_fam_members\">Number of Family Members</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"n\">Count</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"cnt_fam_members\" class=\"gt_row gt_center\">2</td>\n<td headers=\"n\" class=\"gt_row gt_center\">118,852</td></tr>\n    <tr><td headers=\"cnt_fam_members\" class=\"gt_row gt_center\">3</td>\n<td headers=\"n\" class=\"gt_row gt_center\">49,232</td></tr>\n    <tr><td headers=\"cnt_fam_members\" class=\"gt_row gt_center\">1</td>\n<td headers=\"n\" class=\"gt_row gt_center\">38,902</td></tr>\n    <tr><td headers=\"cnt_fam_members\" class=\"gt_row gt_center\">4</td>\n<td headers=\"n\" class=\"gt_row gt_center\">24,556</td></tr>\n    <tr><td headers=\"cnt_fam_members\" class=\"gt_row gt_center\">5</td>\n<td headers=\"n\" class=\"gt_row gt_center\">3,138</td></tr>\n    <tr><td headers=\"cnt_fam_members\" class=\"gt_row gt_center\">6</td>\n<td headers=\"n\" class=\"gt_row gt_center\">282</td></tr>\n    <tr><td headers=\"cnt_fam_members\" class=\"gt_row gt_center\">7</td>\n<td headers=\"n\" class=\"gt_row gt_center\">109</td></tr>\n    <tr><td headers=\"cnt_fam_members\" class=\"gt_row gt_center\">11</td>\n<td headers=\"n\" class=\"gt_row gt_center\">4</td></tr>\n    <tr><td headers=\"cnt_fam_members\" class=\"gt_row gt_center\">14</td>\n<td headers=\"n\" class=\"gt_row gt_center\">4</td></tr>\n    <tr><td headers=\"cnt_fam_members\" class=\"gt_row gt_center\">15</td>\n<td headers=\"n\" class=\"gt_row gt_center\">3</td></tr>\n    <tr><td headers=\"cnt_fam_members\" class=\"gt_row gt_center\">9</td>\n<td headers=\"n\" class=\"gt_row gt_center\">2</td></tr>\n    <tr><td headers=\"cnt_fam_members\" class=\"gt_row gt_center\">20</td>\n<td headers=\"n\" class=\"gt_row gt_center\">1</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n\n## Gender\n\n\n\n::: {#tbl-code_gender .cell tbl-cap='Count by Gender'}\n\n```{.r .cell-code}\ncount_results$code_gender %>% \n  arrange(desc(n)) %>% \n  gt() %>% \n  tab_options(\n    table.width = pct(100)\n    ) %>% \n  cols_align(align = \"center\") %>% \n  cols_label(\n    code_gender = \"Gender\",\n    n = \"Count\"\n  ) %>% \n  tab_header(\n    title = \"Count by Gender\",\n  ) %>% \n  fmt_number(\n    columns = c(\"n\"),\n    decimals = 2,\n    drop_trailing_zeros = TRUE,\n    #drop_trailing_dec_mark = FALSE\n  ) \n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"ovgujtfmrf\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#ovgujtfmrf table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#ovgujtfmrf thead, #ovgujtfmrf tbody, #ovgujtfmrf tfoot, #ovgujtfmrf tr, #ovgujtfmrf td, #ovgujtfmrf th {\n  border-style: none;\n}\n\n#ovgujtfmrf p {\n  margin: 0;\n  padding: 0;\n}\n\n#ovgujtfmrf .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: 100%;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#ovgujtfmrf .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#ovgujtfmrf .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#ovgujtfmrf .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#ovgujtfmrf .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#ovgujtfmrf .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ovgujtfmrf .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#ovgujtfmrf .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#ovgujtfmrf .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#ovgujtfmrf .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#ovgujtfmrf .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#ovgujtfmrf .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#ovgujtfmrf .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#ovgujtfmrf .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#ovgujtfmrf .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#ovgujtfmrf .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#ovgujtfmrf .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#ovgujtfmrf .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#ovgujtfmrf .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ovgujtfmrf .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#ovgujtfmrf .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#ovgujtfmrf .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#ovgujtfmrf .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ovgujtfmrf .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#ovgujtfmrf .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#ovgujtfmrf .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ovgujtfmrf .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ovgujtfmrf .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#ovgujtfmrf .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ovgujtfmrf .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#ovgujtfmrf .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ovgujtfmrf .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#ovgujtfmrf .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ovgujtfmrf .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#ovgujtfmrf .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ovgujtfmrf .gt_left {\n  text-align: left;\n}\n\n#ovgujtfmrf .gt_center {\n  text-align: center;\n}\n\n#ovgujtfmrf .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#ovgujtfmrf .gt_font_normal {\n  font-weight: normal;\n}\n\n#ovgujtfmrf .gt_font_bold {\n  font-weight: bold;\n}\n\n#ovgujtfmrf .gt_font_italic {\n  font-style: italic;\n}\n\n#ovgujtfmrf .gt_super {\n  font-size: 65%;\n}\n\n#ovgujtfmrf .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#ovgujtfmrf .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#ovgujtfmrf .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#ovgujtfmrf .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#ovgujtfmrf .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#ovgujtfmrf .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#ovgujtfmrf .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#ovgujtfmrf .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#ovgujtfmrf div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_heading\">\n      <td colspan=\"2\" class=\"gt_heading gt_title gt_font_normal gt_bottom_border\" style>Count by Gender</td>\n    </tr>\n    \n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"code_gender\">Gender</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"n\">Count</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"code_gender\" class=\"gt_row gt_center\">F</td>\n<td headers=\"n\" class=\"gt_row gt_center\">147,505</td></tr>\n    <tr><td headers=\"code_gender\" class=\"gt_row gt_center\">M</td>\n<td headers=\"n\" class=\"gt_row gt_center\">87,580</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n:::\n\n# Data preparation\n\nFrom the EDA, we know we can drop\n\n-   NA occupation_type.\n-   the id 6.39218\\times 10^{6}.\n\n\n\n::: {.cell}\n\n```{.python .cell-code}\ndf = df[df.id != id_to_remove]\ndf = df[~df.occupation_type.isna()]\n```\n:::\n\n\n\nEven if it is not useful for the model because these are not features, I want to convert the date columns to birthday and date of employment.\n\n\n\n::: {.cell}\n\n```{.python .cell-code}\ndf[\"birthday\"] = df.days_birth.map(lambda x : (date.today() + relativedelta(days=x)).strftime(\"%Y-%m-%d\"))\ndf[\"employed\"] = df[\"days_employed\"].apply(lambda x: (date.today() + relativedelta(days=x)).strftime(\"%Y-%m-%d\") if x < 0 else \"0\")\n```\n:::\n\n\n\n# Split\n\nTo take into consideration the unbalance and have it also in our split, we can use the `stratify` method.\n\n\n\n::: {.cell}\n\n```{.python .cell-code}\nx = df[config.features]\ny = df.target\n\nxtrain, xtest, ytrain, ytest = train_test_split(\n    x,\n    y,\n    test_size = .2,\n    stratify = y,\n    random_state=config.random_state\n)\n```\n:::\n\n\n\n# Models\n\nTo address the model **explainability**, we can choose a CART model. They have 2 interesting point for our task:\n\n1.  **Explainability**, as already mentioned. This will help us explain the reason of rejection.\n2.  **Feature selection.** At this [link](https://www.researchgate.net/publication/369355042_A_Comprehensive_Review_of_Feature_Selection_and_Feature_Selection_Stability_in_Machine_Learning) you can find a paper which shows how **embedded method** as the tree models can have the same performance of traditional feature selection method.\n\n::: {callout-important}\nIt could be also interesting to do a **R**ecursive **F**eature **E**limination. Right now the feature selection is made with personal knowledge to remove some columns before training. The CART model will perform the feature selection, as the paper above explain.\n:::\n\nWe are going to implement 3 models with an increasingly level of complexity:\n\n1.  DecisionTreeClassifier.\n2.  RandomForestClassifier.\n3.  XGBoostClassifier.\n\n## DecisionTreeClassifier\n\n### Pipeline\n\nEven if the result of the model are relatively easy to understand, the **hyperparameter tuning** has far too many possibility. This is where `GridSearchCV()` comes handy. Check @lst-config for more details.\n\n\n\n::: {.cell}\n\n```{.python .cell-code}\ndtc = config.make_dtc()\n```\n:::\n\n\n\nOne of the many nice `sklearn` features is the [`Pipeline()`](https://scikit-learn.org/1.5/modules/generated/sklearn.pipeline.Pipeline.html). It has lots of important benefits:\n\n-   **Code redundancy and reproducibility** : it is like a recipe you can tune and run without worrying about to put togheter each step in the correct order.\n-   **Avoid data leakege**: the preprocessing steps applies only to the training dataset.\n-   **Hyperparameter tuning**: the `Pipeline()` integrates with `GridSearchCV()` and `RandomizedSearchCV()`.\n-   **Modularity**: it enables tuning the various steps, removing or adding new one.\n\nFirst, initialize the various preprocessor and the classification model.\n\nUsing the `ColumnTransformer()`, we can apply the different preprocessing to the specific columns. The preprocessing is divided between:\n\n-   Encoding the **binary labels** to 0-1 using `OneHotEncoding(drop=\"if_binary)\"`.\n-   Encoding the remaining labels using `OneHotEncoding()`. I choose this over other categorical variables encoding because it avoid imputing a hierarchy.\n-   **Standardize** the numerical variables using `StandardScaler()`. I also have instantiated the `MinMaxScaler()`, but I am not using it.\n\nThe classifier is a `DecisionTreeClassifier()`, which the `GridSearchCV()` will tune.\n\nAll of these steps are putted togheter with the `Pipeline()`.\n\n::: {callout-important}\nFor the binary labels I had to use the `OneHotEncoding(drop=\"if_binary\")`, otherwise other preprocessor would not work with the `ColumnTransformer()`.\n:::\n\n### Fit\n\n\n\n::: {.cell}\n\n```{.python .cell-code}\ndtc_model = dtc.fit(xtrain, ytrain)\n```\n:::\n\n\n\nCheck @lst-config for more details.\n\n### Pickle\n\n\n\n::: {.cell}\n\n```{.python .cell-code}\nconfig.dump_pkl(\n  path=os.path.expanduser(config.pkl_path) + \"dtc_model.pkl\",\n  model=dtc_model\n  )\n```\n:::\n\n::: {.cell}\n\n```{.python .cell-code}\ndtc = config.load_pkl(\n  path=os.path.expanduser(config.pkl_path) + \"dtc_model.pkl\"\n  )\ndtc_model = dtc.best_estimator_\n```\n:::\n\n\n\n### Classification Report\n\n\n\n::: {.cell}\n\n```{.python .cell-code}\nypred_dtc = dtc_model.predict(xtest)\ncr = classification_report(\n  ytest,\n  ypred_dtc,\n  target_names=['0', '1'],\n  digits=4,\n  output_dict=True\n  )\ndf_cr_dtc= pd.DataFrame.from_dict(cr).reset_index()\n```\n:::\n\n::: {#tbl-classification-report-dtc .cell tbl-cap='Classification report DTC'}\n\n```{.r .cell-code}\nlibrary(reticulate)\ndf_cr <- py$df_cr_dtc %>% dplyr::rename(names = index)\ncols <- df_cr %>% colnames()\ndf_cr %>% \n  pivot_longer(\n    cols = -names,\n    names_to = \"metrics\",\n    values_to = \"values\"\n  ) %>% \n  pivot_wider(\n    names_from = names,\n    values_from = values\n  ) %>% \n  gt() %>%\n  tab_header(\n    title = \"Confusion Matrix\",\n    subtitle = \"Threshold optimization favoring recall\"\n  ) %>% \n  fmt_number(\n    columns = c(\"precision\", \"recall\", \"f1-score\", \"support\"),\n    decimals = 2,\n    drop_trailing_zeros = TRUE,\n    drop_trailing_dec_mark = FALSE\n  ) %>% \n  cols_align(\n    align = \"center\",\n    columns = c(\"precision\", \"recall\", \"f1-score\", \"support\")\n  ) %>% \n  cols_align(\n    align = \"left\",\n    columns = metrics\n  ) %>% \n  cols_label(\n    metrics = \"Metrics\",\n    precision = \"Precision\",\n    recall = \"Recall\",\n    `f1-score` = \"F1-Score\",\n    support = \"Support\"\n  ) %>% \n  tab_options(\n    table.width = pct(100)\n    )\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"iqrwrfhson\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#iqrwrfhson table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#iqrwrfhson thead, #iqrwrfhson tbody, #iqrwrfhson tfoot, #iqrwrfhson tr, #iqrwrfhson td, #iqrwrfhson th {\n  border-style: none;\n}\n\n#iqrwrfhson p {\n  margin: 0;\n  padding: 0;\n}\n\n#iqrwrfhson .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: 100%;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#iqrwrfhson .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#iqrwrfhson .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#iqrwrfhson .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#iqrwrfhson .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#iqrwrfhson .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#iqrwrfhson .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#iqrwrfhson .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#iqrwrfhson .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#iqrwrfhson .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#iqrwrfhson .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#iqrwrfhson .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#iqrwrfhson .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#iqrwrfhson .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#iqrwrfhson .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#iqrwrfhson .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#iqrwrfhson .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#iqrwrfhson .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#iqrwrfhson .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#iqrwrfhson .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#iqrwrfhson .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#iqrwrfhson .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#iqrwrfhson .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#iqrwrfhson .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#iqrwrfhson .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#iqrwrfhson .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#iqrwrfhson .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#iqrwrfhson .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#iqrwrfhson .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#iqrwrfhson .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#iqrwrfhson .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#iqrwrfhson .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#iqrwrfhson .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#iqrwrfhson .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#iqrwrfhson .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#iqrwrfhson .gt_left {\n  text-align: left;\n}\n\n#iqrwrfhson .gt_center {\n  text-align: center;\n}\n\n#iqrwrfhson .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#iqrwrfhson .gt_font_normal {\n  font-weight: normal;\n}\n\n#iqrwrfhson .gt_font_bold {\n  font-weight: bold;\n}\n\n#iqrwrfhson .gt_font_italic {\n  font-style: italic;\n}\n\n#iqrwrfhson .gt_super {\n  font-size: 65%;\n}\n\n#iqrwrfhson .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#iqrwrfhson .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#iqrwrfhson .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#iqrwrfhson .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#iqrwrfhson .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#iqrwrfhson .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#iqrwrfhson .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#iqrwrfhson .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#iqrwrfhson div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_heading\">\n      <td colspan=\"5\" class=\"gt_heading gt_title gt_font_normal\" style>Confusion Matrix</td>\n    </tr>\n    <tr class=\"gt_heading\">\n      <td colspan=\"5\" class=\"gt_heading gt_subtitle gt_font_normal gt_bottom_border\" style>Threshold optimization favoring recall</td>\n    </tr>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"metrics\">Metrics</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"precision\">Precision</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"recall\">Recall</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"f1-score\">F1-Score</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"support\">Support</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"metrics\" class=\"gt_row gt_left\">0</td>\n<td headers=\"precision\" class=\"gt_row gt_center\">0.99</td>\n<td headers=\"recall\" class=\"gt_row gt_center\">0.74</td>\n<td headers=\"f1-score\" class=\"gt_row gt_center\">0.85</td>\n<td headers=\"support\" class=\"gt_row gt_center\">41,986.</td></tr>\n    <tr><td headers=\"metrics\" class=\"gt_row gt_left\">1</td>\n<td headers=\"precision\" class=\"gt_row gt_center\">0.3</td>\n<td headers=\"recall\" class=\"gt_row gt_center\">0.94</td>\n<td headers=\"f1-score\" class=\"gt_row gt_center\">0.46</td>\n<td headers=\"support\" class=\"gt_row gt_center\">5,031.</td></tr>\n    <tr><td headers=\"metrics\" class=\"gt_row gt_left\">accuracy</td>\n<td headers=\"precision\" class=\"gt_row gt_center\">0.76</td>\n<td headers=\"recall\" class=\"gt_row gt_center\">0.76</td>\n<td headers=\"f1-score\" class=\"gt_row gt_center\">0.76</td>\n<td headers=\"support\" class=\"gt_row gt_center\">0.76</td></tr>\n    <tr><td headers=\"metrics\" class=\"gt_row gt_left\">macro avg</td>\n<td headers=\"precision\" class=\"gt_row gt_center\">0.65</td>\n<td headers=\"recall\" class=\"gt_row gt_center\">0.84</td>\n<td headers=\"f1-score\" class=\"gt_row gt_center\">0.65</td>\n<td headers=\"support\" class=\"gt_row gt_center\">47,017.</td></tr>\n    <tr><td headers=\"metrics\" class=\"gt_row gt_left\">weighted avg</td>\n<td headers=\"precision\" class=\"gt_row gt_center\">0.92</td>\n<td headers=\"recall\" class=\"gt_row gt_center\">0.76</td>\n<td headers=\"f1-score\" class=\"gt_row gt_center\">0.81</td>\n<td headers=\"support\" class=\"gt_row gt_center\">47,017.</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n\n## RandomForestClassifier\n\n### Pipeline\n\n\n\n::: {.cell}\n\n```{.python .cell-code}\nrfc = config.make_rfc()\n```\n:::\n\n\n\nCheck @lst-config for more details.\n\n### Fit\n\n\n\n::: {.cell}\n\n```{.python .cell-code}\ntic = time.time()\nrfc_model = rfc.fit(xtrain, ytrain)\ntoc = time.time()\nelapsed_time= toc - tic\nprint(f\"Elapsed time: {elapsed_time} seconds\")\nprint(f\"Elapsed time: {elapsed_time / 60} minutes\")\n```\n:::\n\n\n\n### Pickle\n\n\n\n::: {.cell}\n\n```{.python .cell-code}\nconfig.dump_pkl(\n  path=os.path.expanduser(config.pkl_path) + \"rfc_model.pkl\",\n  model=rfc_model\n  )\n```\n:::\n\n::: {.cell}\n\n```{.python .cell-code}\nrfc = config.load_pkl(\n  path=os.path.expanduser(config.pkl_path) + \"rfc_model.pkl\"\n  )\nrfc_model = rfc.best_estimator_\n```\n:::\n\n\n\n### Classification\n\n\n\n::: {.cell}\n\n```{.python .cell-code}\nypred_rfc = rfc_model.predict(xtest)\ncr_rfc = classification_report(\n  ytest,\n  ypred_rfc,\n  # target_names=config.labels,\n  digits=4,\n  output_dict=True\n  )\ndf_cr_rfc = pd.DataFrame.from_dict(cr_rfc).reset_index()\n```\n:::\n\n::: {#tbl-classification-report-rfc .cell tbl-cap='Classification report RFC'}\n\n```{.r .cell-code}\nlibrary(reticulate)\ndf_cr <- py$df_cr_rfc %>% dplyr::rename(names = index)\ncols <- df_cr %>% colnames()\ndf_cr %>% \n  pivot_longer(\n    cols = -names,\n    names_to = \"metrics\",\n    values_to = \"values\"\n  ) %>% \n  pivot_wider(\n    names_from = names,\n    values_from = values\n  ) %>% \n  gt() %>%\n  tab_header(\n    title = \"Confusion Matrix\",\n    subtitle = \"Threshold optimization favoring recall\"\n  ) %>% \n  fmt_number(\n    columns = c(\"precision\", \"recall\", \"f1-score\", \"support\"),\n    decimals = 2,\n    drop_trailing_zeros = TRUE,\n    drop_trailing_dec_mark = FALSE\n  ) %>% \n  cols_align(\n    align = \"center\",\n    columns = c(\"precision\", \"recall\", \"f1-score\", \"support\")\n  ) %>% \n  cols_align(\n    align = \"left\",\n    columns = metrics\n  ) %>% \n  cols_label(\n    metrics = \"Metrics\",\n    precision = \"Precision\",\n    recall = \"Recall\",\n    `f1-score` = \"F1-Score\",\n    support = \"Support\"\n  ) %>% \n  tab_options(\n    table.width = pct(100)\n    )\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"viqgnpkurf\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#viqgnpkurf table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#viqgnpkurf thead, #viqgnpkurf tbody, #viqgnpkurf tfoot, #viqgnpkurf tr, #viqgnpkurf td, #viqgnpkurf th {\n  border-style: none;\n}\n\n#viqgnpkurf p {\n  margin: 0;\n  padding: 0;\n}\n\n#viqgnpkurf .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: 100%;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#viqgnpkurf .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#viqgnpkurf .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#viqgnpkurf .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#viqgnpkurf .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#viqgnpkurf .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#viqgnpkurf .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#viqgnpkurf .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#viqgnpkurf .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#viqgnpkurf .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#viqgnpkurf .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#viqgnpkurf .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#viqgnpkurf .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#viqgnpkurf .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#viqgnpkurf .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#viqgnpkurf .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#viqgnpkurf .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#viqgnpkurf .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#viqgnpkurf .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#viqgnpkurf .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#viqgnpkurf .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#viqgnpkurf .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#viqgnpkurf .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#viqgnpkurf .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#viqgnpkurf .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#viqgnpkurf .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#viqgnpkurf .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#viqgnpkurf .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#viqgnpkurf .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#viqgnpkurf .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#viqgnpkurf .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#viqgnpkurf .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#viqgnpkurf .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#viqgnpkurf .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#viqgnpkurf .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#viqgnpkurf .gt_left {\n  text-align: left;\n}\n\n#viqgnpkurf .gt_center {\n  text-align: center;\n}\n\n#viqgnpkurf .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#viqgnpkurf .gt_font_normal {\n  font-weight: normal;\n}\n\n#viqgnpkurf .gt_font_bold {\n  font-weight: bold;\n}\n\n#viqgnpkurf .gt_font_italic {\n  font-style: italic;\n}\n\n#viqgnpkurf .gt_super {\n  font-size: 65%;\n}\n\n#viqgnpkurf .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#viqgnpkurf .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#viqgnpkurf .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#viqgnpkurf .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#viqgnpkurf .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#viqgnpkurf .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#viqgnpkurf .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#viqgnpkurf .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#viqgnpkurf div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_heading\">\n      <td colspan=\"5\" class=\"gt_heading gt_title gt_font_normal\" style>Confusion Matrix</td>\n    </tr>\n    <tr class=\"gt_heading\">\n      <td colspan=\"5\" class=\"gt_heading gt_subtitle gt_font_normal gt_bottom_border\" style>Threshold optimization favoring recall</td>\n    </tr>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"metrics\">Metrics</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"precision\">Precision</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"recall\">Recall</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"f1-score\">F1-Score</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"support\">Support</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"metrics\" class=\"gt_row gt_left\">0</td>\n<td headers=\"precision\" class=\"gt_row gt_center\">0.99</td>\n<td headers=\"recall\" class=\"gt_row gt_center\">0.77</td>\n<td headers=\"f1-score\" class=\"gt_row gt_center\">0.86</td>\n<td headers=\"support\" class=\"gt_row gt_center\">41,986.</td></tr>\n    <tr><td headers=\"metrics\" class=\"gt_row gt_left\">1</td>\n<td headers=\"precision\" class=\"gt_row gt_center\">0.33</td>\n<td headers=\"recall\" class=\"gt_row gt_center\">0.95</td>\n<td headers=\"f1-score\" class=\"gt_row gt_center\">0.49</td>\n<td headers=\"support\" class=\"gt_row gt_center\">5,031.</td></tr>\n    <tr><td headers=\"metrics\" class=\"gt_row gt_left\">accuracy</td>\n<td headers=\"precision\" class=\"gt_row gt_center\">0.79</td>\n<td headers=\"recall\" class=\"gt_row gt_center\">0.79</td>\n<td headers=\"f1-score\" class=\"gt_row gt_center\">0.79</td>\n<td headers=\"support\" class=\"gt_row gt_center\">0.79</td></tr>\n    <tr><td headers=\"metrics\" class=\"gt_row gt_left\">macro avg</td>\n<td headers=\"precision\" class=\"gt_row gt_center\">0.66</td>\n<td headers=\"recall\" class=\"gt_row gt_center\">0.86</td>\n<td headers=\"f1-score\" class=\"gt_row gt_center\">0.68</td>\n<td headers=\"support\" class=\"gt_row gt_center\">47,017.</td></tr>\n    <tr><td headers=\"metrics\" class=\"gt_row gt_left\">weighted avg</td>\n<td headers=\"precision\" class=\"gt_row gt_center\">0.92</td>\n<td headers=\"recall\" class=\"gt_row gt_center\">0.79</td>\n<td headers=\"f1-score\" class=\"gt_row gt_center\">0.82</td>\n<td headers=\"support\" class=\"gt_row gt_center\">47,017.</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n\n## XGBoostClassifier\n\n### Pipeline\n\n\n\n::: {.cell}\n\n```{.python .cell-code}\nxgb = config.make_xgb()\n```\n:::\n\n\n\nCheck @lst-config for more details.\n\n### Fit\n\n\n\n::: {.cell}\n\n```{.python .cell-code}\ntic = time.time()\nxgb_model = xgb.fit(xtrain, ytrain)\ntoc = time.time()\nelapsed_time= toc - tic\nprint(f\"Elapsed time: {elapsed_time} seconds\")\nprint(f\"Elapsed time: {elapsed_time / 60} minutes\")\n```\n:::\n\n\n\n### Pickle\n\n\n\n::: {.cell}\n\n```{.python .cell-code}\nconfig.dump_pkl(\n  path=os.path.expanduser(config.pkl_path) + \"xgb_model.pkl\",\n  model=xgb_model\n  )\n```\n:::\n\n::: {.cell}\n\n```{.python .cell-code}\nxgb = config.load_pkl(\n  path=os.path.expanduser(config.pkl_path) + \"xgb_model.pkl\"\n  )\nxgb_model = xgb.best_estimator_\n```\n:::\n\n\n\n### Classification\n\n\n\n::: {.cell}\n\n```{.python .cell-code}\nypred_xgb = xgb_model.predict(xtest)\ncr_xgb = classification_report(\n  ytest,\n  ypred_xgb,\n  # target_names=config.labels,\n  digits=4,\n  output_dict=True\n  )\ndf_cr_xgb = pd.DataFrame.from_dict(cr_xgb).reset_index()\n```\n:::\n\n::: {#tbl-classification-report-xgb .cell tbl-cap='Classification report XGB'}\n\n```{.r .cell-code}\nlibrary(reticulate)\ndf_cr <- py$df_cr_xgb %>% dplyr::rename(names = index)\ncols <- df_cr %>% colnames()\ndf_cr %>% \n  pivot_longer(\n    cols = -names,\n    names_to = \"metrics\",\n    values_to = \"values\"\n  ) %>% \n  pivot_wider(\n    names_from = names,\n    values_from = values\n  ) %>% \n  gt() %>%\n  tab_header(\n    title = \"Confusion Matrix\",\n    subtitle = \"Threshold optimization favoring recall\"\n  ) %>% \n  fmt_number(\n    columns = c(\"precision\", \"recall\", \"f1-score\", \"support\"),\n    decimals = 2,\n    drop_trailing_zeros = TRUE,\n    drop_trailing_dec_mark = FALSE\n  ) %>% \n  cols_align(\n    align = \"center\",\n    columns = c(\"precision\", \"recall\", \"f1-score\", \"support\")\n  ) %>% \n  cols_align(\n    align = \"left\",\n    columns = metrics\n  ) %>% \n  cols_label(\n    metrics = \"Metrics\",\n    precision = \"Precision\",\n    recall = \"Recall\",\n    `f1-score` = \"F1-Score\",\n    support = \"Support\"\n  ) %>% \n  tab_options(\n    table.width = pct(100)\n    )\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"myabobtrvl\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#myabobtrvl table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#myabobtrvl thead, #myabobtrvl tbody, #myabobtrvl tfoot, #myabobtrvl tr, #myabobtrvl td, #myabobtrvl th {\n  border-style: none;\n}\n\n#myabobtrvl p {\n  margin: 0;\n  padding: 0;\n}\n\n#myabobtrvl .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: 100%;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#myabobtrvl .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#myabobtrvl .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#myabobtrvl .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#myabobtrvl .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#myabobtrvl .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#myabobtrvl .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#myabobtrvl .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#myabobtrvl .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#myabobtrvl .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#myabobtrvl .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#myabobtrvl .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#myabobtrvl .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#myabobtrvl .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#myabobtrvl .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#myabobtrvl .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#myabobtrvl .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#myabobtrvl .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#myabobtrvl .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#myabobtrvl .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#myabobtrvl .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#myabobtrvl .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#myabobtrvl .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#myabobtrvl .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#myabobtrvl .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#myabobtrvl .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#myabobtrvl .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#myabobtrvl .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#myabobtrvl .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#myabobtrvl .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#myabobtrvl .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#myabobtrvl .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#myabobtrvl .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#myabobtrvl .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#myabobtrvl .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#myabobtrvl .gt_left {\n  text-align: left;\n}\n\n#myabobtrvl .gt_center {\n  text-align: center;\n}\n\n#myabobtrvl .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#myabobtrvl .gt_font_normal {\n  font-weight: normal;\n}\n\n#myabobtrvl .gt_font_bold {\n  font-weight: bold;\n}\n\n#myabobtrvl .gt_font_italic {\n  font-style: italic;\n}\n\n#myabobtrvl .gt_super {\n  font-size: 65%;\n}\n\n#myabobtrvl .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#myabobtrvl .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#myabobtrvl .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#myabobtrvl .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#myabobtrvl .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#myabobtrvl .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#myabobtrvl .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#myabobtrvl .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#myabobtrvl div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_heading\">\n      <td colspan=\"5\" class=\"gt_heading gt_title gt_font_normal\" style>Confusion Matrix</td>\n    </tr>\n    <tr class=\"gt_heading\">\n      <td colspan=\"5\" class=\"gt_heading gt_subtitle gt_font_normal gt_bottom_border\" style>Threshold optimization favoring recall</td>\n    </tr>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"metrics\">Metrics</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"precision\">Precision</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"recall\">Recall</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"f1-score\">F1-Score</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"support\">Support</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"metrics\" class=\"gt_row gt_left\">0</td>\n<td headers=\"precision\" class=\"gt_row gt_center\">0.99</td>\n<td headers=\"recall\" class=\"gt_row gt_center\">0.82</td>\n<td headers=\"f1-score\" class=\"gt_row gt_center\">0.9</td>\n<td headers=\"support\" class=\"gt_row gt_center\">41,986.</td></tr>\n    <tr><td headers=\"metrics\" class=\"gt_row gt_left\">1</td>\n<td headers=\"precision\" class=\"gt_row gt_center\">0.39</td>\n<td headers=\"recall\" class=\"gt_row gt_center\">0.95</td>\n<td headers=\"f1-score\" class=\"gt_row gt_center\">0.55</td>\n<td headers=\"support\" class=\"gt_row gt_center\">5,031.</td></tr>\n    <tr><td headers=\"metrics\" class=\"gt_row gt_left\">accuracy</td>\n<td headers=\"precision\" class=\"gt_row gt_center\">0.83</td>\n<td headers=\"recall\" class=\"gt_row gt_center\">0.83</td>\n<td headers=\"f1-score\" class=\"gt_row gt_center\">0.83</td>\n<td headers=\"support\" class=\"gt_row gt_center\">0.83</td></tr>\n    <tr><td headers=\"metrics\" class=\"gt_row gt_left\">macro avg</td>\n<td headers=\"precision\" class=\"gt_row gt_center\">0.69</td>\n<td headers=\"recall\" class=\"gt_row gt_center\">0.89</td>\n<td headers=\"f1-score\" class=\"gt_row gt_center\">0.72</td>\n<td headers=\"support\" class=\"gt_row gt_center\">47,017.</td></tr>\n    <tr><td headers=\"metrics\" class=\"gt_row gt_left\">weighted avg</td>\n<td headers=\"precision\" class=\"gt_row gt_center\">0.93</td>\n<td headers=\"recall\" class=\"gt_row gt_center\">0.83</td>\n<td headers=\"f1-score\" class=\"gt_row gt_center\">0.86</td>\n<td headers=\"support\" class=\"gt_row gt_center\">47,017.</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n\n# Models comparison\n\nLets check with a plot the performance of all the models. The AUC ROC makes it possible. It is a plot useful for classification tasks. It plots False vs True Positive Rate.\n\n\n\n::: {.cell}\n\n```{.python .cell-code}\nfrom sklearn.metrics import roc_curve, roc_auc_score\nimport matplotlib.pyplot as plt\n\nplt.figure(figsize=(20, 15))\n\nmodel_names = [\"dtc\", \"rfc\", \"xgb\"]\nmodels_ = [dtc_model, rfc_model, xgb_model]\nmodels = zip(model_names, models_)\n\nfor name, model in models:\n    fpr, tpr, _ = roc_curve(ytest, model.predict_proba(xtest)[:, 1])\n    auc_score = roc_auc_score(ytest, model.predict_proba(xtest)[:, 1])\n    plt.plot(fpr, tpr, label=f'{name} (AUC: {auc_score:.2f})')\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[<matplotlib.lines.Line2D object at 0x15ffd4bd0>]\n[<matplotlib.lines.Line2D object at 0x1488d0890>]\n[<matplotlib.lines.Line2D object at 0x15e104750>]\n```\n\n\n:::\n\n```{.python .cell-code}\nplt.xlabel(\"False Positive Rate\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nText(0.5, 0, 'False Positive Rate')\n```\n\n\n:::\n\n```{.python .cell-code}\nplt.ylabel(\"True Positive Rate\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nText(0, 0.5, 'True Positive Rate')\n```\n\n\n:::\n\n```{.python .cell-code}\nplt.title(\"ROC Curves Comparison\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nText(0.5, 1.0, 'ROC Curves Comparison')\n```\n\n\n:::\n\n```{.python .cell-code}\nplt.tight_layout()\nplt.legend(loc=\"lower right\", fontsize=12)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n<matplotlib.legend.Legend object at 0x14891a690>\n```\n\n\n:::\n\n```{.python .cell-code}\nplt.show()\n```\n\n::: {.cell-output-display}\n![](credit_score_files/figure-html/roc_data-1.png){width=1920}\n:::\n\n```{.python .cell-code}\nplt.close()\n```\n:::\n\n\n\nFrom the ROC AUC, the best model is the xgboost, because the **A**rea **U**nder the **C**urve is higher.\n\n# Explainability\n\nWhat if the model predict a low creditworthiness and the business wants to know why? **Shapley values** make this possible. It comes from cooperative game theory: for more details, check this [link](https://medium.com/the-modern-scientist/what-is-the-shapley-value-8ca624274d5a) and this [link](https://www.sciencedirect.com/science/article/abs/pii/S1574000502030163).\n\nFor our purpose, I have found 3 observations we can use. It is also useful to separate the preprocessor and classificator part of the pipeline.\n\n\n\n::: {.cell}\n\n```{.python .cell-code}\nmodel = xgb_model\npreprocessor = model.named_steps[\"preprocessor\"]\nclf = model.named_steps[\"xgb\"]\nidx = [15454, 1284, 30305]\n```\n:::\n\n::: {.cell}\n\n```{.python .cell-code}\n# retain features name\nxtrain_processed = preprocessor.transform(xtrain)\nxtrain_processed = pd.DataFrame(xtrain_processed, columns=config.features)\n# retain features name\nxtest_processed = preprocessor.transform(xtest)\nxtest_processed = pd.DataFrame(xtest_processed, columns=config.features)\n# retain features name\nclf.get_booster().feature_names = config.features\n# convert to DMatrix\ndtrain = DMatrix(xtrain_processed, label=ytrain)\ndtest = DMatrix(xtest_processed, label=ytest)\n# usefol idxs\nidx = [15454, 1284, 30305]\n\nx_processed = preprocessor.transform(x)\n```\n:::\n\n::: {.cell}\n\n```{.python .cell-code}\nfrom xgboost import plot_importance\n\n# importance plot\nplot_importance(\n    booster=clf.get_booster(),\n    grid=False,\n    importance_type=\"gain\",\n    title=\"Feature Importance by Gain\",\n    values_format=\"{v:.2f}\"\n)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n<Axes: title={'center': 'Feature Importance by Gain'}, xlabel='F score', ylabel='Features'>\n```\n\n\n:::\n\n```{.python .cell-code}\nplt.tight_layout()\nplt.show()\n```\n\n::: {.cell-output-display}\n![](credit_score_files/figure-html/unnamed-chunk-17-3.png){width=672}\n:::\n:::\n\n\n\nThe importance plot tells us the information gain each feature gives to the model prediction. The 3 most important features are also the most logical one:\n\n-   Total income amount.\n-   Number of childrens.\n-   Type of housing.\n\nImportance provides a **score** that indicates how useful useful each feature is in the construcition of the boosted decision trees. The more an attribute is used to make key decisions with decision trees, the higher its relative importance.\n\n\n\n::: {.cell}\n\n```{.python .cell-code}\n# force plot\nplt.figure(figsize=(10, 8))\nplot_force = shap.plots.force(\n    base_value=explainer.expected_value,\n    shap_values=shap_values[idx[0], :],\n    # features=None,\n    feature_names=config.features,\n    # out_names=None,\n    # link='identity', # \"logit\"\n    plot_cmap='RdBu',\n    matplotlib=True,\n    show=True\n)\nplt.savefig(\"plot_force.jpeg\", dpi=200)\n\n# calculate specific shap explainer for waterfall plot\nexplainer_ = shap.Explainer(model=xgb_clf)\nshap_values_ = explainer(x_processed)\nshap_values_.feature_names = config.features\n# waterfall plot\nshap.plots.waterfall(\n    shap_values_[0],\n    max_display=len(config.features)\n)\nplt.savefig(\"plot_waterfall.jpeg\", dpi=200)\n# bar plot\nshap.plots.bar(\n    shap_values_[0],\n    max_display=len(config.features)\n)\nplt.savefig(\"plot_bar.jpeg\", dpi=200)\n```\n:::\n\n\n\n![Force plot](kaggle/force_plot.png){fig-align=\"center\"}\n\nThe force plot explains the contribution of features to a specific model prediction.\n\n-   **Base value** is the model expected output or **mean prediction** over the dataset. It is the prediction the model would make without any specific input features. It is the starting point of the plot.\n\n-   **Feature Contributions**. The SHAP values represent how much each feature contributes to the difference between the vase value and the final prediction for a specific observation.\n\n-   **Positive contributions**. Features pushing the prediction higher. Shown in red.\n\n-   **Negative contributions**. Features pulling the prediction lower. Shown in blue. The magnitude of each bar indicates the size of the feature's contribution.\n\n-   **Final Prediction**. Endpoint of the plot. It is the sum of the base value and all the SHAP values for that observation.\n\n![Waterfall plot](kaggle/waterfall_plot.png){fig-align=\"center\"}\n\nWaterfall plots displays explanations for individual predictions. The bottom of a waterfall plot starts as the expected value of the model output, and then each row shows how the positive (red) or negative (blue) contribution of each feature moves the value from the expected model output over the background dataset to the model output for this prediction.\n\n::: {.callout-important}\nDue to venv incompatibilities between shap and other packages, the shap evaluation has been made on Kaggle. The plots are the results of the notebook.\n:::\n",
    "supporting": [
      "credit_score_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../site_libs/htmltools-fill-0.5.8.1/fill.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/htmlwidgets-1.6.4/htmlwidgets.js\"></script>\n<script src=\"../../site_libs/plotly-binding-4.10.4/plotly.js\"></script>\n<script src=\"../../site_libs/typedarray-0.1/typedarray.min.js\"></script>\n<script src=\"../../site_libs/jquery-3.5.1/jquery.min.js\"></script>\n<link href=\"../../site_libs/crosstalk-1.2.1/css/crosstalk.min.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/crosstalk-1.2.1/js/crosstalk.min.js\"></script>\n<link href=\"../../site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/plotly-main-2.11.1/plotly-latest.min.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}