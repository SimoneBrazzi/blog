{
  "hash": "c36c767e699cf67f3188cad2854b4333",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Spam Detection\"\n# image: \"toxic_comment.jpg\"\ndescription: \"BiLSTM model for multi label classification\"\nauthor: \"Simone Brazzi\"\ndate: \"2024-09-05\"\ndraft: true\ncategories:\n  - code\n  - NLP\n  - Natural Language, Processing\n  - Python, R\nother-links:\n  - icon: file-code\n    text: Kaggle\n    href: https://www.kaggle.com/code/simonebrazzi/toxic-comment-filter-bilstm\ntoc: true\ntoc-title: \"Table of Contents\"\ntoc-depth: 3\nnumber-sections: true\nnumber-depth: 3\nembed-resources: true\nanchor-sections: true\nsmooth-scroll: true\nhighlight-style: monokai\ncode-line-numbers: true\ncode-copy: true\ncode-link: true\neditor_options: \n  chunk_output_type: console\n---\n\n\n\n# Introduction\n\n\n# Import\n\n## R libraries\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse, verbose = FALSE)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   3.5.1     ✔ tibble    3.2.1\n✔ lubridate 1.9.3     ✔ tidyr     1.3.1\n✔ purrr     1.0.2     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(ggplot2)\nlibrary(gt)\nlibrary(reticulate)\nlibrary(plotly)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAttaching package: 'plotly'\n\nThe following object is masked from 'package:ggplot2':\n\n    last_plot\n\nThe following object is masked from 'package:stats':\n\n    filter\n\nThe following object is masked from 'package:graphics':\n\n    layout\n```\n\n\n:::\n\n```{.r .cell-code}\n# renv::use_python(\"/Users/simonebrazzi/venv/nlp/bin/python3\")\n```\n:::\n\n\n\n## Python packages\n\n\n\n::: {.cell}\n\n```{.python .cell-code}\nimport pandas as pd\nimport numpy as np\nimport spacy\nimport nltk\nimport string\nimport gensim\nimport gensim.corpora as corpora\nimport gensim.downloader\n\nfrom nltk.corpus import stopwords\nfrom gensim.models import Word2Vec\nfrom scipy.spatial.distance import cosine\nfrom sklearn.metrics.pairwise import cosine_similarity\nfrom sklearn.feature_extraction.text import TfidfVectorizer\n\nnltk.download('stopwords')\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nTrue\n```\n\n\n:::\n\n```{.python .cell-code}\nglove_vector = gensim.downloader.load(\"glove-wiki-gigaword-300\")\n```\n:::\n\n\n\n# Dataset\n\n\n\n::: {.cell}\n\n```{.python .cell-code}\nfile = \"~/R/blog/posts/toxic_comment_filter/spam_dataset.csv\"\ndf = pd.read_csv(file, index_col=0)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(reticulate)\ndf <- py$df\n```\n:::\n\n\n\n## EDA\n\n\n\n::: {#tbl-eda .cell tbl-cap='Absolute and relative frequencies'}\n\n```{.r .cell-code}\ndf_g <- df %>% \n  summarise(\n    freq_abs = n(),\n    freq_rel = n() / nrow(df),\n    .by = label\n  )\n\ndf_g %>% \n  gt() %>% \n  fmt_auto() %>% \n  cols_width(\n    label ~ pct(20),\n    freq_abs ~ pct(35),\n    freq_rel ~ pct(35)\n    ) %>% \n  cols_align(\n    align = \"center\",\n    columns = c(freq_abs, freq_rel)\n  ) %>% \n  tab_header(\n    title = \"Label frequency\",\n    subtitle = \"Absolute and relative frequencies\"\n  ) %>% \n  cols_label(\n    label = \"Label\",\n    freq_abs = \"Absolute frequency\",\n    freq_rel = \"Relative frequency\"\n  ) %>% \n  tab_options(\n    table.width = pct(100)\n  )\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"hzyeysdziy\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#hzyeysdziy table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#hzyeysdziy thead, #hzyeysdziy tbody, #hzyeysdziy tfoot, #hzyeysdziy tr, #hzyeysdziy td, #hzyeysdziy th {\n  border-style: none;\n}\n\n#hzyeysdziy p {\n  margin: 0;\n  padding: 0;\n}\n\n#hzyeysdziy .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: 100%;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#hzyeysdziy .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#hzyeysdziy .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#hzyeysdziy .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#hzyeysdziy .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#hzyeysdziy .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#hzyeysdziy .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#hzyeysdziy .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#hzyeysdziy .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#hzyeysdziy .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#hzyeysdziy .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#hzyeysdziy .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#hzyeysdziy .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#hzyeysdziy .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#hzyeysdziy .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#hzyeysdziy .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#hzyeysdziy .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#hzyeysdziy .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#hzyeysdziy .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#hzyeysdziy .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#hzyeysdziy .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#hzyeysdziy .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#hzyeysdziy .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#hzyeysdziy .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#hzyeysdziy .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#hzyeysdziy .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#hzyeysdziy .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#hzyeysdziy .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#hzyeysdziy .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#hzyeysdziy .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#hzyeysdziy .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#hzyeysdziy .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#hzyeysdziy .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#hzyeysdziy .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#hzyeysdziy .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#hzyeysdziy .gt_left {\n  text-align: left;\n}\n\n#hzyeysdziy .gt_center {\n  text-align: center;\n}\n\n#hzyeysdziy .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#hzyeysdziy .gt_font_normal {\n  font-weight: normal;\n}\n\n#hzyeysdziy .gt_font_bold {\n  font-weight: bold;\n}\n\n#hzyeysdziy .gt_font_italic {\n  font-style: italic;\n}\n\n#hzyeysdziy .gt_super {\n  font-size: 65%;\n}\n\n#hzyeysdziy .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#hzyeysdziy .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#hzyeysdziy .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#hzyeysdziy .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#hzyeysdziy .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#hzyeysdziy .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#hzyeysdziy .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#hzyeysdziy .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#hzyeysdziy div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" style=\"table-layout: fixed;; width: 100%\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <colgroup>\n    <col style=\"width:20%;\"/>\n    <col style=\"width:35%;\"/>\n    <col style=\"width:35%;\"/>\n  </colgroup>\n  <thead>\n    <tr class=\"gt_heading\">\n      <td colspan=\"3\" class=\"gt_heading gt_title gt_font_normal\" style>Label frequency</td>\n    </tr>\n    <tr class=\"gt_heading\">\n      <td colspan=\"3\" class=\"gt_heading gt_subtitle gt_font_normal gt_bottom_border\" style>Absolute and relative frequencies</td>\n    </tr>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Label\">Label</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Absolute frequency\">Absolute frequency</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Relative frequency\">Relative frequency</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">ham</td>\n<td headers=\"freq_abs\" class=\"gt_row gt_center\">3,672 </td>\n<td headers=\"freq_rel\" class=\"gt_row gt_center\">0.71</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">spam</td>\n<td headers=\"freq_abs\" class=\"gt_row gt_center\">1,499 </td>\n<td headers=\"freq_rel\" class=\"gt_row gt_center\">0.29</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ng <- ggplot(df_g) +\n  geom_col(aes(x = freq_abs, y = label, fill = label)) +\n  scale_fill_brewer(palette = \"Set1\") +\n  theme_minimal() +\n  ggtitle(\"Absolute frequency barchart\") +\n  xlab(\"Absolute frequency\") +\n  ylab(\"Label\") +\n  labs(fill = \"Label\")\nggplotly(g)\n```\n\n::: {#fig-barchart .cell-output-display}\n\n```{=html}\n<div class=\"plotly html-widget html-fill-item\" id=\"htmlwidget-eaa7331dd47c148fcfdb\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-eaa7331dd47c148fcfdb\">{\"x\":{\"data\":[{\"orientation\":\"v\",\"width\":3672,\"base\":0.55000000000000004,\"x\":[1836],\"y\":[0.89999999999999991],\"text\":\"freq_abs: 3672<br />label: ham<br />label: ham\",\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(228,26,28,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"ham\",\"legendgroup\":\"ham\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"v\",\"width\":1499,\"base\":1.55,\"x\":[749.5],\"y\":[0.90000000000000013],\"text\":\"freq_abs: 1499<br />label: spam<br />label: spam\",\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(55,126,184,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"spam\",\"legendgroup\":\"spam\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null}],\"layout\":{\"margin\":{\"t\":43.762557077625573,\"r\":7.3059360730593621,\"b\":40.182648401826498,\"l\":48.949771689497723},\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724},\"title\":{\"text\":\"Absolute frequency barchart\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":17.534246575342465},\"x\":0,\"xref\":\"paper\"},\"xaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[-183.60000000000002,3855.5999999999999],\"tickmode\":\"array\",\"ticktext\":[\"0\",\"1000\",\"2000\",\"3000\"],\"tickvals\":[0,999.99999999999989,2000,3000],\"categoryorder\":\"array\",\"categoryarray\":[\"0\",\"1000\",\"2000\",\"3000\"],\"nticks\":null,\"ticks\":\"\",\"tickcolor\":null,\"ticklen\":3.6529680365296811,\"tickwidth\":0,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.68949771689498},\"tickangle\":-0,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":true,\"gridcolor\":\"rgba(235,235,235,1)\",\"gridwidth\":0.66417600664176002,\"zeroline\":false,\"anchor\":\"y\",\"title\":{\"text\":\"Absolute frequency\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}},\"hoverformat\":\".2f\"},\"yaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[0.40000000000000002,2.6000000000000001],\"tickmode\":\"array\",\"ticktext\":[\"ham\",\"spam\"],\"tickvals\":[1,2],\"categoryorder\":\"array\",\"categoryarray\":[\"ham\",\"spam\"],\"nticks\":null,\"ticks\":\"\",\"tickcolor\":null,\"ticklen\":3.6529680365296811,\"tickwidth\":0,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.68949771689498},\"tickangle\":-0,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":true,\"gridcolor\":\"rgba(235,235,235,1)\",\"gridwidth\":0.66417600664176002,\"zeroline\":false,\"anchor\":\"x\",\"title\":{\"text\":\"Label\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}},\"hoverformat\":\".2f\"},\"shapes\":[{\"type\":\"rect\",\"fillcolor\":null,\"line\":{\"color\":null,\"width\":0,\"linetype\":[]},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0,\"x1\":1,\"y0\":0,\"y1\":1}],\"showlegend\":true,\"legend\":{\"bgcolor\":null,\"bordercolor\":null,\"borderwidth\":0,\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":11.68949771689498},\"title\":{\"text\":\"Label\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}}},\"hovermode\":\"closest\",\"barmode\":\"relative\"},\"config\":{\"doubleClick\":\"reset\",\"modeBarButtonsToAdd\":[\"hoverclosest\",\"hovercompare\"],\"showSendToCloud\":false},\"source\":\"A\",\"attrs\":{\"f972336bca32\":{\"x\":{},\"y\":{},\"fill\":{},\"type\":\"bar\"}},\"cur_data\":\"f972336bca32\",\"visdat\":{\"f972336bca32\":[\"function (y) \",\"x\"]},\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.20000000000000001,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n\nAbsolute frequency barchart\n:::\n:::\n\n\n\n# Preprocessing\n\nPreprocessing is the sum of the following steps:\n\n1.  lowercasing\n2.  punctuation removal\n3.  lemmatization\n4.  tokenization\n5.  stopwords removal\n\n`nlp.pipe` return a generator that yields `Doc` objects, not a list. To use it as a list, it has to be defined as such.\n\nTo speed up the process, is it possible to enable the multi process method in `nlp.pipe`.\n\n\n\n::: {.cell}\n\n```{.python .cell-code}\nstop_words = stopwords.words('english')\nnlp = spacy.load(\"en_core_web_lg\")\n\ndoc = list(nlp.pipe(df.text))\n```\n:::\n\n\n\nNormalization:\n1. remove punctuation.\n2. remove stop words.\n3. remove spaces.\n4. remove \"subject\" token.\n5. lemmatization.\n\n\n\n\n::: {.cell}\n\n```{.python .cell-code}\nlemmas = []\nfor d in doc:\n  lemma = []\n  for t in d:\n    if t.text.lower() not in list(string.punctuation) and t.text.lower() not in stop_words and not t.is_space and t.text.lower() != \"subject\" and not t.is_digit:\n      lemma.append(t.lemma_)\n  lemmas.append(lemma)\n\ndf[\"lemmas\"] = lemmas\n```\n:::\n\n\n\n# Tasks\n\n## Classification\n\n## Topic Modeling for spam content\n\nFilter data to have a spam dataframe.\n\n\n\n::: {.cell}\n\n```{.python .cell-code}\nspam = df[df.label == \"spam\"]\nx = spam.lemmas\n```\n:::\n\n\n\nLDA algortihm needs the corpus as a bag of word.\n\n### Create corpus\n\n\n\n::: {.cell}\n\n```{.python .cell-code}\nid2word = corpora.Dictionary(x)\ncorpus = [id2word.doc2bow(t) for t in x]\n```\n:::\n\n\n\n### Model\n\n\n\n::: {.cell}\n\n```{.python .cell-code}\nlda = gensim.models.LdaMulticore(\n  corpus=corpus,\n  id2word=id2word,\n  num_topics=10,\n  passes=10,\n  workers=4,\n  random_state=42\n)\n\ntopic_words = lda.show_topics(num_topics=10, num_words=5, formatted=False)\nfor t in topic_words:\n    print(t)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n(0, [('account', 0.0064580254), ('money', 0.0035484994), ('email', 0.0034710336), ('we', 0.0032387595), ('please', 0.0028978677)])\n(1, [('prescription', 0.0059115607), ('http', 0.0055376636), ('online', 0.005092709), ('get', 0.0046261013), ('we', 0.004042321)])\n(2, [('n', 0.0038072998), ('e', 0.0036426291), ('good', 0.0033766069), ('x', 0.0032139888), ('get', 0.0031532536)])\n(3, [('company', 0.017202605), ('statement', 0.010310886), ('stock', 0.008724627), ('information', 0.007206546), ('security', 0.0067339707)])\n(4, [('nbsp', 0.021221172), ('cd', 0.0061812373), ('com', 0.006156155), ('email', 0.0054835062), ('http', 0.0053489404)])\n(5, [('com', 0.0138760945), ('pill', 0.0121528255), ('www', 0.008677117), ('computron', 0.008643858), ('e', 0.008001097)])\n(6, [('price', 0.012181944), ('adobe', 0.009376173), ('software', 0.008568934), ('window', 0.007905039), ('xp', 0.0071603805)])\n(7, [('font', 0.023346337), ('td', 0.023305453), ('http', 0.020620745), ('height', 0.017131135), ('width', 0.01454579)])\n(8, [('number', 0.004187645), ('claim', 0.0039146026), ('com', 0.0038865183), ('one', 0.0036455083), ('http', 0.0033131833)])\n(9, [('http', 0.0048540784), ('com', 0.0043370966), ('p', 0.0039948197), ('www', 0.00274131), ('html', 0.002629283)])\n```\n\n\n:::\n:::\n\n\n\n### 5 words for each of the 10 topics\n\n\n::: {.cell}\n\n```{.python .cell-code}\ntopics_dict = {}\nfor topic, word in topic_words:\n    topics_dict[topic] = [w[0] for w in word]\n\ntopics_df = pd.DataFrame(topics_dict)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\npy$topics_df %>% \n  gt()\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"khtuupprta\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#khtuupprta table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#khtuupprta thead, #khtuupprta tbody, #khtuupprta tfoot, #khtuupprta tr, #khtuupprta td, #khtuupprta th {\n  border-style: none;\n}\n\n#khtuupprta p {\n  margin: 0;\n  padding: 0;\n}\n\n#khtuupprta .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#khtuupprta .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#khtuupprta .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#khtuupprta .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#khtuupprta .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#khtuupprta .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#khtuupprta .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#khtuupprta .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#khtuupprta .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#khtuupprta .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#khtuupprta .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#khtuupprta .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#khtuupprta .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#khtuupprta .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#khtuupprta .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#khtuupprta .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#khtuupprta .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#khtuupprta .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#khtuupprta .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#khtuupprta .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#khtuupprta .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#khtuupprta .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#khtuupprta .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#khtuupprta .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#khtuupprta .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#khtuupprta .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#khtuupprta .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#khtuupprta .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#khtuupprta .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#khtuupprta .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#khtuupprta .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#khtuupprta .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#khtuupprta .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#khtuupprta .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#khtuupprta .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#khtuupprta .gt_left {\n  text-align: left;\n}\n\n#khtuupprta .gt_center {\n  text-align: center;\n}\n\n#khtuupprta .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#khtuupprta .gt_font_normal {\n  font-weight: normal;\n}\n\n#khtuupprta .gt_font_bold {\n  font-weight: bold;\n}\n\n#khtuupprta .gt_font_italic {\n  font-style: italic;\n}\n\n#khtuupprta .gt_super {\n  font-size: 65%;\n}\n\n#khtuupprta .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#khtuupprta .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#khtuupprta .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#khtuupprta .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#khtuupprta .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#khtuupprta .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#khtuupprta .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#khtuupprta .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#khtuupprta div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"0\">0</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"1\">1</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"2\">2</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"3\">3</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"4\">4</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"5\">5</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"6\">6</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"7\">7</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"8\">8</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"9\">9</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"0\" class=\"gt_row gt_left\">account</td>\n<td headers=\"1\" class=\"gt_row gt_left\">prescription</td>\n<td headers=\"2\" class=\"gt_row gt_left\">n</td>\n<td headers=\"3\" class=\"gt_row gt_left\">company</td>\n<td headers=\"4\" class=\"gt_row gt_left\">nbsp</td>\n<td headers=\"5\" class=\"gt_row gt_left\">com</td>\n<td headers=\"6\" class=\"gt_row gt_left\">price</td>\n<td headers=\"7\" class=\"gt_row gt_left\">font</td>\n<td headers=\"8\" class=\"gt_row gt_left\">number</td>\n<td headers=\"9\" class=\"gt_row gt_left\">http</td></tr>\n    <tr><td headers=\"0\" class=\"gt_row gt_left\">money</td>\n<td headers=\"1\" class=\"gt_row gt_left\">http</td>\n<td headers=\"2\" class=\"gt_row gt_left\">e</td>\n<td headers=\"3\" class=\"gt_row gt_left\">statement</td>\n<td headers=\"4\" class=\"gt_row gt_left\">cd</td>\n<td headers=\"5\" class=\"gt_row gt_left\">pill</td>\n<td headers=\"6\" class=\"gt_row gt_left\">adobe</td>\n<td headers=\"7\" class=\"gt_row gt_left\">td</td>\n<td headers=\"8\" class=\"gt_row gt_left\">claim</td>\n<td headers=\"9\" class=\"gt_row gt_left\">com</td></tr>\n    <tr><td headers=\"0\" class=\"gt_row gt_left\">email</td>\n<td headers=\"1\" class=\"gt_row gt_left\">online</td>\n<td headers=\"2\" class=\"gt_row gt_left\">good</td>\n<td headers=\"3\" class=\"gt_row gt_left\">stock</td>\n<td headers=\"4\" class=\"gt_row gt_left\">com</td>\n<td headers=\"5\" class=\"gt_row gt_left\">www</td>\n<td headers=\"6\" class=\"gt_row gt_left\">software</td>\n<td headers=\"7\" class=\"gt_row gt_left\">http</td>\n<td headers=\"8\" class=\"gt_row gt_left\">com</td>\n<td headers=\"9\" class=\"gt_row gt_left\">p</td></tr>\n    <tr><td headers=\"0\" class=\"gt_row gt_left\">we</td>\n<td headers=\"1\" class=\"gt_row gt_left\">get</td>\n<td headers=\"2\" class=\"gt_row gt_left\">x</td>\n<td headers=\"3\" class=\"gt_row gt_left\">information</td>\n<td headers=\"4\" class=\"gt_row gt_left\">email</td>\n<td headers=\"5\" class=\"gt_row gt_left\">computron</td>\n<td headers=\"6\" class=\"gt_row gt_left\">window</td>\n<td headers=\"7\" class=\"gt_row gt_left\">height</td>\n<td headers=\"8\" class=\"gt_row gt_left\">one</td>\n<td headers=\"9\" class=\"gt_row gt_left\">www</td></tr>\n    <tr><td headers=\"0\" class=\"gt_row gt_left\">please</td>\n<td headers=\"1\" class=\"gt_row gt_left\">we</td>\n<td headers=\"2\" class=\"gt_row gt_left\">get</td>\n<td headers=\"3\" class=\"gt_row gt_left\">security</td>\n<td headers=\"4\" class=\"gt_row gt_left\">http</td>\n<td headers=\"5\" class=\"gt_row gt_left\">e</td>\n<td headers=\"6\" class=\"gt_row gt_left\">xp</td>\n<td headers=\"7\" class=\"gt_row gt_left\">width</td>\n<td headers=\"8\" class=\"gt_row gt_left\">http</td>\n<td headers=\"9\" class=\"gt_row gt_left\">html</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n\n## Semantic distance between topics\n\n\n\n::: {.cell}\n\n```{.python .cell-code}\ndocuments = [\" \".join(words) for words in topics_dict.values()]\n\nvectorizer = TfidfVectorizer()\ntfidf_matrix = vectorizer.fit_transform(documents)\ncosine_sim_matrix = cosine_similarity(tfidf_matrix, dense_output=True)\ntopics = list(topics_dict.keys())\ncosine_sim_df = pd.DataFrame(cosine_sim_matrix, index=topics, columns=topics)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\npy$cosine_sim_df %>% \n  gt()\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"hyxxexbagq\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#hyxxexbagq table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#hyxxexbagq thead, #hyxxexbagq tbody, #hyxxexbagq tfoot, #hyxxexbagq tr, #hyxxexbagq td, #hyxxexbagq th {\n  border-style: none;\n}\n\n#hyxxexbagq p {\n  margin: 0;\n  padding: 0;\n}\n\n#hyxxexbagq .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#hyxxexbagq .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#hyxxexbagq .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#hyxxexbagq .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#hyxxexbagq .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#hyxxexbagq .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#hyxxexbagq .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#hyxxexbagq .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#hyxxexbagq .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#hyxxexbagq .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#hyxxexbagq .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#hyxxexbagq .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#hyxxexbagq .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#hyxxexbagq .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#hyxxexbagq .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#hyxxexbagq .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#hyxxexbagq .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#hyxxexbagq .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#hyxxexbagq .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#hyxxexbagq .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#hyxxexbagq .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#hyxxexbagq .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#hyxxexbagq .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#hyxxexbagq .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#hyxxexbagq .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#hyxxexbagq .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#hyxxexbagq .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#hyxxexbagq .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#hyxxexbagq .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#hyxxexbagq .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#hyxxexbagq .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#hyxxexbagq .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#hyxxexbagq .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#hyxxexbagq .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#hyxxexbagq .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#hyxxexbagq .gt_left {\n  text-align: left;\n}\n\n#hyxxexbagq .gt_center {\n  text-align: center;\n}\n\n#hyxxexbagq .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#hyxxexbagq .gt_font_normal {\n  font-weight: normal;\n}\n\n#hyxxexbagq .gt_font_bold {\n  font-weight: bold;\n}\n\n#hyxxexbagq .gt_font_italic {\n  font-style: italic;\n}\n\n#hyxxexbagq .gt_super {\n  font-size: 65%;\n}\n\n#hyxxexbagq .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#hyxxexbagq .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#hyxxexbagq .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#hyxxexbagq .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#hyxxexbagq .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#hyxxexbagq .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#hyxxexbagq .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#hyxxexbagq .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#hyxxexbagq div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"0\">0</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"1\">1</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"2\">2</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"3\">3</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"4\">4</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"5\">5</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"6\">6</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"7\">7</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"8\">8</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"9\">9</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"0\" class=\"gt_row gt_right\">1.0000000</td>\n<td headers=\"1\" class=\"gt_row gt_right\">0.17587595</td>\n<td headers=\"2\" class=\"gt_row gt_right\">0.0000000</td>\n<td headers=\"3\" class=\"gt_row gt_right\">0</td>\n<td headers=\"4\" class=\"gt_row gt_right\">0.18288238</td>\n<td headers=\"5\" class=\"gt_row gt_right\">0.0000000</td>\n<td headers=\"6\" class=\"gt_row gt_right\">0</td>\n<td headers=\"7\" class=\"gt_row gt_right\">0.00000000</td>\n<td headers=\"8\" class=\"gt_row gt_right\">0.00000000</td>\n<td headers=\"9\" class=\"gt_row gt_right\">0.0000000</td></tr>\n    <tr><td headers=\"0\" class=\"gt_row gt_right\">0.1758759</td>\n<td headers=\"1\" class=\"gt_row gt_right\">1.00000000</td>\n<td headers=\"2\" class=\"gt_row gt_right\">0.2825259</td>\n<td headers=\"3\" class=\"gt_row gt_right\">0</td>\n<td headers=\"4\" class=\"gt_row gt_right\">0.09654480</td>\n<td headers=\"5\" class=\"gt_row gt_right\">0.0000000</td>\n<td headers=\"6\" class=\"gt_row gt_right\">0</td>\n<td headers=\"7\" class=\"gt_row gt_right\">0.08672846</td>\n<td headers=\"8\" class=\"gt_row gt_right\">0.09294507</td>\n<td headers=\"9\" class=\"gt_row gt_right\">0.1141521</td></tr>\n    <tr><td headers=\"0\" class=\"gt_row gt_right\">0.0000000</td>\n<td headers=\"1\" class=\"gt_row gt_right\">0.28252593</td>\n<td headers=\"2\" class=\"gt_row gt_right\">1.0000000</td>\n<td headers=\"3\" class=\"gt_row gt_right\">0</td>\n<td headers=\"4\" class=\"gt_row gt_right\">0.00000000</td>\n<td headers=\"5\" class=\"gt_row gt_right\">0.0000000</td>\n<td headers=\"6\" class=\"gt_row gt_right\">0</td>\n<td headers=\"7\" class=\"gt_row gt_right\">0.00000000</td>\n<td headers=\"8\" class=\"gt_row gt_right\">0.00000000</td>\n<td headers=\"9\" class=\"gt_row gt_right\">0.0000000</td></tr>\n    <tr><td headers=\"0\" class=\"gt_row gt_right\">0.0000000</td>\n<td headers=\"1\" class=\"gt_row gt_right\">0.00000000</td>\n<td headers=\"2\" class=\"gt_row gt_right\">0.0000000</td>\n<td headers=\"3\" class=\"gt_row gt_right\">1</td>\n<td headers=\"4\" class=\"gt_row gt_right\">0.00000000</td>\n<td headers=\"5\" class=\"gt_row gt_right\">0.0000000</td>\n<td headers=\"6\" class=\"gt_row gt_right\">0</td>\n<td headers=\"7\" class=\"gt_row gt_right\">0.00000000</td>\n<td headers=\"8\" class=\"gt_row gt_right\">0.00000000</td>\n<td headers=\"9\" class=\"gt_row gt_right\">0.0000000</td></tr>\n    <tr><td headers=\"0\" class=\"gt_row gt_right\">0.1828824</td>\n<td headers=\"1\" class=\"gt_row gt_right\">0.09654480</td>\n<td headers=\"2\" class=\"gt_row gt_right\">0.0000000</td>\n<td headers=\"3\" class=\"gt_row gt_right\">0</td>\n<td headers=\"4\" class=\"gt_row gt_right\">1.00000000</td>\n<td headers=\"5\" class=\"gt_row gt_right\">0.1312381</td>\n<td headers=\"6\" class=\"gt_row gt_right\">0</td>\n<td headers=\"7\" class=\"gt_row gt_right\">0.09018349</td>\n<td headers=\"8\" class=\"gt_row gt_right\">0.21648296</td>\n<td headers=\"9\" class=\"gt_row gt_right\">0.2658773</td></tr>\n    <tr><td headers=\"0\" class=\"gt_row gt_right\">0.0000000</td>\n<td headers=\"1\" class=\"gt_row gt_right\">0.00000000</td>\n<td headers=\"2\" class=\"gt_row gt_right\">0.0000000</td>\n<td headers=\"3\" class=\"gt_row gt_right\">0</td>\n<td headers=\"4\" class=\"gt_row gt_right\">0.13123813</td>\n<td headers=\"5\" class=\"gt_row gt_right\">1.0000000</td>\n<td headers=\"6\" class=\"gt_row gt_right\">0</td>\n<td headers=\"7\" class=\"gt_row gt_right\">0.00000000</td>\n<td headers=\"8\" class=\"gt_row gt_right\">0.12634484</td>\n<td headers=\"9\" class=\"gt_row gt_right\">0.4116463</td></tr>\n    <tr><td headers=\"0\" class=\"gt_row gt_right\">0.0000000</td>\n<td headers=\"1\" class=\"gt_row gt_right\">0.00000000</td>\n<td headers=\"2\" class=\"gt_row gt_right\">0.0000000</td>\n<td headers=\"3\" class=\"gt_row gt_right\">0</td>\n<td headers=\"4\" class=\"gt_row gt_right\">0.00000000</td>\n<td headers=\"5\" class=\"gt_row gt_right\">0.0000000</td>\n<td headers=\"6\" class=\"gt_row gt_right\">1</td>\n<td headers=\"7\" class=\"gt_row gt_right\">0.00000000</td>\n<td headers=\"8\" class=\"gt_row gt_right\">0.00000000</td>\n<td headers=\"9\" class=\"gt_row gt_right\">0.0000000</td></tr>\n    <tr><td headers=\"0\" class=\"gt_row gt_right\">0.0000000</td>\n<td headers=\"1\" class=\"gt_row gt_right\">0.08672846</td>\n<td headers=\"2\" class=\"gt_row gt_right\">0.0000000</td>\n<td headers=\"3\" class=\"gt_row gt_right\">0</td>\n<td headers=\"4\" class=\"gt_row gt_right\">0.09018349</td>\n<td headers=\"5\" class=\"gt_row gt_right\">0.0000000</td>\n<td headers=\"6\" class=\"gt_row gt_right\">0</td>\n<td headers=\"7\" class=\"gt_row gt_right\">1.00000000</td>\n<td headers=\"8\" class=\"gt_row gt_right\">0.08682095</td>\n<td headers=\"9\" class=\"gt_row gt_right\">0.1066307</td></tr>\n    <tr><td headers=\"0\" class=\"gt_row gt_right\">0.0000000</td>\n<td headers=\"1\" class=\"gt_row gt_right\">0.09294507</td>\n<td headers=\"2\" class=\"gt_row gt_right\">0.0000000</td>\n<td headers=\"3\" class=\"gt_row gt_right\">0</td>\n<td headers=\"4\" class=\"gt_row gt_right\">0.21648296</td>\n<td headers=\"5\" class=\"gt_row gt_right\">0.1263448</td>\n<td headers=\"6\" class=\"gt_row gt_right\">0</td>\n<td headers=\"7\" class=\"gt_row gt_right\">0.08682095</td>\n<td headers=\"8\" class=\"gt_row gt_right\">1.00000000</td>\n<td headers=\"9\" class=\"gt_row gt_right\">0.2559639</td></tr>\n    <tr><td headers=\"0\" class=\"gt_row gt_right\">0.0000000</td>\n<td headers=\"1\" class=\"gt_row gt_right\">0.11415212</td>\n<td headers=\"2\" class=\"gt_row gt_right\">0.0000000</td>\n<td headers=\"3\" class=\"gt_row gt_right\">0</td>\n<td headers=\"4\" class=\"gt_row gt_right\">0.26587734</td>\n<td headers=\"5\" class=\"gt_row gt_right\">0.4116463</td>\n<td headers=\"6\" class=\"gt_row gt_right\">0</td>\n<td headers=\"7\" class=\"gt_row gt_right\">0.10663067</td>\n<td headers=\"8\" class=\"gt_row gt_right\">0.25596394</td>\n<td headers=\"9\" class=\"gt_row gt_right\">1.0000000</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n\n## Organization of \"HAM\" mails\n\n### Create \"HAM\" df\n\n### Get ham lemmas which have ORG entity\n\n\n::: {.cell}\n\n```{.python .cell-code}\nent = [[t.lemma_ for t in d if not t.is_punct and t.text.lower() != \"subject\" and not t.is_stop and not t.is_space and len(t.text) >= 5 and str(t.ent_type_) == \"ORG\"] for d in doc]\n\ndf[\"ent\"] = ent\nham = df[df.label == \"ham\"]\nx = ham.ent\n```\n:::\n\n::: {.cell}\n\n```{.python .cell-code}\nfrom collections import Counter\n\n# Flatten the list of lists and create a Counter object\nd = Counter([i for e in x for i in e])\n\nfreq_df = pd.DataFrame(d.items(), columns=[\"word\", \"freq\"])\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(\"wordcloud\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nLoading required package: RColorBrewer\n```\n\n\n:::\n\n```{.r .cell-code}\nset.seed(1234)\nword_freqs_df <- py$freq_df\nwordcloud(words = word_freqs_df$word, freq = word_freqs_df$freq, \n          min.freq = 1, max.words = 100, random.order = FALSE, \n          rot.per = 0.35, colors = brewer.pal(8, \"Dark2\"))\n```\n\n::: {.cell-output-display}\n![](spam_detection_files/figure-html/unnamed-chunk-18-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nword_freqs_df %>% \n  arrange(desc(freq)) %>% \n  head(10) %>% \n  gt()\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"vedzdkckmo\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#vedzdkckmo table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#vedzdkckmo thead, #vedzdkckmo tbody, #vedzdkckmo tfoot, #vedzdkckmo tr, #vedzdkckmo td, #vedzdkckmo th {\n  border-style: none;\n}\n\n#vedzdkckmo p {\n  margin: 0;\n  padding: 0;\n}\n\n#vedzdkckmo .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#vedzdkckmo .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#vedzdkckmo .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#vedzdkckmo .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#vedzdkckmo .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#vedzdkckmo .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#vedzdkckmo .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#vedzdkckmo .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#vedzdkckmo .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#vedzdkckmo .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#vedzdkckmo .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#vedzdkckmo .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#vedzdkckmo .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#vedzdkckmo .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#vedzdkckmo .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#vedzdkckmo .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#vedzdkckmo .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#vedzdkckmo .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#vedzdkckmo .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#vedzdkckmo .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#vedzdkckmo .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#vedzdkckmo .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#vedzdkckmo .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#vedzdkckmo .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#vedzdkckmo .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#vedzdkckmo .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#vedzdkckmo .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#vedzdkckmo .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#vedzdkckmo .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#vedzdkckmo .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#vedzdkckmo .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#vedzdkckmo .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#vedzdkckmo .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#vedzdkckmo .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#vedzdkckmo .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#vedzdkckmo .gt_left {\n  text-align: left;\n}\n\n#vedzdkckmo .gt_center {\n  text-align: center;\n}\n\n#vedzdkckmo .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#vedzdkckmo .gt_font_normal {\n  font-weight: normal;\n}\n\n#vedzdkckmo .gt_font_bold {\n  font-weight: bold;\n}\n\n#vedzdkckmo .gt_font_italic {\n  font-style: italic;\n}\n\n#vedzdkckmo .gt_super {\n  font-size: 65%;\n}\n\n#vedzdkckmo .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#vedzdkckmo .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#vedzdkckmo .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#vedzdkckmo .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#vedzdkckmo .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#vedzdkckmo .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#vedzdkckmo .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#vedzdkckmo .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#vedzdkckmo div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"word\">word</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"freq\">freq</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"word\" class=\"gt_row gt_left\">enron</td>\n<td headers=\"freq\" class=\"gt_row gt_right\">3268</td></tr>\n    <tr><td headers=\"word\" class=\"gt_row gt_left\">daren</td>\n<td headers=\"freq\" class=\"gt_row gt_right\">1047</td></tr>\n    <tr><td headers=\"word\" class=\"gt_row gt_left\">farmer</td>\n<td headers=\"freq\" class=\"gt_row gt_right\">472</td></tr>\n    <tr><td headers=\"word\" class=\"gt_row gt_left\">north</td>\n<td headers=\"freq\" class=\"gt_row gt_right\">270</td></tr>\n    <tr><td headers=\"word\" class=\"gt_row gt_left\">america</td>\n<td headers=\"freq\" class=\"gt_row gt_right\">269</td></tr>\n    <tr><td headers=\"word\" class=\"gt_row gt_left\">texas</td>\n<td headers=\"freq\" class=\"gt_row gt_right\">189</td></tr>\n    <tr><td headers=\"word\" class=\"gt_row gt_left\">iferc</td>\n<td headers=\"freq\" class=\"gt_row gt_right\">177</td></tr>\n    <tr><td headers=\"word\" class=\"gt_row gt_left\">energy</td>\n<td headers=\"freq\" class=\"gt_row gt_right\">151</td></tr>\n    <tr><td headers=\"word\" class=\"gt_row gt_left\">clynes</td>\n<td headers=\"freq\" class=\"gt_row gt_right\">144</td></tr>\n    <tr><td headers=\"word\" class=\"gt_row gt_left\">sitara</td>\n<td headers=\"freq\" class=\"gt_row gt_right\">137</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n\n# Conclusion\n",
    "supporting": [
      "spam_detection_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../site_libs/htmltools-fill-0.5.8.1/fill.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/htmlwidgets-1.6.4/htmlwidgets.js\"></script>\n<script src=\"../../site_libs/plotly-binding-4.10.4/plotly.js\"></script>\n<script src=\"../../site_libs/typedarray-0.1/typedarray.min.js\"></script>\n<script src=\"../../site_libs/jquery-3.5.1/jquery.min.js\"></script>\n<link href=\"../../site_libs/crosstalk-1.2.1/css/crosstalk.min.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/crosstalk-1.2.1/js/crosstalk.min.js\"></script>\n<link href=\"../../site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/plotly-main-2.11.1/plotly-latest.min.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}