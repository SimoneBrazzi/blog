{
  "hash": "d3268334829a6a42376557fab2342147",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Spam Detection\"\n# image: \"toxic_comment.jpg\"\ndescription: \"BiLSTM model for multi label classification\"\nauthor: \"Simone Brazzi\"\ndate: \"2024-09-05\"\ndraft: true\ncategories:\n  - code\n  - NLP\n  - Natural Language, Processing\n  - Python, R\nother-links:\n  - icon: file-code\n    text: Kaggle\n    href: https://www.kaggle.com/code/simonebrazzi/toxic-comment-filter-bilstm\ntoc: true\ntoc-title: \"Table of Contents\"\ntoc-depth: 3\nnumber-sections: true\nnumber-depth: 3\nembed-resources: true\nanchor-sections: true\nsmooth-scroll: true\nhighlight-style: monokai\ncode-line-numbers: true\ncode-copy: true\ncode-link: true\neditor_options: \n  chunk_output_type: console\n---\n\n\n\n# Introduction\n\n-   Addestrare un classificatore per identificare SPAM\n-   Individuare i Topic principali tra le email SPAM presenti nel dataset\n-   Calcolare la distanza semantica tra i topics ottenuti, per dedurne l'eterogeneità.\n-   Estrarre dalle mail NON SPAM le Organizzazioni presenti.\n\n# Import\n\n## R libraries\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse, verbose = FALSE)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   3.5.1     ✔ tibble    3.2.1\n✔ lubridate 1.9.3     ✔ tidyr     1.3.1\n✔ purrr     1.0.2     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(ggplot2)\nlibrary(gt)\nlibrary(reticulate)\nlibrary(plotly)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAttaching package: 'plotly'\n\nThe following object is masked from 'package:ggplot2':\n\n    last_plot\n\nThe following object is masked from 'package:stats':\n\n    filter\n\nThe following object is masked from 'package:graphics':\n\n    layout\n```\n\n\n:::\n\n```{.r .cell-code}\n# renv::use_python(\"/Users/simonebrazzi/venv/blog/bin/python3\")\n```\n:::\n\n\n\n## Python packages\n\n\n\n::: {.cell}\n\n```{.python .cell-code}\nimport pandas as pd\nimport numpy as np\nimport spacy\nimport nltk\nimport string\nimport gensim\nimport gensim.corpora as corpora\nimport gensim.downloader\n\nfrom nltk.corpus import stopwords\nfrom gensim.models import Word2Vec\nfrom scipy.spatial.distance import cosine\nfrom sklearn.metrics.pairwise import cosine_similarity\n\nfrom sklearn.feature_extraction.text import TfidfVectorizer\nfrom sklearn.neural_network import MLPClassifier\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.metrics import classification_report\n\nnltk.download('stopwords')\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nTrue\n```\n\n\n:::\n\n```{.python .cell-code}\nglove_vector = gensim.downloader.load(\"glove-wiki-gigaword-300\")\n```\n:::\n\n\n\n# Dataset\n\n\n\n::: {.cell}\n\n```{.python .cell-code}\nfile = \"/Users/simonebrazzi/R/blog/posts/spam_detection/spam_dataset.csv\"\ndf = pd.read_csv(file, index_col=0)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(reticulate)\ndf <- py$df\n```\n:::\n\n\n\n## EDA\n\n\n\n::: {#tbl-eda .cell tbl-cap='Absolute and relative frequencies'}\n\n```{.r .cell-code}\ndf_g <- df %>% \n  summarise(\n    freq_abs = n(),\n    freq_rel = n() / nrow(df),\n    .by = label\n  )\n\ndf_g %>% \n  gt() %>% \n  fmt_auto() %>% \n  cols_width(\n    label ~ pct(20),\n    freq_abs ~ pct(35),\n    freq_rel ~ pct(35)\n    ) %>% \n  cols_align(\n    align = \"center\",\n    columns = c(freq_abs, freq_rel)\n  ) %>% \n  tab_header(\n    title = \"Label frequency\",\n    subtitle = \"Absolute and relative frequencies\"\n  ) %>% \n  cols_label(\n    label = \"Label\",\n    freq_abs = \"Absolute frequency\",\n    freq_rel = \"Relative frequency\"\n  ) %>% \n  tab_options(\n    table.width = pct(100)\n  )\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"vdcmbhaofh\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#vdcmbhaofh table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#vdcmbhaofh thead, #vdcmbhaofh tbody, #vdcmbhaofh tfoot, #vdcmbhaofh tr, #vdcmbhaofh td, #vdcmbhaofh th {\n  border-style: none;\n}\n\n#vdcmbhaofh p {\n  margin: 0;\n  padding: 0;\n}\n\n#vdcmbhaofh .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: 100%;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#vdcmbhaofh .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#vdcmbhaofh .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#vdcmbhaofh .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#vdcmbhaofh .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#vdcmbhaofh .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#vdcmbhaofh .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#vdcmbhaofh .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#vdcmbhaofh .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#vdcmbhaofh .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#vdcmbhaofh .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#vdcmbhaofh .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#vdcmbhaofh .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#vdcmbhaofh .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#vdcmbhaofh .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#vdcmbhaofh .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#vdcmbhaofh .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#vdcmbhaofh .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#vdcmbhaofh .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#vdcmbhaofh .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#vdcmbhaofh .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#vdcmbhaofh .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#vdcmbhaofh .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#vdcmbhaofh .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#vdcmbhaofh .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#vdcmbhaofh .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#vdcmbhaofh .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#vdcmbhaofh .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#vdcmbhaofh .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#vdcmbhaofh .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#vdcmbhaofh .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#vdcmbhaofh .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#vdcmbhaofh .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#vdcmbhaofh .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#vdcmbhaofh .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#vdcmbhaofh .gt_left {\n  text-align: left;\n}\n\n#vdcmbhaofh .gt_center {\n  text-align: center;\n}\n\n#vdcmbhaofh .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#vdcmbhaofh .gt_font_normal {\n  font-weight: normal;\n}\n\n#vdcmbhaofh .gt_font_bold {\n  font-weight: bold;\n}\n\n#vdcmbhaofh .gt_font_italic {\n  font-style: italic;\n}\n\n#vdcmbhaofh .gt_super {\n  font-size: 65%;\n}\n\n#vdcmbhaofh .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#vdcmbhaofh .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#vdcmbhaofh .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#vdcmbhaofh .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#vdcmbhaofh .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#vdcmbhaofh .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#vdcmbhaofh .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#vdcmbhaofh .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#vdcmbhaofh div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" style=\"table-layout: fixed;; width: 100%\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <colgroup>\n    <col style=\"width:20%;\"/>\n    <col style=\"width:35%;\"/>\n    <col style=\"width:35%;\"/>\n  </colgroup>\n  <thead>\n    <tr class=\"gt_heading\">\n      <td colspan=\"3\" class=\"gt_heading gt_title gt_font_normal\" style>Label frequency</td>\n    </tr>\n    <tr class=\"gt_heading\">\n      <td colspan=\"3\" class=\"gt_heading gt_subtitle gt_font_normal gt_bottom_border\" style>Absolute and relative frequencies</td>\n    </tr>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Label\">Label</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Absolute frequency\">Absolute frequency</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Relative frequency\">Relative frequency</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">ham</td>\n<td headers=\"freq_abs\" class=\"gt_row gt_center\">3,672 </td>\n<td headers=\"freq_rel\" class=\"gt_row gt_center\">0.71</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">spam</td>\n<td headers=\"freq_abs\" class=\"gt_row gt_center\">1,499 </td>\n<td headers=\"freq_rel\" class=\"gt_row gt_center\">0.29</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ng <- ggplot(df_g) +\n  geom_col(aes(x = freq_abs, y = label, fill = label)) +\n  scale_fill_brewer(palette = \"Set1\") +\n  theme_minimal() +\n  ggtitle(\"Absolute frequency barchart\") +\n  xlab(\"Absolute frequency\") +\n  ylab(\"Label\") +\n  labs(fill = \"Label\")\nggplotly(g)\n```\n\n::: {#fig-barchart .cell-output-display}\n\n```{=html}\n<div class=\"plotly html-widget html-fill-item\" id=\"htmlwidget-c5e27ed68b5452263e01\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-c5e27ed68b5452263e01\">{\"x\":{\"data\":[{\"orientation\":\"v\",\"width\":3672,\"base\":0.55000000000000004,\"x\":[1836],\"y\":[0.89999999999999991],\"text\":\"freq_abs: 3672<br />label: ham<br />label: ham\",\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(228,26,28,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"ham\",\"legendgroup\":\"ham\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"v\",\"width\":1499,\"base\":1.55,\"x\":[749.5],\"y\":[0.90000000000000013],\"text\":\"freq_abs: 1499<br />label: spam<br />label: spam\",\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(55,126,184,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"spam\",\"legendgroup\":\"spam\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null}],\"layout\":{\"margin\":{\"t\":43.762557077625573,\"r\":7.3059360730593621,\"b\":40.182648401826498,\"l\":48.949771689497723},\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724},\"title\":{\"text\":\"Absolute frequency barchart\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":17.534246575342465},\"x\":0,\"xref\":\"paper\"},\"xaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[-183.60000000000002,3855.5999999999999],\"tickmode\":\"array\",\"ticktext\":[\"0\",\"1000\",\"2000\",\"3000\"],\"tickvals\":[0,999.99999999999989,2000,3000],\"categoryorder\":\"array\",\"categoryarray\":[\"0\",\"1000\",\"2000\",\"3000\"],\"nticks\":null,\"ticks\":\"\",\"tickcolor\":null,\"ticklen\":3.6529680365296811,\"tickwidth\":0,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.68949771689498},\"tickangle\":-0,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":true,\"gridcolor\":\"rgba(235,235,235,1)\",\"gridwidth\":0.66417600664176002,\"zeroline\":false,\"anchor\":\"y\",\"title\":{\"text\":\"Absolute frequency\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}},\"hoverformat\":\".2f\"},\"yaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[0.40000000000000002,2.6000000000000001],\"tickmode\":\"array\",\"ticktext\":[\"ham\",\"spam\"],\"tickvals\":[1,2],\"categoryorder\":\"array\",\"categoryarray\":[\"ham\",\"spam\"],\"nticks\":null,\"ticks\":\"\",\"tickcolor\":null,\"ticklen\":3.6529680365296811,\"tickwidth\":0,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.68949771689498},\"tickangle\":-0,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":true,\"gridcolor\":\"rgba(235,235,235,1)\",\"gridwidth\":0.66417600664176002,\"zeroline\":false,\"anchor\":\"x\",\"title\":{\"text\":\"Label\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}},\"hoverformat\":\".2f\"},\"shapes\":[{\"type\":\"rect\",\"fillcolor\":null,\"line\":{\"color\":null,\"width\":0,\"linetype\":[]},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0,\"x1\":1,\"y0\":0,\"y1\":1}],\"showlegend\":true,\"legend\":{\"bgcolor\":null,\"bordercolor\":null,\"borderwidth\":0,\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":11.68949771689498},\"title\":{\"text\":\"Label\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}}},\"hovermode\":\"closest\",\"barmode\":\"relative\"},\"config\":{\"doubleClick\":\"reset\",\"modeBarButtonsToAdd\":[\"hoverclosest\",\"hovercompare\"],\"showSendToCloud\":false},\"source\":\"A\",\"attrs\":{\"d345c0e1deb\":{\"x\":{},\"y\":{},\"fill\":{},\"type\":\"bar\"}},\"cur_data\":\"d345c0e1deb\",\"visdat\":{\"d345c0e1deb\":[\"function (y) \",\"x\"]},\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.20000000000000001,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n\nAbsolute frequency barchart\n:::\n:::\n\n\n\n# Preprocessing\n\nPreprocessing is the sum of the following steps:\n\n1.  lowercasing\n2.  punctuation removal\n3.  lemmatization\n4.  tokenization\n5.  stopwords removal\n\n`nlp.pipe` return a generator that yields `Doc` objects, not a list. To use it as a list, it has to be defined as such.\n\nTo speed up the process, is it possible to enable the multi process method in `nlp.pipe`.\n\n\n\n::: {.cell}\n\n```{.python .cell-code}\nstop_words = stopwords.words('english')\nnlp = spacy.load(\"en_core_web_lg\")\n\ndoc = list(nlp.pipe(df.text))\n```\n:::\n\n\n\nNormalization: 1. remove punctuation. 2. remove stop words. 3. remove spaces. 4. remove \"subject\" token. 5. lemmatization.\n\n\n\n::: {.cell}\n\n```{.python .cell-code}\npunctuation = set(string.punctuation)\nstop_words = set(stop_words)\nlemmas = [\n    [\n      t.lemma_ for t in d \n      if (text := t.text.lower()) not in punctuation \n      and text not in stop_words \n      and not t.is_space \n      and text != \"subject\" \n      and not t.is_digit\n      and len(text) >=5\n      ]\n      for d in doc\n      ]\n\nentities = [\n    [\n      t.lemma_ for t in d \n      if (text := t.text.lower()) not in punctuation \n      and text not in stop_words \n      and not t.is_space \n      and text != \"subject\" \n      and not t.is_digit\n      and len(text) >=5\n      and t.ent_type_ == \"ORG\"\n      ]\n      for d in doc\n      ]\n\ndf[\"lemmas\"] = lemmas\ndf[\"entities\"] = entities\n```\n:::\n\n\n\n# Tasks\n\n## Classification\n\nThe text is already preprocessed in the lemmas column. From a list of string, it has to be transformed to a string.\n\n\n\n::: {.cell}\n\n```{.python .cell-code}\ndf[\"feature\"] = df.lemmas.apply(lambda x : \" \".join(x))\n```\n:::\n\n\n\n### Features\n\n\n\n::: {.cell}\n\n```{.python .cell-code}\nvectorizer = TfidfVectorizer()\nX = vectorizer.fit_transform(df['feature'])\ny = df.label\n```\n:::\n\n\n\n## Split\n\n\n\n::: {.cell}\n\n```{.python .cell-code}\nxtrain, xtest, ytrain, ytest = train_test_split(X, y, test_size=.2, random_state=42)\n```\n:::\n\n\n\n### Model\n\n\n\n::: {.cell}\n\n```{.python .cell-code}\nmlp = MLPClassifier(\n  activation=\"logistic\",\n  solver=\"adam\",\n  max_iter=100,\n  hidden_layer_sizes=(100,), # one layer with dimension 100\n  tol=.005,\n  verbose=True\n)\n```\n:::\n\n\n\n### Fit\n\n\n\n::: {.cell}\n\n```{.python .cell-code}\nmlp.fit(xtrain, ytrain)\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<style>#sk-container-id-1 {\n  /* Definition of color scheme common for light and dark mode */\n  --sklearn-color-text: black;\n  --sklearn-color-line: gray;\n  /* Definition of color scheme for unfitted estimators */\n  --sklearn-color-unfitted-level-0: #fff5e6;\n  --sklearn-color-unfitted-level-1: #f6e4d2;\n  --sklearn-color-unfitted-level-2: #ffe0b3;\n  --sklearn-color-unfitted-level-3: chocolate;\n  /* Definition of color scheme for fitted estimators */\n  --sklearn-color-fitted-level-0: #f0f8ff;\n  --sklearn-color-fitted-level-1: #d4ebff;\n  --sklearn-color-fitted-level-2: #b3dbfd;\n  --sklearn-color-fitted-level-3: cornflowerblue;\n\n  /* Specific color for light theme */\n  --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));\n  --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, white)));\n  --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));\n  --sklearn-color-icon: #696969;\n\n  @media (prefers-color-scheme: dark) {\n    /* Redefinition of color scheme for dark theme */\n    --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));\n    --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, #111)));\n    --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));\n    --sklearn-color-icon: #878787;\n  }\n}\n\n#sk-container-id-1 {\n  color: var(--sklearn-color-text);\n}\n\n#sk-container-id-1 pre {\n  padding: 0;\n}\n\n#sk-container-id-1 input.sk-hidden--visually {\n  border: 0;\n  clip: rect(1px 1px 1px 1px);\n  clip: rect(1px, 1px, 1px, 1px);\n  height: 1px;\n  margin: -1px;\n  overflow: hidden;\n  padding: 0;\n  position: absolute;\n  width: 1px;\n}\n\n#sk-container-id-1 div.sk-dashed-wrapped {\n  border: 1px dashed var(--sklearn-color-line);\n  margin: 0 0.4em 0.5em 0.4em;\n  box-sizing: border-box;\n  padding-bottom: 0.4em;\n  background-color: var(--sklearn-color-background);\n}\n\n#sk-container-id-1 div.sk-container {\n  /* jupyter's `normalize.less` sets `[hidden] { display: none; }`\n     but bootstrap.min.css set `[hidden] { display: none !important; }`\n     so we also need the `!important` here to be able to override the\n     default hidden behavior on the sphinx rendered scikit-learn.org.\n     See: https://github.com/scikit-learn/scikit-learn/issues/21755 */\n  display: inline-block !important;\n  position: relative;\n}\n\n#sk-container-id-1 div.sk-text-repr-fallback {\n  display: none;\n}\n\ndiv.sk-parallel-item,\ndiv.sk-serial,\ndiv.sk-item {\n  /* draw centered vertical line to link estimators */\n  background-image: linear-gradient(var(--sklearn-color-text-on-default-background), var(--sklearn-color-text-on-default-background));\n  background-size: 2px 100%;\n  background-repeat: no-repeat;\n  background-position: center center;\n}\n\n/* Parallel-specific style estimator block */\n\n#sk-container-id-1 div.sk-parallel-item::after {\n  content: \"\";\n  width: 100%;\n  border-bottom: 2px solid var(--sklearn-color-text-on-default-background);\n  flex-grow: 1;\n}\n\n#sk-container-id-1 div.sk-parallel {\n  display: flex;\n  align-items: stretch;\n  justify-content: center;\n  background-color: var(--sklearn-color-background);\n  position: relative;\n}\n\n#sk-container-id-1 div.sk-parallel-item {\n  display: flex;\n  flex-direction: column;\n}\n\n#sk-container-id-1 div.sk-parallel-item:first-child::after {\n  align-self: flex-end;\n  width: 50%;\n}\n\n#sk-container-id-1 div.sk-parallel-item:last-child::after {\n  align-self: flex-start;\n  width: 50%;\n}\n\n#sk-container-id-1 div.sk-parallel-item:only-child::after {\n  width: 0;\n}\n\n/* Serial-specific style estimator block */\n\n#sk-container-id-1 div.sk-serial {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  background-color: var(--sklearn-color-background);\n  padding-right: 1em;\n  padding-left: 1em;\n}\n\n\n/* Toggleable style: style used for estimator/Pipeline/ColumnTransformer box that is\nclickable and can be expanded/collapsed.\n- Pipeline and ColumnTransformer use this feature and define the default style\n- Estimators will overwrite some part of the style using the `sk-estimator` class\n*/\n\n/* Pipeline and ColumnTransformer style (default) */\n\n#sk-container-id-1 div.sk-toggleable {\n  /* Default theme specific background. It is overwritten whether we have a\n  specific estimator or a Pipeline/ColumnTransformer */\n  background-color: var(--sklearn-color-background);\n}\n\n/* Toggleable label */\n#sk-container-id-1 label.sk-toggleable__label {\n  cursor: pointer;\n  display: block;\n  width: 100%;\n  margin-bottom: 0;\n  padding: 0.5em;\n  box-sizing: border-box;\n  text-align: center;\n}\n\n#sk-container-id-1 label.sk-toggleable__label-arrow:before {\n  /* Arrow on the left of the label */\n  content: \"▸\";\n  float: left;\n  margin-right: 0.25em;\n  color: var(--sklearn-color-icon);\n}\n\n#sk-container-id-1 label.sk-toggleable__label-arrow:hover:before {\n  color: var(--sklearn-color-text);\n}\n\n/* Toggleable content - dropdown */\n\n#sk-container-id-1 div.sk-toggleable__content {\n  max-height: 0;\n  max-width: 0;\n  overflow: hidden;\n  text-align: left;\n  /* unfitted */\n  background-color: var(--sklearn-color-unfitted-level-0);\n}\n\n#sk-container-id-1 div.sk-toggleable__content.fitted {\n  /* fitted */\n  background-color: var(--sklearn-color-fitted-level-0);\n}\n\n#sk-container-id-1 div.sk-toggleable__content pre {\n  margin: 0.2em;\n  border-radius: 0.25em;\n  color: var(--sklearn-color-text);\n  /* unfitted */\n  background-color: var(--sklearn-color-unfitted-level-0);\n}\n\n#sk-container-id-1 div.sk-toggleable__content.fitted pre {\n  /* unfitted */\n  background-color: var(--sklearn-color-fitted-level-0);\n}\n\n#sk-container-id-1 input.sk-toggleable__control:checked~div.sk-toggleable__content {\n  /* Expand drop-down */\n  max-height: 200px;\n  max-width: 100%;\n  overflow: auto;\n}\n\n#sk-container-id-1 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {\n  content: \"▾\";\n}\n\n/* Pipeline/ColumnTransformer-specific style */\n\n#sk-container-id-1 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {\n  color: var(--sklearn-color-text);\n  background-color: var(--sklearn-color-unfitted-level-2);\n}\n\n#sk-container-id-1 div.sk-label.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {\n  background-color: var(--sklearn-color-fitted-level-2);\n}\n\n/* Estimator-specific style */\n\n/* Colorize estimator box */\n#sk-container-id-1 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {\n  /* unfitted */\n  background-color: var(--sklearn-color-unfitted-level-2);\n}\n\n#sk-container-id-1 div.sk-estimator.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {\n  /* fitted */\n  background-color: var(--sklearn-color-fitted-level-2);\n}\n\n#sk-container-id-1 div.sk-label label.sk-toggleable__label,\n#sk-container-id-1 div.sk-label label {\n  /* The background is the default theme color */\n  color: var(--sklearn-color-text-on-default-background);\n}\n\n/* On hover, darken the color of the background */\n#sk-container-id-1 div.sk-label:hover label.sk-toggleable__label {\n  color: var(--sklearn-color-text);\n  background-color: var(--sklearn-color-unfitted-level-2);\n}\n\n/* Label box, darken color on hover, fitted */\n#sk-container-id-1 div.sk-label.fitted:hover label.sk-toggleable__label.fitted {\n  color: var(--sklearn-color-text);\n  background-color: var(--sklearn-color-fitted-level-2);\n}\n\n/* Estimator label */\n\n#sk-container-id-1 div.sk-label label {\n  font-family: monospace;\n  font-weight: bold;\n  display: inline-block;\n  line-height: 1.2em;\n}\n\n#sk-container-id-1 div.sk-label-container {\n  text-align: center;\n}\n\n/* Estimator-specific */\n#sk-container-id-1 div.sk-estimator {\n  font-family: monospace;\n  border: 1px dotted var(--sklearn-color-border-box);\n  border-radius: 0.25em;\n  box-sizing: border-box;\n  margin-bottom: 0.5em;\n  /* unfitted */\n  background-color: var(--sklearn-color-unfitted-level-0);\n}\n\n#sk-container-id-1 div.sk-estimator.fitted {\n  /* fitted */\n  background-color: var(--sklearn-color-fitted-level-0);\n}\n\n/* on hover */\n#sk-container-id-1 div.sk-estimator:hover {\n  /* unfitted */\n  background-color: var(--sklearn-color-unfitted-level-2);\n}\n\n#sk-container-id-1 div.sk-estimator.fitted:hover {\n  /* fitted */\n  background-color: var(--sklearn-color-fitted-level-2);\n}\n\n/* Specification for estimator info (e.g. \"i\" and \"?\") */\n\n/* Common style for \"i\" and \"?\" */\n\n.sk-estimator-doc-link,\na:link.sk-estimator-doc-link,\na:visited.sk-estimator-doc-link {\n  float: right;\n  font-size: smaller;\n  line-height: 1em;\n  font-family: monospace;\n  background-color: var(--sklearn-color-background);\n  border-radius: 1em;\n  height: 1em;\n  width: 1em;\n  text-decoration: none !important;\n  margin-left: 1ex;\n  /* unfitted */\n  border: var(--sklearn-color-unfitted-level-1) 1pt solid;\n  color: var(--sklearn-color-unfitted-level-1);\n}\n\n.sk-estimator-doc-link.fitted,\na:link.sk-estimator-doc-link.fitted,\na:visited.sk-estimator-doc-link.fitted {\n  /* fitted */\n  border: var(--sklearn-color-fitted-level-1) 1pt solid;\n  color: var(--sklearn-color-fitted-level-1);\n}\n\n/* On hover */\ndiv.sk-estimator:hover .sk-estimator-doc-link:hover,\n.sk-estimator-doc-link:hover,\ndiv.sk-label-container:hover .sk-estimator-doc-link:hover,\n.sk-estimator-doc-link:hover {\n  /* unfitted */\n  background-color: var(--sklearn-color-unfitted-level-3);\n  color: var(--sklearn-color-background);\n  text-decoration: none;\n}\n\ndiv.sk-estimator.fitted:hover .sk-estimator-doc-link.fitted:hover,\n.sk-estimator-doc-link.fitted:hover,\ndiv.sk-label-container:hover .sk-estimator-doc-link.fitted:hover,\n.sk-estimator-doc-link.fitted:hover {\n  /* fitted */\n  background-color: var(--sklearn-color-fitted-level-3);\n  color: var(--sklearn-color-background);\n  text-decoration: none;\n}\n\n/* Span, style for the box shown on hovering the info icon */\n.sk-estimator-doc-link span {\n  display: none;\n  z-index: 9999;\n  position: relative;\n  font-weight: normal;\n  right: .2ex;\n  padding: .5ex;\n  margin: .5ex;\n  width: min-content;\n  min-width: 20ex;\n  max-width: 50ex;\n  color: var(--sklearn-color-text);\n  box-shadow: 2pt 2pt 4pt #999;\n  /* unfitted */\n  background: var(--sklearn-color-unfitted-level-0);\n  border: .5pt solid var(--sklearn-color-unfitted-level-3);\n}\n\n.sk-estimator-doc-link.fitted span {\n  /* fitted */\n  background: var(--sklearn-color-fitted-level-0);\n  border: var(--sklearn-color-fitted-level-3);\n}\n\n.sk-estimator-doc-link:hover span {\n  display: block;\n}\n\n/* \"?\"-specific style due to the `<a>` HTML tag */\n\n#sk-container-id-1 a.estimator_doc_link {\n  float: right;\n  font-size: 1rem;\n  line-height: 1em;\n  font-family: monospace;\n  background-color: var(--sklearn-color-background);\n  border-radius: 1rem;\n  height: 1rem;\n  width: 1rem;\n  text-decoration: none;\n  /* unfitted */\n  color: var(--sklearn-color-unfitted-level-1);\n  border: var(--sklearn-color-unfitted-level-1) 1pt solid;\n}\n\n#sk-container-id-1 a.estimator_doc_link.fitted {\n  /* fitted */\n  border: var(--sklearn-color-fitted-level-1) 1pt solid;\n  color: var(--sklearn-color-fitted-level-1);\n}\n\n/* On hover */\n#sk-container-id-1 a.estimator_doc_link:hover {\n  /* unfitted */\n  background-color: var(--sklearn-color-unfitted-level-3);\n  color: var(--sklearn-color-background);\n  text-decoration: none;\n}\n\n#sk-container-id-1 a.estimator_doc_link.fitted:hover {\n  /* fitted */\n  background-color: var(--sklearn-color-fitted-level-3);\n}\n</style><div id=\"sk-container-id-1\" class=\"sk-top-container\"><div class=\"sk-text-repr-fallback\"><pre>MLPClassifier(activation=&#x27;logistic&#x27;, max_iter=100, tol=0.005, verbose=True)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class=\"sk-container\" hidden><div class=\"sk-item\"><div class=\"sk-estimator fitted sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-1\" type=\"checkbox\" checked><label for=\"sk-estimator-id-1\" class=\"sk-toggleable__label fitted sk-toggleable__label-arrow fitted\">&nbsp;&nbsp;MLPClassifier<a class=\"sk-estimator-doc-link fitted\" rel=\"noreferrer\" target=\"_blank\" href=\"https://scikit-learn.org/1.4/modules/generated/sklearn.neural_network.MLPClassifier.html\">?<span>Documentation for MLPClassifier</span></a><span class=\"sk-estimator-doc-link fitted\">i<span>Fitted</span></span></label><div class=\"sk-toggleable__content fitted\"><pre>MLPClassifier(activation=&#x27;logistic&#x27;, max_iter=100, tol=0.005, verbose=True)</pre></div> </div></div></div></div>\n```\n\n:::\n:::\n\n\n\n### Predict\n\n\n\n::: {.cell}\n\n```{.python .cell-code}\nypred = mlp.predict(xtest)\n```\n:::\n\n\n\n### Classification report\n\n\n\n::: {.cell}\n\n```{.python .cell-code}\ncr = classification_report(\n  ytest,\n  ypred,\n  #target_names=config.labels,\n  digits=4,\n  output_dict=True\n  )\ndf_cr = pd.DataFrame.from_dict(cr).reset_index()\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(reticulate)\ndf_cr <- py$df_cr %>% dplyr::rename(names = index)\ncols <- df_cr %>% colnames()\ndf_cr %>% \n  pivot_longer(\n    cols = -names,\n    names_to = \"metrics\",\n    values_to = \"values\"\n  ) %>% \n  pivot_wider(\n    names_from = names,\n    values_from = values\n  ) %>% \n  gt() %>%\n  tab_header(\n    title = \"Confusion Matrix\",\n    subtitle = \"Threshold optimization favoring recall\"\n  ) %>% \n  fmt_number(\n    columns = c(\"precision\", \"recall\", \"f1-score\", \"support\"),\n    decimals = 2,\n    drop_trailing_zeros = TRUE,\n    drop_trailing_dec_mark = FALSE\n  ) %>% \n  cols_align(\n    align = \"center\",\n    columns = c(\"precision\", \"recall\", \"f1-score\", \"support\")\n  ) %>% \n  cols_align(\n    align = \"left\",\n    columns = metrics\n  ) %>% \n  cols_label(\n    metrics = \"Metrics\",\n    precision = \"Precision\",\n    recall = \"Recall\",\n    `f1-score` = \"F1-Score\",\n    support = \"Support\"\n  )\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"fcwlusgbki\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#fcwlusgbki table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#fcwlusgbki thead, #fcwlusgbki tbody, #fcwlusgbki tfoot, #fcwlusgbki tr, #fcwlusgbki td, #fcwlusgbki th {\n  border-style: none;\n}\n\n#fcwlusgbki p {\n  margin: 0;\n  padding: 0;\n}\n\n#fcwlusgbki .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#fcwlusgbki .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#fcwlusgbki .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#fcwlusgbki .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#fcwlusgbki .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#fcwlusgbki .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#fcwlusgbki .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#fcwlusgbki .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#fcwlusgbki .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#fcwlusgbki .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#fcwlusgbki .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#fcwlusgbki .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#fcwlusgbki .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#fcwlusgbki .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#fcwlusgbki .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#fcwlusgbki .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#fcwlusgbki .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#fcwlusgbki .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#fcwlusgbki .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#fcwlusgbki .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#fcwlusgbki .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#fcwlusgbki .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#fcwlusgbki .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#fcwlusgbki .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#fcwlusgbki .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#fcwlusgbki .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#fcwlusgbki .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#fcwlusgbki .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#fcwlusgbki .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#fcwlusgbki .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#fcwlusgbki .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#fcwlusgbki .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#fcwlusgbki .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#fcwlusgbki .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#fcwlusgbki .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#fcwlusgbki .gt_left {\n  text-align: left;\n}\n\n#fcwlusgbki .gt_center {\n  text-align: center;\n}\n\n#fcwlusgbki .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#fcwlusgbki .gt_font_normal {\n  font-weight: normal;\n}\n\n#fcwlusgbki .gt_font_bold {\n  font-weight: bold;\n}\n\n#fcwlusgbki .gt_font_italic {\n  font-style: italic;\n}\n\n#fcwlusgbki .gt_super {\n  font-size: 65%;\n}\n\n#fcwlusgbki .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#fcwlusgbki .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#fcwlusgbki .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#fcwlusgbki .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#fcwlusgbki .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#fcwlusgbki .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#fcwlusgbki .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#fcwlusgbki .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#fcwlusgbki div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_heading\">\n      <td colspan=\"5\" class=\"gt_heading gt_title gt_font_normal\" style>Confusion Matrix</td>\n    </tr>\n    <tr class=\"gt_heading\">\n      <td colspan=\"5\" class=\"gt_heading gt_subtitle gt_font_normal gt_bottom_border\" style>Threshold optimization favoring recall</td>\n    </tr>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Metrics\">Metrics</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Precision\">Precision</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Recall\">Recall</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"F1-Score\">F1-Score</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Support\">Support</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"metrics\" class=\"gt_row gt_left\">ham</td>\n<td headers=\"precision\" class=\"gt_row gt_center\">0.99</td>\n<td headers=\"recall\" class=\"gt_row gt_center\">0.98</td>\n<td headers=\"f1-score\" class=\"gt_row gt_center\">0.99</td>\n<td headers=\"support\" class=\"gt_row gt_center\">742.</td></tr>\n    <tr><td headers=\"metrics\" class=\"gt_row gt_left\">spam</td>\n<td headers=\"precision\" class=\"gt_row gt_center\">0.96</td>\n<td headers=\"recall\" class=\"gt_row gt_center\">0.97</td>\n<td headers=\"f1-score\" class=\"gt_row gt_center\">0.97</td>\n<td headers=\"support\" class=\"gt_row gt_center\">293.</td></tr>\n    <tr><td headers=\"metrics\" class=\"gt_row gt_left\">accuracy</td>\n<td headers=\"precision\" class=\"gt_row gt_center\">0.98</td>\n<td headers=\"recall\" class=\"gt_row gt_center\">0.98</td>\n<td headers=\"f1-score\" class=\"gt_row gt_center\">0.98</td>\n<td headers=\"support\" class=\"gt_row gt_center\">0.98</td></tr>\n    <tr><td headers=\"metrics\" class=\"gt_row gt_left\">macro avg</td>\n<td headers=\"precision\" class=\"gt_row gt_center\">0.97</td>\n<td headers=\"recall\" class=\"gt_row gt_center\">0.98</td>\n<td headers=\"f1-score\" class=\"gt_row gt_center\">0.98</td>\n<td headers=\"support\" class=\"gt_row gt_center\">1,035.</td></tr>\n    <tr><td headers=\"metrics\" class=\"gt_row gt_left\">weighted avg</td>\n<td headers=\"precision\" class=\"gt_row gt_center\">0.98</td>\n<td headers=\"recall\" class=\"gt_row gt_center\">0.98</td>\n<td headers=\"f1-score\" class=\"gt_row gt_center\">0.98</td>\n<td headers=\"support\" class=\"gt_row gt_center\">1,035.</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n\n## Topic Modeling for spam content\n\nFilter data to have a spam dataframe and create a variable with the lemmas column to work with.\n\n\n\n::: {.cell}\n\n```{.python .cell-code}\nspam = df[df.label == \"spam\"]\nx = spam.lemmas\n```\n:::\n\n\n\nLDA algortihm needs the corpus as a **bag of word**.\n\n### Create corpus\n\n\n\n::: {.cell}\n\n```{.python .cell-code}\nid2word = corpora.Dictionary(x)\ncorpus = [id2word.doc2bow(t) for t in x]\n```\n:::\n\n\n\n### Model\n\n\n\n::: {.cell}\n\n```{.python .cell-code}\nlda = gensim.models.LdaMulticore(\n  corpus=corpus,\n  id2word=id2word,\n  num_topics=10,\n  passes=10, # number of times the algorithm see the corpus\n  workers=4, # parellalize\n  random_state=42\n)\ntopic_words = lda.show_topics(num_topics=10, num_words=5, formatted=False)\n\ndata = []\n\n# Iterate over topic_words to extract the data\ndata = [\n    (topic, w, p)\n    for topic, words in topic_words\n    for w, p in words\n]\n\n# Create the DataFrame\ntopics_df = pd.DataFrame(data, columns=['topic', 'word', 'proba'])\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\npy$topics_df %>% \n  gt()\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"vzkchmtxpl\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#vzkchmtxpl table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#vzkchmtxpl thead, #vzkchmtxpl tbody, #vzkchmtxpl tfoot, #vzkchmtxpl tr, #vzkchmtxpl td, #vzkchmtxpl th {\n  border-style: none;\n}\n\n#vzkchmtxpl p {\n  margin: 0;\n  padding: 0;\n}\n\n#vzkchmtxpl .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#vzkchmtxpl .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#vzkchmtxpl .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#vzkchmtxpl .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#vzkchmtxpl .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#vzkchmtxpl .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#vzkchmtxpl .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#vzkchmtxpl .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#vzkchmtxpl .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#vzkchmtxpl .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#vzkchmtxpl .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#vzkchmtxpl .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#vzkchmtxpl .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#vzkchmtxpl .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#vzkchmtxpl .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#vzkchmtxpl .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#vzkchmtxpl .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#vzkchmtxpl .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#vzkchmtxpl .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#vzkchmtxpl .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#vzkchmtxpl .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#vzkchmtxpl .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#vzkchmtxpl .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#vzkchmtxpl .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#vzkchmtxpl .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#vzkchmtxpl .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#vzkchmtxpl .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#vzkchmtxpl .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#vzkchmtxpl .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#vzkchmtxpl .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#vzkchmtxpl .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#vzkchmtxpl .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#vzkchmtxpl .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#vzkchmtxpl .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#vzkchmtxpl .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#vzkchmtxpl .gt_left {\n  text-align: left;\n}\n\n#vzkchmtxpl .gt_center {\n  text-align: center;\n}\n\n#vzkchmtxpl .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#vzkchmtxpl .gt_font_normal {\n  font-weight: normal;\n}\n\n#vzkchmtxpl .gt_font_bold {\n  font-weight: bold;\n}\n\n#vzkchmtxpl .gt_font_italic {\n  font-style: italic;\n}\n\n#vzkchmtxpl .gt_super {\n  font-size: 65%;\n}\n\n#vzkchmtxpl .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#vzkchmtxpl .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#vzkchmtxpl .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#vzkchmtxpl .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#vzkchmtxpl .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#vzkchmtxpl .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#vzkchmtxpl .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#vzkchmtxpl .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#vzkchmtxpl div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"topic\">topic</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"word\">word</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"proba\">proba</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"topic\" class=\"gt_row gt_right\">0</td>\n<td headers=\"word\" class=\"gt_row gt_left\">height</td>\n<td headers=\"proba\" class=\"gt_row gt_right\">0.009397594</td></tr>\n    <tr><td headers=\"topic\" class=\"gt_row gt_right\">0</td>\n<td headers=\"word\" class=\"gt_row gt_left\">family</td>\n<td headers=\"proba\" class=\"gt_row gt_right\">0.006614721</td></tr>\n    <tr><td headers=\"topic\" class=\"gt_row gt_right\">0</td>\n<td headers=\"word\" class=\"gt_row gt_left\">email</td>\n<td headers=\"proba\" class=\"gt_row gt_right\">0.006074720</td></tr>\n    <tr><td headers=\"topic\" class=\"gt_row gt_right\">0</td>\n<td headers=\"word\" class=\"gt_row gt_left\">style</td>\n<td headers=\"proba\" class=\"gt_row gt_right\">0.006073837</td></tr>\n    <tr><td headers=\"topic\" class=\"gt_row gt_right\">0</td>\n<td headers=\"word\" class=\"gt_row gt_left\">number</td>\n<td headers=\"proba\" class=\"gt_row gt_right\">0.005768483</td></tr>\n    <tr><td headers=\"topic\" class=\"gt_row gt_right\">1</td>\n<td headers=\"word\" class=\"gt_row gt_left\">company</td>\n<td headers=\"proba\" class=\"gt_row gt_right\">0.008541896</td></tr>\n    <tr><td headers=\"topic\" class=\"gt_row gt_right\">1</td>\n<td headers=\"word\" class=\"gt_row gt_left\">account</td>\n<td headers=\"proba\" class=\"gt_row gt_right\">0.006575145</td></tr>\n    <tr><td headers=\"topic\" class=\"gt_row gt_right\">1</td>\n<td headers=\"word\" class=\"gt_row gt_left\">email</td>\n<td headers=\"proba\" class=\"gt_row gt_right\">0.006541106</td></tr>\n    <tr><td headers=\"topic\" class=\"gt_row gt_right\">1</td>\n<td headers=\"word\" class=\"gt_row gt_left\">million</td>\n<td headers=\"proba\" class=\"gt_row gt_right\">0.006161134</td></tr>\n    <tr><td headers=\"topic\" class=\"gt_row gt_right\">1</td>\n<td headers=\"word\" class=\"gt_row gt_left\">money</td>\n<td headers=\"proba\" class=\"gt_row gt_right\">0.004937542</td></tr>\n    <tr><td headers=\"topic\" class=\"gt_row gt_right\">2</td>\n<td headers=\"word\" class=\"gt_row gt_left\">price</td>\n<td headers=\"proba\" class=\"gt_row gt_right\">0.018214259</td></tr>\n    <tr><td headers=\"topic\" class=\"gt_row gt_right\">2</td>\n<td headers=\"word\" class=\"gt_row gt_left\">height</td>\n<td headers=\"proba\" class=\"gt_row gt_right\">0.010615461</td></tr>\n    <tr><td headers=\"topic\" class=\"gt_row gt_right\">2</td>\n<td headers=\"word\" class=\"gt_row gt_left\">width</td>\n<td headers=\"proba\" class=\"gt_row gt_right\">0.010508570</td></tr>\n    <tr><td headers=\"topic\" class=\"gt_row gt_right\">2</td>\n<td headers=\"word\" class=\"gt_row gt_left\">align</td>\n<td headers=\"proba\" class=\"gt_row gt_right\">0.009612118</td></tr>\n    <tr><td headers=\"topic\" class=\"gt_row gt_right\">2</td>\n<td headers=\"word\" class=\"gt_row gt_left\">color</td>\n<td headers=\"proba\" class=\"gt_row gt_right\">0.008357718</td></tr>\n    <tr><td headers=\"topic\" class=\"gt_row gt_right\">3</td>\n<td headers=\"word\" class=\"gt_row gt_left\">pill</td>\n<td headers=\"proba\" class=\"gt_row gt_right\">0.028588247</td></tr>\n    <tr><td headers=\"topic\" class=\"gt_row gt_right\">3</td>\n<td headers=\"word\" class=\"gt_row gt_left\">viagra</td>\n<td headers=\"proba\" class=\"gt_row gt_right\">0.006692155</td></tr>\n    <tr><td headers=\"topic\" class=\"gt_row gt_right\">3</td>\n<td headers=\"word\" class=\"gt_row gt_left\">health</td>\n<td headers=\"proba\" class=\"gt_row gt_right\">0.005496353</td></tr>\n    <tr><td headers=\"topic\" class=\"gt_row gt_right\">3</td>\n<td headers=\"word\" class=\"gt_row gt_left\">xanax</td>\n<td headers=\"proba\" class=\"gt_row gt_right\">0.003880552</td></tr>\n    <tr><td headers=\"topic\" class=\"gt_row gt_right\">3</td>\n<td headers=\"word\" class=\"gt_row gt_left\">valium</td>\n<td headers=\"proba\" class=\"gt_row gt_right\">0.003845794</td></tr>\n    <tr><td headers=\"topic\" class=\"gt_row gt_right\">4</td>\n<td headers=\"word\" class=\"gt_row gt_left\">source</td>\n<td headers=\"proba\" class=\"gt_row gt_right\">0.003020158</td></tr>\n    <tr><td headers=\"topic\" class=\"gt_row gt_right\">4</td>\n<td headers=\"word\" class=\"gt_row gt_left\">normally</td>\n<td headers=\"proba\" class=\"gt_row gt_right\">0.002973567</td></tr>\n    <tr><td headers=\"topic\" class=\"gt_row gt_right\">4</td>\n<td headers=\"word\" class=\"gt_row gt_left\">think</td>\n<td headers=\"proba\" class=\"gt_row gt_right\">0.002819329</td></tr>\n    <tr><td headers=\"topic\" class=\"gt_row gt_right\">4</td>\n<td headers=\"word\" class=\"gt_row gt_left\">palestinian</td>\n<td headers=\"proba\" class=\"gt_row gt_right\">0.002389335</td></tr>\n    <tr><td headers=\"topic\" class=\"gt_row gt_right\">4</td>\n<td headers=\"word\" class=\"gt_row gt_left\">dosage</td>\n<td headers=\"proba\" class=\"gt_row gt_right\">0.002289114</td></tr>\n    <tr><td headers=\"topic\" class=\"gt_row gt_right\">5</td>\n<td headers=\"word\" class=\"gt_row gt_left\">company</td>\n<td headers=\"proba\" class=\"gt_row gt_right\">0.021232544</td></tr>\n    <tr><td headers=\"topic\" class=\"gt_row gt_right\">5</td>\n<td headers=\"word\" class=\"gt_row gt_left\">statement</td>\n<td headers=\"proba\" class=\"gt_row gt_right\">0.014780753</td></tr>\n    <tr><td headers=\"topic\" class=\"gt_row gt_right\">5</td>\n<td headers=\"word\" class=\"gt_row gt_left\">stock</td>\n<td headers=\"proba\" class=\"gt_row gt_right\">0.011618639</td></tr>\n    <tr><td headers=\"topic\" class=\"gt_row gt_right\">5</td>\n<td headers=\"word\" class=\"gt_row gt_left\">information</td>\n<td headers=\"proba\" class=\"gt_row gt_right\">0.008911774</td></tr>\n    <tr><td headers=\"topic\" class=\"gt_row gt_right\">5</td>\n<td headers=\"word\" class=\"gt_row gt_left\">security</td>\n<td headers=\"proba\" class=\"gt_row gt_right\">0.008628986</td></tr>\n    <tr><td headers=\"topic\" class=\"gt_row gt_right\">6</td>\n<td headers=\"word\" class=\"gt_row gt_left\">computron</td>\n<td headers=\"proba\" class=\"gt_row gt_right\">0.014664934</td></tr>\n    <tr><td headers=\"topic\" class=\"gt_row gt_right\">6</td>\n<td headers=\"word\" class=\"gt_row gt_left\">remove</td>\n<td headers=\"proba\" class=\"gt_row gt_right\">0.010982525</td></tr>\n    <tr><td headers=\"topic\" class=\"gt_row gt_right\">6</td>\n<td headers=\"word\" class=\"gt_row gt_left\">contact</td>\n<td headers=\"proba\" class=\"gt_row gt_right\">0.010921784</td></tr>\n    <tr><td headers=\"topic\" class=\"gt_row gt_right\">6</td>\n<td headers=\"word\" class=\"gt_row gt_left\">message</td>\n<td headers=\"proba\" class=\"gt_row gt_right\">0.010415667</td></tr>\n    <tr><td headers=\"topic\" class=\"gt_row gt_right\">6</td>\n<td headers=\"word\" class=\"gt_row gt_left\">please</td>\n<td headers=\"proba\" class=\"gt_row gt_right\">0.008575548</td></tr>\n    <tr><td headers=\"topic\" class=\"gt_row gt_right\">7</td>\n<td headers=\"word\" class=\"gt_row gt_left\">hotlist</td>\n<td headers=\"proba\" class=\"gt_row gt_right\">0.006514079</td></tr>\n    <tr><td headers=\"topic\" class=\"gt_row gt_right\">7</td>\n<td headers=\"word\" class=\"gt_row gt_left\">moopid</td>\n<td headers=\"proba\" class=\"gt_row gt_right\">0.006510390</td></tr>\n    <tr><td headers=\"topic\" class=\"gt_row gt_right\">7</td>\n<td headers=\"word\" class=\"gt_row gt_left\">image</td>\n<td headers=\"proba\" class=\"gt_row gt_right\">0.005001818</td></tr>\n    <tr><td headers=\"topic\" class=\"gt_row gt_right\">7</td>\n<td headers=\"word\" class=\"gt_row gt_left\">width</td>\n<td headers=\"proba\" class=\"gt_row gt_right\">0.004599662</td></tr>\n    <tr><td headers=\"topic\" class=\"gt_row gt_right\">7</td>\n<td headers=\"word\" class=\"gt_row gt_left\">please</td>\n<td headers=\"proba\" class=\"gt_row gt_right\">0.004240304</td></tr>\n    <tr><td headers=\"topic\" class=\"gt_row gt_right\">8</td>\n<td headers=\"word\" class=\"gt_row gt_left\">email</td>\n<td headers=\"proba\" class=\"gt_row gt_right\">0.006112204</td></tr>\n    <tr><td headers=\"topic\" class=\"gt_row gt_right\">8</td>\n<td headers=\"word\" class=\"gt_row gt_left\">weight</td>\n<td headers=\"proba\" class=\"gt_row gt_right\">0.003075323</td></tr>\n    <tr><td headers=\"topic\" class=\"gt_row gt_right\">8</td>\n<td headers=\"word\" class=\"gt_row gt_left\">without</td>\n<td headers=\"proba\" class=\"gt_row gt_right\">0.003040693</td></tr>\n    <tr><td headers=\"topic\" class=\"gt_row gt_right\">8</td>\n<td headers=\"word\" class=\"gt_row gt_left\">people</td>\n<td headers=\"proba\" class=\"gt_row gt_right\">0.002883572</td></tr>\n    <tr><td headers=\"topic\" class=\"gt_row gt_right\">8</td>\n<td headers=\"word\" class=\"gt_row gt_left\">please</td>\n<td headers=\"proba\" class=\"gt_row gt_right\">0.002216808</td></tr>\n    <tr><td headers=\"topic\" class=\"gt_row gt_right\">9</td>\n<td headers=\"word\" class=\"gt_row gt_left\">cialis</td>\n<td headers=\"proba\" class=\"gt_row gt_right\">0.008944252</td></tr>\n    <tr><td headers=\"topic\" class=\"gt_row gt_right\">9</td>\n<td headers=\"word\" class=\"gt_row gt_left\">offer</td>\n<td headers=\"proba\" class=\"gt_row gt_right\">0.005331774</td></tr>\n    <tr><td headers=\"topic\" class=\"gt_row gt_right\">9</td>\n<td headers=\"word\" class=\"gt_row gt_left\">hour</td>\n<td headers=\"proba\" class=\"gt_row gt_right\">0.004638998</td></tr>\n    <tr><td headers=\"topic\" class=\"gt_row gt_right\">9</td>\n<td headers=\"word\" class=\"gt_row gt_left\">product</td>\n<td headers=\"proba\" class=\"gt_row gt_right\">0.004366095</td></tr>\n    <tr><td headers=\"topic\" class=\"gt_row gt_right\">9</td>\n<td headers=\"word\" class=\"gt_row gt_left\">money</td>\n<td headers=\"proba\" class=\"gt_row gt_right\">0.003929896</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n\n## Semantic distance between topics\n\nCreate a `dict` to create a documents to vectorize.\n\n\n\n::: {.cell}\n\n```{.python .cell-code}\ntopics_dict = {}\nfor topics, words in topic_words:\n  topics_dict[topics] = [w[0] for w in words]\n```\n:::\n\n::: {.cell}\n\n```{.python .cell-code}\ndocuments = [\" \".join(words) for words in topics_dict.values()]\n\nvectorizer = TfidfVectorizer()\ntfidf_matrix = vectorizer.fit_transform(documents)\ncosine_sim_matrix = cosine_similarity(tfidf_matrix, dense_output=True)\ntopics = list(topics_dict.keys())\ncosine_sim_df = pd.DataFrame(cosine_sim_matrix, index=topics, columns=topics)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\npy$cosine_sim_df %>% \n  gt()\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"hqewhxeveq\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#hqewhxeveq table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#hqewhxeveq thead, #hqewhxeveq tbody, #hqewhxeveq tfoot, #hqewhxeveq tr, #hqewhxeveq td, #hqewhxeveq th {\n  border-style: none;\n}\n\n#hqewhxeveq p {\n  margin: 0;\n  padding: 0;\n}\n\n#hqewhxeveq .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#hqewhxeveq .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#hqewhxeveq .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#hqewhxeveq .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#hqewhxeveq .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#hqewhxeveq .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#hqewhxeveq .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#hqewhxeveq .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#hqewhxeveq .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#hqewhxeveq .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#hqewhxeveq .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#hqewhxeveq .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#hqewhxeveq .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#hqewhxeveq .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#hqewhxeveq .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#hqewhxeveq .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#hqewhxeveq .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#hqewhxeveq .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#hqewhxeveq .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#hqewhxeveq .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#hqewhxeveq .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#hqewhxeveq .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#hqewhxeveq .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#hqewhxeveq .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#hqewhxeveq .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#hqewhxeveq .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#hqewhxeveq .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#hqewhxeveq .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#hqewhxeveq .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#hqewhxeveq .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#hqewhxeveq .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#hqewhxeveq .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#hqewhxeveq .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#hqewhxeveq .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#hqewhxeveq .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#hqewhxeveq .gt_left {\n  text-align: left;\n}\n\n#hqewhxeveq .gt_center {\n  text-align: center;\n}\n\n#hqewhxeveq .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#hqewhxeveq .gt_font_normal {\n  font-weight: normal;\n}\n\n#hqewhxeveq .gt_font_bold {\n  font-weight: bold;\n}\n\n#hqewhxeveq .gt_font_italic {\n  font-style: italic;\n}\n\n#hqewhxeveq .gt_super {\n  font-size: 65%;\n}\n\n#hqewhxeveq .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#hqewhxeveq .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#hqewhxeveq .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#hqewhxeveq .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#hqewhxeveq .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#hqewhxeveq .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#hqewhxeveq .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#hqewhxeveq .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#hqewhxeveq div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"0\">0</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"1\">1</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"2\">2</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"3\">3</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"4\">4</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"5\">5</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"6\">6</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"7\">7</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"8\">8</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"9\">9</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"0\" class=\"gt_row gt_right\">1.0000000</td>\n<td headers=\"1\" class=\"gt_row gt_right\">0.1337754</td>\n<td headers=\"2\" class=\"gt_row gt_right\">0.1657571</td>\n<td headers=\"3\" class=\"gt_row gt_right\">0</td>\n<td headers=\"4\" class=\"gt_row gt_right\">0</td>\n<td headers=\"5\" class=\"gt_row gt_right\">0.0000000</td>\n<td headers=\"6\" class=\"gt_row gt_right\">0.0000000</td>\n<td headers=\"7\" class=\"gt_row gt_right\">0.0000000</td>\n<td headers=\"8\" class=\"gt_row gt_right\">0.1320074</td>\n<td headers=\"9\" class=\"gt_row gt_right\">0.0000000</td></tr>\n    <tr><td headers=\"0\" class=\"gt_row gt_right\">0.1337754</td>\n<td headers=\"1\" class=\"gt_row gt_right\">1.0000000</td>\n<td headers=\"2\" class=\"gt_row gt_right\">0.0000000</td>\n<td headers=\"3\" class=\"gt_row gt_right\">0</td>\n<td headers=\"4\" class=\"gt_row gt_right\">0</td>\n<td headers=\"5\" class=\"gt_row gt_right\">0.1663001</td>\n<td headers=\"6\" class=\"gt_row gt_right\">0.0000000</td>\n<td headers=\"7\" class=\"gt_row gt_right\">0.0000000</td>\n<td headers=\"8\" class=\"gt_row gt_right\">0.1365089</td>\n<td headers=\"9\" class=\"gt_row gt_right\">0.1663001</td></tr>\n    <tr><td headers=\"0\" class=\"gt_row gt_right\">0.1657571</td>\n<td headers=\"1\" class=\"gt_row gt_right\">0.0000000</td>\n<td headers=\"2\" class=\"gt_row gt_right\">1.0000000</td>\n<td headers=\"3\" class=\"gt_row gt_right\">0</td>\n<td headers=\"4\" class=\"gt_row gt_right\">0</td>\n<td headers=\"5\" class=\"gt_row gt_right\">0.0000000</td>\n<td headers=\"6\" class=\"gt_row gt_right\">0.0000000</td>\n<td headers=\"7\" class=\"gt_row gt_right\">0.1657571</td>\n<td headers=\"8\" class=\"gt_row gt_right\">0.0000000</td>\n<td headers=\"9\" class=\"gt_row gt_right\">0.0000000</td></tr>\n    <tr><td headers=\"0\" class=\"gt_row gt_right\">0.0000000</td>\n<td headers=\"1\" class=\"gt_row gt_right\">0.0000000</td>\n<td headers=\"2\" class=\"gt_row gt_right\">0.0000000</td>\n<td headers=\"3\" class=\"gt_row gt_right\">1</td>\n<td headers=\"4\" class=\"gt_row gt_right\">0</td>\n<td headers=\"5\" class=\"gt_row gt_right\">0.0000000</td>\n<td headers=\"6\" class=\"gt_row gt_right\">0.0000000</td>\n<td headers=\"7\" class=\"gt_row gt_right\">0.0000000</td>\n<td headers=\"8\" class=\"gt_row gt_right\">0.0000000</td>\n<td headers=\"9\" class=\"gt_row gt_right\">0.0000000</td></tr>\n    <tr><td headers=\"0\" class=\"gt_row gt_right\">0.0000000</td>\n<td headers=\"1\" class=\"gt_row gt_right\">0.0000000</td>\n<td headers=\"2\" class=\"gt_row gt_right\">0.0000000</td>\n<td headers=\"3\" class=\"gt_row gt_right\">0</td>\n<td headers=\"4\" class=\"gt_row gt_right\">1</td>\n<td headers=\"5\" class=\"gt_row gt_right\">0.0000000</td>\n<td headers=\"6\" class=\"gt_row gt_right\">0.0000000</td>\n<td headers=\"7\" class=\"gt_row gt_right\">0.0000000</td>\n<td headers=\"8\" class=\"gt_row gt_right\">0.0000000</td>\n<td headers=\"9\" class=\"gt_row gt_right\">0.0000000</td></tr>\n    <tr><td headers=\"0\" class=\"gt_row gt_right\">0.0000000</td>\n<td headers=\"1\" class=\"gt_row gt_right\">0.1663001</td>\n<td headers=\"2\" class=\"gt_row gt_right\">0.0000000</td>\n<td headers=\"3\" class=\"gt_row gt_right\">0</td>\n<td headers=\"4\" class=\"gt_row gt_right\">0</td>\n<td headers=\"5\" class=\"gt_row gt_right\">1.0000000</td>\n<td headers=\"6\" class=\"gt_row gt_right\">0.0000000</td>\n<td headers=\"7\" class=\"gt_row gt_right\">0.0000000</td>\n<td headers=\"8\" class=\"gt_row gt_right\">0.0000000</td>\n<td headers=\"9\" class=\"gt_row gt_right\">0.0000000</td></tr>\n    <tr><td headers=\"0\" class=\"gt_row gt_right\">0.0000000</td>\n<td headers=\"1\" class=\"gt_row gt_right\">0.0000000</td>\n<td headers=\"2\" class=\"gt_row gt_right\">0.0000000</td>\n<td headers=\"3\" class=\"gt_row gt_right\">0</td>\n<td headers=\"4\" class=\"gt_row gt_right\">0</td>\n<td headers=\"5\" class=\"gt_row gt_right\">0.0000000</td>\n<td headers=\"6\" class=\"gt_row gt_right\">1.0000000</td>\n<td headers=\"7\" class=\"gt_row gt_right\">0.1253622</td>\n<td headers=\"8\" class=\"gt_row gt_right\">0.1279238</td>\n<td headers=\"9\" class=\"gt_row gt_right\">0.0000000</td></tr>\n    <tr><td headers=\"0\" class=\"gt_row gt_right\">0.0000000</td>\n<td headers=\"1\" class=\"gt_row gt_right\">0.0000000</td>\n<td headers=\"2\" class=\"gt_row gt_right\">0.1657571</td>\n<td headers=\"3\" class=\"gt_row gt_right\">0</td>\n<td headers=\"4\" class=\"gt_row gt_right\">0</td>\n<td headers=\"5\" class=\"gt_row gt_right\">0.0000000</td>\n<td headers=\"6\" class=\"gt_row gt_right\">0.1253622</td>\n<td headers=\"7\" class=\"gt_row gt_right\">1.0000000</td>\n<td headers=\"8\" class=\"gt_row gt_right\">0.1320074</td>\n<td headers=\"9\" class=\"gt_row gt_right\">0.0000000</td></tr>\n    <tr><td headers=\"0\" class=\"gt_row gt_right\">0.1320074</td>\n<td headers=\"1\" class=\"gt_row gt_right\">0.1365089</td>\n<td headers=\"2\" class=\"gt_row gt_right\">0.0000000</td>\n<td headers=\"3\" class=\"gt_row gt_right\">0</td>\n<td headers=\"4\" class=\"gt_row gt_right\">0</td>\n<td headers=\"5\" class=\"gt_row gt_right\">0.0000000</td>\n<td headers=\"6\" class=\"gt_row gt_right\">0.1279238</td>\n<td headers=\"7\" class=\"gt_row gt_right\">0.1320074</td>\n<td headers=\"8\" class=\"gt_row gt_right\">1.0000000</td>\n<td headers=\"9\" class=\"gt_row gt_right\">0.0000000</td></tr>\n    <tr><td headers=\"0\" class=\"gt_row gt_right\">0.0000000</td>\n<td headers=\"1\" class=\"gt_row gt_right\">0.1663001</td>\n<td headers=\"2\" class=\"gt_row gt_right\">0.0000000</td>\n<td headers=\"3\" class=\"gt_row gt_right\">0</td>\n<td headers=\"4\" class=\"gt_row gt_right\">0</td>\n<td headers=\"5\" class=\"gt_row gt_right\">0.0000000</td>\n<td headers=\"6\" class=\"gt_row gt_right\">0.0000000</td>\n<td headers=\"7\" class=\"gt_row gt_right\">0.0000000</td>\n<td headers=\"8\" class=\"gt_row gt_right\">0.0000000</td>\n<td headers=\"9\" class=\"gt_row gt_right\">1.0000000</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n\n## Organization of \"HAM\" mails\n\n### Create \"HAM\" df\n\n### Get ham lemmas which have ORG entity\n\n\n\n::: {.cell}\n\n```{.python .cell-code}\nham = df[df.label == \"ham\"]\nx = ham.entities\n```\n:::\n\n::: {.cell}\n\n```{.python .cell-code}\nfrom collections import Counter\n\n# Flatten the list of lists and create a Counter object\nd = Counter([i for e in x for i in e])\n\nfreq_df = pd.DataFrame(d.items(), columns=[\"word\", \"freq\"])\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(\"wordcloud\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nLoading required package: RColorBrewer\n```\n\n\n:::\n\n```{.r .cell-code}\nset.seed(1234)\nword_freqs_df <- py$freq_df\nwordcloud(words = word_freqs_df$word, freq = word_freqs_df$freq, \n          min.freq = 1, max.words = 100, random.order = FALSE, \n          rot.per = 0.35, colors = brewer.pal(8, \"Dark2\"))\n```\n\n::: {.cell-output-display}\n![](spam_detection_files/figure-html/unnamed-chunk-26-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nword_freqs_df %>% \n  arrange(desc(freq)) %>% \n  head(10) %>% \n  gt()\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"dopmwjrkhc\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#dopmwjrkhc table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#dopmwjrkhc thead, #dopmwjrkhc tbody, #dopmwjrkhc tfoot, #dopmwjrkhc tr, #dopmwjrkhc td, #dopmwjrkhc th {\n  border-style: none;\n}\n\n#dopmwjrkhc p {\n  margin: 0;\n  padding: 0;\n}\n\n#dopmwjrkhc .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#dopmwjrkhc .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#dopmwjrkhc .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#dopmwjrkhc .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#dopmwjrkhc .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#dopmwjrkhc .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#dopmwjrkhc .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#dopmwjrkhc .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#dopmwjrkhc .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#dopmwjrkhc .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#dopmwjrkhc .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#dopmwjrkhc .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#dopmwjrkhc .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#dopmwjrkhc .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#dopmwjrkhc .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#dopmwjrkhc .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#dopmwjrkhc .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#dopmwjrkhc .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#dopmwjrkhc .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#dopmwjrkhc .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#dopmwjrkhc .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#dopmwjrkhc .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#dopmwjrkhc .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#dopmwjrkhc .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#dopmwjrkhc .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#dopmwjrkhc .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#dopmwjrkhc .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#dopmwjrkhc .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#dopmwjrkhc .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#dopmwjrkhc .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#dopmwjrkhc .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#dopmwjrkhc .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#dopmwjrkhc .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#dopmwjrkhc .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#dopmwjrkhc .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#dopmwjrkhc .gt_left {\n  text-align: left;\n}\n\n#dopmwjrkhc .gt_center {\n  text-align: center;\n}\n\n#dopmwjrkhc .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#dopmwjrkhc .gt_font_normal {\n  font-weight: normal;\n}\n\n#dopmwjrkhc .gt_font_bold {\n  font-weight: bold;\n}\n\n#dopmwjrkhc .gt_font_italic {\n  font-style: italic;\n}\n\n#dopmwjrkhc .gt_super {\n  font-size: 65%;\n}\n\n#dopmwjrkhc .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#dopmwjrkhc .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#dopmwjrkhc .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#dopmwjrkhc .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#dopmwjrkhc .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#dopmwjrkhc .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#dopmwjrkhc .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#dopmwjrkhc .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#dopmwjrkhc div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"word\">word</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"freq\">freq</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"word\" class=\"gt_row gt_left\">enron</td>\n<td headers=\"freq\" class=\"gt_row gt_right\">3268</td></tr>\n    <tr><td headers=\"word\" class=\"gt_row gt_left\">daren</td>\n<td headers=\"freq\" class=\"gt_row gt_right\">1047</td></tr>\n    <tr><td headers=\"word\" class=\"gt_row gt_left\">farmer</td>\n<td headers=\"freq\" class=\"gt_row gt_right\">472</td></tr>\n    <tr><td headers=\"word\" class=\"gt_row gt_left\">north</td>\n<td headers=\"freq\" class=\"gt_row gt_right\">270</td></tr>\n    <tr><td headers=\"word\" class=\"gt_row gt_left\">america</td>\n<td headers=\"freq\" class=\"gt_row gt_right\">269</td></tr>\n    <tr><td headers=\"word\" class=\"gt_row gt_left\">texas</td>\n<td headers=\"freq\" class=\"gt_row gt_right\">189</td></tr>\n    <tr><td headers=\"word\" class=\"gt_row gt_left\">iferc</td>\n<td headers=\"freq\" class=\"gt_row gt_right\">177</td></tr>\n    <tr><td headers=\"word\" class=\"gt_row gt_left\">energy</td>\n<td headers=\"freq\" class=\"gt_row gt_right\">151</td></tr>\n    <tr><td headers=\"word\" class=\"gt_row gt_left\">clynes</td>\n<td headers=\"freq\" class=\"gt_row gt_right\">144</td></tr>\n    <tr><td headers=\"word\" class=\"gt_row gt_left\">sitara</td>\n<td headers=\"freq\" class=\"gt_row gt_right\">137</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n\n# Conclusion\n",
    "supporting": [
      "spam_detection_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../site_libs/htmltools-fill-0.5.8.1/fill.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/htmlwidgets-1.6.4/htmlwidgets.js\"></script>\n<script src=\"../../site_libs/plotly-binding-4.10.4/plotly.js\"></script>\n<script src=\"../../site_libs/typedarray-0.1/typedarray.min.js\"></script>\n<script src=\"../../site_libs/jquery-3.5.1/jquery.min.js\"></script>\n<link href=\"../../site_libs/crosstalk-1.2.1/css/crosstalk.min.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/crosstalk-1.2.1/js/crosstalk.min.js\"></script>\n<link href=\"../../site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/plotly-main-2.11.1/plotly-latest.min.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}